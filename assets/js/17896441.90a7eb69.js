"use strict";(self.webpackChunkvis_engine_docs=self.webpackChunkvis_engine_docs||[]).push([[7918],{662:(t,e,i)=>{i.d(e,{Z:()=>h});var n=i(79),r=i(6744),s=i(2636),a=i(2271),o=i(5776);const h=Object.assign({React:n},n,{useBaseUrl:s.Z,ve:a},a,{observe:o.N7,unobserve:o.p_,leva:r,Leva:r.Leva,LevaPanel:r.LevaPanel})},5776:(t,e,i)=>{i.d(e,{N7:()=>a,p_:()=>o});var n=i(9146),r=new Map;var s=new n.Z((function(t){t.forEach((function(t){var e,i=t.target;null==(e=r.get(i))||e.forEach((function(t){return t(i)}))}))}));function a(t,e){r.has(t)||(r.set(t,new Set),s.observe(t)),r.get(t).add(e)}function o(t,e){r.has(t)&&(r.get(t).delete(e),r.get(t).size||(s.unobserve(t),r.delete(t)))}},2271:(t,e,i)=>{i.r(e),i.d(e,{Box:()=>Ke,BufferAttribute:()=>Nt,Camera:()=>Gi,Clock:()=>V,Color:()=>Ft,DataTexture:()=>Ze,Euler:()=>Tt,EventEmitter:()=>at,Geometry:()=>Zt,Matrix3:()=>vt,Matrix4:()=>wt,Mesh:()=>Qt,Object3D:()=>Ut,OrthographicCamera:()=>ji,PerspectiveCamera:()=>zi,Plane:()=>Je,Program:()=>Mi,ProjectionMatrix:()=>Ct,Quaternion:()=>ct,Raf:()=>nt,RenderBuffer:()=>Ue,RenderTarget:()=>Ve,Renderer:()=>Ae,Resource:()=>Re,Scene:()=>te,State:()=>re,Texture:()=>Le,Texture3D:()=>Ri,Vector2:()=>ht,Vector3:()=>mt,Vector4:()=>gt,utils:()=>Z});var n=i(2198),r=i(4036),s=i(8187),a=i(8788),o=i(663),h=i(1606),l=i(4717),u=i(9196),c=i(5316),d=i(6518),f=i(1354);function m(t,e,i){return void 0===e&&(e=[]),void 0===i&&(i=[]),t.replace(/#defines/,e.join("\n")).replace(/#includes/,i.join("\n"))}function g(t,e,i,n){var r=new Set;if(n)for(var s=0,a=i;s<a;s+=3)for(var o=n[s],h=n[s+1],l=n[s+2],u=[o,h,h,l,l,o],c=0;c<u.length;c+=2)p(3*u[c],3*u[c+1],t,r)&&e.push(u[c],u[c+1]);else for(var d=0,f=i;d<f;d+=3)for(var m=d+1,g=d+2,v=[d,m,m,g,g,d],y=0;y<v.length;y+=2)p(3*v[y],3*v[y+1],t,r)&&e.push(v[y],v[y+1]);return e}function p(t,e,i,n){var r=i[t]+","+i[t+1]+","+i[t+2]+"-"+i[e]+","+i[e+1]+","+i[e+2],s=i[e]+","+i[e+1]+","+i[e+2]+"-"+i[t]+","+i[t+1]+","+i[t+2];return!0!==n.has(r)&&!0!==n.has(s)&&(n.add(r),n.add(s),!0)}var v=Math.PI/180,y=180/Math.PI;function w(t){return t*v}function b(t){return t*y}function E(t,e,i){return Math.min(Math.max(t,e),i)}function A(t){return Math.log(t)/Math.LN2%1==0}function x(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function T(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function M(t,e,i){void 0===e&&(e={}),void 0===i&&(i=!1);var n=["webgl2","webgl","experimental-webgl"];i||n.shift();var r=null;function s(t){console.error(t.statusMessage)}t.addEventListener("webglcontextcreationerror",s,!1);for(var a=0;a<n.length;++a){try{r=t.getContext(n[a],e)}catch(o){}if(r)break}return t.removeEventListener("webglcontextcreationerror",s,!1),r}var S=function(){return("undefined"==typeof performance?Date:performance).now()};function k(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function R(t){return"string"===k(t)}function _(t){return"undefined"===k(t)}function F(t){return R(t)&&t.includes("%")}function C(t){return"number"===k(t)}function U(t){return"regexp"===k(t)}function O(t){return null==t}function N(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}var L={};function I(t){return void 0===t&&(t="id"),L[t]=L[t]||1,t+"-"+L[t]++}function D(t,e){return void 0===e&&(e=[]),Object.keys(t).filter((function(t){return e.indexOf(t)<0})).reduce((function(e,i){var n;return Object.assign(e,((n={})[i]=t[i],n))}),{})}var W,P,B,Z=Object.freeze({__proto__:null,DEG_TO_RAD:v,RAD_TO_DEG:y,clamp:E,defineShader:function(t,e){return void 0===e&&(e={}),Object.keys(e).reduce((function(t,i){return e[i]?"#define "+i+" "+e[i]+"\n"+t:t}),t)},degToRad:w,getContext:M,getShaderName:function(t,e){void 0===e&&(e="unnamed");var i=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return i?i[1]:e},getWireframeIndex:g,hasValue:function(t,e){return N(t)?!O(t.value)&&(O(e)||t.value===e):!O(t)&&(O(e)||t===e)},isHex:F,isNull:O,isNumber:C,isObject:N,isPowerOfTwo:A,isRegexp:U,isString:R,isUndef:_,isUniqueEdge:p,isWebGL:x,isWebGL2:T,now:S,omit:D,parseShader:m,radToDeg:b,typeOf:k,uid:I}),G=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},z=function(t,e,i){return G(t,e,"read from private field"),i?i.call(t):e.get(t)},j=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},H=function(t,e,i,n){return G(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},V=function(){function t(t){void 0===t&&(t=!0),j(this,W,0),j(this,P,0),j(this,B,!1),this.running=t}var e=t.prototype;return e.start=function(){z(this,B)||(this.reset(),H(this,B,!0))},e.stop=function(){this.getElapsedTime(),H(this,B,!1),this.running=!1},e.reset=function(){H(this,W,S()),H(this,P,0)},e.getElapsedTime=function(){return this.getDelta(),z(this,P)},e.getDelta=function(){var t=0;if(this.running&&!z(this,B))return this.start(),0;if(z(this,B)){var e=S();t=(e-z(this,W))/1e3,H(this,W,e),H(this,P,z(this,P)+t)}return t},t}();W=new WeakMap,P=new WeakMap,B=new WeakMap;var q,X,Y,J,K,Q=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},$=function(t,e,i){return Q(t,e,"read from private field"),i?i.call(t):e.get(t)},tt=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},et=function(t,e,i,n){return Q(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},it={autoStart:!0},nt=function(){function t(t,e){var i=this;void 0===e&&(e={}),tt(this,q,void 0),tt(this,X,void 0),tt(this,Y,void 0),tt(this,J,void 0),tt(this,K,void 0),this.options=Object.assign({},e,it),et(this,J,new V),this.reset(),this.onVisibilityChange=this.onVisibilityChange.bind(this),et(this,K,(function(){var e=$(i,J).getElapsedTime();t&&t(e)})),this.options.autoStart&&this.start()}var e=t.prototype;return e.reset=function(){et(this,X,!1),et(this,Y,!0),void 0!==$(this,q)&&cancelAnimationFrame($(this,q))},e.start=function(){$(this,X)||(et(this,X,!0),$(this,J).start(),this.tick(),document&&document.addEventListener("visibilitychange",this.onVisibilityChange,!1))},e.stop=function(){$(this,J).stop(),this.reset(),document&&document.removeEventListener("visibilitychange",this.onVisibilityChange,!1)},e.tick=function(){var t=this;$(this,X)&&$(this,Y)&&(et(this,q,requestAnimationFrame((function(){t.tick()}))),$(this,K).call(this))},e.onVisibilityChange=function(){et(this,Y,!document.hidden),$(this,Y)&&(this.reset(),this.start())},(0,a.Z)(t,[{key:"visible",get:function(){return $(this,Y)}},{key:"animating",get:function(){return $(this,X)}},{key:"elapsedTime",get:function(){return $(this,J).getElapsedTime()}}]),t}();q=new WeakMap,X=new WeakMap,Y=new WeakMap,J=new WeakMap,K=new WeakMap;var rt,st=function(t,e){var i=this;void 0===e&&(e={}),this.type=t,(Object.getOwnPropertyNames(e)||[]).forEach((function(t){i[t]=e[t]}))},at=function(){function t(t){var e=(void 0===t?{}:t).validEventTypes,i=void 0===e?[/.*/]:e;this.fns=new Map,this.validateEventTypes=i}var e=t.prototype;return e.validateEventType=function(t){var e=this.validateEventTypes;Array.isArray(this.validateEventTypes)||(e=[this.validateEventTypes]);var i=!0;if(e.forEach((function(e){U(e)&&!e.test(t)&&(i=!1)})),!i)throw new Error("Invalid Event Type: '"+t+"'.\nEvent type should be any of: "+e+".")},e.on=function(t,e,i){var n=this;if(this.validateEventType(t),R(t)){var r=t.split(" ");if(r.length>1)return r.forEach((function(t){n.on(t,e,i)})),this}return this.has(t)||this.fns.set(t,[]),this.fns.get(t).push(e),this},e.once=function(t,e,i){var n=this;if(this.validateEventType(t),R(t)){var r=t.split(" ");if(r.length>1)return r.forEach((function(t){n.once(t,e,i)})),this}return this.on(t,(function r(){n.off(t,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];e.call.apply(e,[i||n].concat(a))}),i)},e.off=function(t,e,i){var n=this;if(this.validateEventType(t),R(t)){var r=t.split(" ");if(r.length>1)return r.forEach((function(t){n.off(t,e,i)})),this}var s=this.has(t);if(s)if(e){var a=s.filter((function(t){return t!==e}));this.fns.set(t,a)}else this.fns.delete(t);return this},e.emit=function(t,e){var i=this,n=t instanceof st?t:new st(t,e);this.validateEventType(n.type);var r=this.has(n.type);if(r)return r.map((function(t){return t.call(i,n)}))},e.has=function(t){return this.fns.get(t)},e.clear=function(){return this.fns.clear(),this},t}(),ot=function(){function t(){this.elements=new Float32Array(2)}var e=t.prototype;return e.fromArray=function(t,e){void 0===e&&(e=0);for(var i=0;i<this.elements.length;i++)this.elements[i]=t[e+i];return this},e.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var i=0;i<this.elements.length;i++)t[e+i]=this.elements[i];return t},t}(),ht=function(t){function e(e,i){var n;void 0===e&&(e=0),void 0===i&&(i=0),(n=t.call(this)||this).elements=new Float32Array(2);var r=n.elements;return r[0]=e,r[1]=i,n}(0,s.Z)(e,t);var i=e.prototype;return i.fromObject=function(t){var e=t.x,i=t.y;return void 0!==e&&(this.x=e),void 0!==i&&(this.y=i),this},i.toObject=function(){return{x:this.x,y:this.y}},i.set=function(t,e){return this.x=t,this.y=e,this},i.setScalar=function(t){return this.set(t,t)},i.add=function(t){return(0,o.IH)(this.elements,this.elements,t.elements),this},i.addScalar=function(t){return(0,o.IH)(this.elements,this.elements,[t,t]),this},i.subtract=function(t){return(0,o.$X)(this.elements,this.elements,t.elements),this},i.subtractScalar=function(t){return(0,o.$X)(this.elements,this.elements,[t,t]),this},i.multiply=function(t){return(0,o.Jp)(this.elements,this.elements,t.elements),this},i.multiplyScalar=function(t){return(0,o.Jp)(this.elements,this.elements,[t,t]),this},i.divide=function(t){return(0,o.cs)(this.elements,this.elements,t.elements),this},i.divideScalar=function(t){return(0,o.cs)(this.elements,this.elements,[t,t]),this},i.scale=function(t){return(0,o.bA)(this.elements,this.elements,t),this},i.distanceTo=function(t){return(0,o.TE)(this.elements,t.elements)},i.length=function(){return(0,o.kE)(this.elements)},i.distanceToSquared=function(t){return(0,o.bI)(t.elements,this.elements)},i.angle=function(){return(0,o.EU)(this.elements,[1,0])},i.angleTo=function(t){return(0,o.EU)(this.elements,t.elements)},i.dot=function(t){return(0,o.AK)(this.elements,t.elements)},i.equals=function(t){return(0,o.fS)(this.elements,t.elements)},i.cross=function(t){return(0,o.kC)(this.elements,this.elements,t.elements),this},i.negate=function(){return(0,o.tk)(this.elements,this.elements),this},i.inverse=function(){return(0,o.SO)(this.elements,this.elements),this},i.lerp=function(t,e){return(0,o.t7)(this.elements,this.elements,t.elements,e),this},i.normalize=function(){return(0,o.Fv)(this.elements,this.elements),this},i.applyMatrix3=function(t){return(0,o.kK)(this.elements,this.elements,t.elements),this},i.applyMatrix4=function(t){return(0,o.fF)(this.elements,this.elements,t.elements),this},i.copy=function(t){return this.x=t.x,this.y=t.y,this},i.clone=function(){return new e(this.x,this.y)},i.toString=function(){return(0,o.Bd)(this.elements)},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},{key:"y",get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}}]),e}(ot),lt=function(t,e,i){return function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)}(t,e,"read from private field"),i?i.call(t):e.get(t)},ut=[],ct=function(t){function e(e,i,n,s){var a;void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),(a=t.call(this)||this).elements=new Float32Array(4),function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(a),rt,[]);var o=a.elements;return o[0]=e,o[1]=i,o[2]=n,o[3]=s,a}(0,s.Z)(e,t);var i=e.prototype;return i.fromObject=function(t){var e=t.x,i=t.y,n=t.z,r=t.w;return void 0!==e&&(this.x=e),void 0!==i&&(this.y=i),void 0!==n&&(this.z=n),void 0!==r&&(this.w=r),this.triggerChange(),this},i.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},i.fromAxisAngle=function(t,e){return(0,l.yY)(this.elements,t.elements,e),this.triggerChange(),this},i.getAxisAngle=function(t){void 0===t&&(t=new mt);var e=(0,l.Bh)(ut,this.elements);return t.set(ut[0],ut[1],ut[2]),e},i.fromEuler=function(t){return(0,l.Su)(this.elements,b(t.x),b(t.y),b(t.z)),this.triggerChange(),this},i.fromMat3=function(t){return(0,l.bz)(this.elements,t),this},i.set=function(t,e,i,n){return(0,l.t8)(this.elements,t,e,i,n),this.triggerChange(),this},i.length=function(){return(0,l.kE)(this.elements)},i.multiply=function(t,e){return e?(0,l.Jp)(this.elements,t.elements,e.elements):(0,l.Jp)(this.elements,this.elements,t.elements),this.triggerChange(),this},i.slerp=function(t,e){return(0,l.ZA)(this.elements,this.elements,t.elements,e),this.triggerChange(),this},i.invert=function(){return(0,l.U_)(this.elements,this.elements),this.triggerChange(),this},i.conjugate=function(){return(0,l.Kx)(this.elements,this.elements),this.triggerChange(),this},i.normalize=function(){return(0,l.Fv)(this.elements,this.elements),this.triggerChange(),this},i.dot=function(t){return(0,l.AK)(this.elements,t.elements)},i.angleTo=function(t){return(0,l._O)(this.elements,t.elements)},i.clone=function(){return(new e).copy(this)},i.copy=function(t){return(0,l.JG)(this.elements,t.elements),this.triggerChange(),this},i.equals=function(t){return(0,u.fS)(this.elements,t.elements)},i.onChange=function(t){lt(this,rt).includes(t)||lt(this,rt).push(t)},i.triggerChange=function(){lt(this,rt).forEach((function(t){return t()}))},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.triggerChange()}},{key:"y",get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.triggerChange()}},{key:"z",get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.triggerChange()}},{key:"w",get:function(){return this.elements[3]},set:function(t){this.elements[3]=t,this.triggerChange()}}]),e}(ot);rt=new WeakMap;var dt,ft,mt=function(t){function e(e,i,n){var r;void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),(r=t.call(this)||this).elements=new Float32Array(3);var s=r.elements;return s[0]=e,s[1]=i,s[2]=n,r}(0,s.Z)(e,t);var i=e.prototype;return i.fromObject=function(t){var e=t.x,i=t.y,n=t.z;return void 0!==e&&(this.x=e),void 0!==i&&(this.y=i),void 0!==n&&(this.z=n),this},i.toObject=function(){return{x:this.x,y:this.y,z:this.z}},i.set=function(t,e,i){return(0,h.t8)(this.elements,t,e,i),this},i.setScalar=function(t){return this.set(t,t,t)},i.length=function(){return(0,h.kE)(this.elements)},i.add=function(t){return(0,h.IH)(this.elements,this.elements,t.elements),this},i.addScalar=function(t){return(0,h.IH)(this.elements,this.elements,[t,t,t]),this},i.subtract=function(t){return(0,h.$X)(this.elements,this.elements,t.elements),this},i.subtractScalar=function(t){return(0,h.$X)(this.elements,this.elements,[t,t,t]),this},i.subVectors=function(t,e){return(0,h.$X)(this.elements,t.elements,e.elements),this},i.multiply=function(t){return(0,h.Jp)(this.elements,this.elements,t.elements),this},i.multiplyScalar=function(t){return(0,h.Jp)(this.elements,this.elements,[t,t,t]),this},i.divide=function(t){return(0,h.cs)(this.elements,this.elements,t.elements),this},i.divideScalar=function(t){return(0,h.cs)(this.elements,this.elements,[t,t,t]),this},i.scale=function(t){return(0,h.bA)(this.elements,this.elements,t),this},i.scaleAndAdd=function(t,e){return(0,h.od)(this.elements,this.elements,t.elements,e),this},i.distanceTo=function(t){return(0,h.TE)(this.elements,t.elements)},i.distanceToSquared=function(t){return(0,h.bI)(this.elements,t.elements)},i.angle=function(t){return(0,h.EU)(this.elements,[1,0,0])},i.angleTo=function(t){return(0,h.EU)(this.elements,t.elements)},i.dot=function(t){return(0,h.AK)(this.elements,t.elements)},i.equals=function(t){return(0,h.fS)(this.elements,t.elements)},i.cross=function(t){return(0,h.kC)(this.elements,this.elements,t.elements),this},i.negate=function(){return(0,h.tk)(this.elements,this.elements),this},i.inverse=function(){return(0,h.SO)(this.elements,this.elements),this},i.lerp=function(t,e){return(0,h.t7)(this.elements,this.elements,t.elements,e),this},i.normalize=function(){return(0,h.Fv)(this.elements,this.elements),this},i.applyEuler=function(t){var e=(new ct).fromEuler(t);return this.applyQuaternion(e)},i.applyMatrix3=function(t){return(0,h.kK)(this.elements,this.elements,t.elements),this},i.applyMatrix4=function(t){return(0,h.fF)(this.elements,this.elements,t.elements),this},i.applyQuaternion=function(t){return(0,h.VC)(this.elements,this.elements,t.elements),this},i.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.clone=function(){return new e(this.x,this.y,this.z)},i.toString=function(){return(0,h.Bd)(this.elements)},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},{key:"y",get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},{key:"z",get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}}]),e}(ot),gt=function(t){function e(e,i,n,r){var s;void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),(s=t.call(this)||this).elements=new Float32Array(4);var a=s.elements;return a[0]=e,a[1]=i,a[2]=n,a[3]=r,s}(0,s.Z)(e,t);var i=e.prototype;return i.fromObject=function(t){var e=t.x,i=t.y,n=t.z,r=t.w;return void 0!==e&&(this.x=e),void 0!==i&&(this.y=i),void 0!==n&&(this.z=n),void 0!==r&&(this.w=r),this},i.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},i.set=function(t,e,i,n){return(0,u.t8)(this.elements,t,e,i,n),this},i.setScalar=function(t){return this.set(t,t,t,t)},i.add=function(t){return(0,u.IH)(this.elements,this.elements,t.elements),this},i.addScalar=function(t){return(0,u.IH)(this.elements,this.elements,[t,t,t,t]),this},i.subtract=function(t){return(0,u.$X)(this.elements,this.elements,t.elements),this},i.subtractScalar=function(t){return(0,u.$X)(this.elements,this.elements,[t,t,t,t]),this},i.subVectors=function(t,e){return(0,u.$X)(this.elements,t.elements,e.elements),this},i.multiply=function(t){return(0,u.Jp)(this.elements,this.elements,t.elements),this},i.multiplyScalar=function(t){return(0,u.Jp)(this.elements,this.elements,[t,t,t,t]),this},i.divide=function(t){return(0,u.cs)(this.elements,this.elements,t.elements),this},i.divideScalar=function(t){return(0,u.cs)(this.elements,this.elements,[t,t,t,t]),this},i.scale=function(t){return(0,u.bA)(this.elements,this.elements,t),this},i.scaleAndAdd=function(t,e){return(0,u.od)(this.elements,this.elements,t.elements,e),this},i.distanceTo=function(t){return(0,u.TE)(this.elements,t.elements)},i.distanceToSquared=function(t){return(0,u.bI)(this.elements,t.elements)},i.length=function(){return(0,u.kE)(this.elements)},i.dot=function(t){return(0,u.AK)(this.elements,t.elements)},i.equals=function(t){return(0,u.fS)(this.elements,t.elements)},i.cross=function(t){return(0,u.kC)(this.elements,this.elements,t.elements),this},i.negate=function(){return(0,u.tk)(this.elements,this.elements),this},i.inverse=function(){return(0,u.SO)(this.elements,this.elements),this},i.lerp=function(t,e){return(0,u.t7)(this.elements,this.elements,t.elements,e),this},i.normalize=function(){return(0,u.Fv)(this.elements,this.elements),this},i.applyMatrix4=function(t){return(0,u.fF)(this.elements,this.elements,t.elements),this},i.applyQuaternion=function(t){return(0,u.VC)(this.elements,this.elements,t.elements),this},i.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},i.clone=function(){return new e(this.x,this.y,this.z,this.w)},i.toString=function(){return(0,u.Bd)(this.elements)},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},{key:"y",get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},{key:"z",get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}},{key:"w",get:function(){return this.elements[3]},set:function(t){this.elements[3]=t}}]),e}(ot),pt=function(){function t(){this.elements=new Float32Array(16)}var e=t.prototype;return e.fromArray=function(t,e){void 0===e&&(e=0);for(var i=0;i<this.elements.length;i++)this.elements[i]=t[e+i];return this},e.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var i=0;i<this.elements.length;i++)t[e+i]=this.elements[i];return t},t}(),vt=function(t){function e(e,i,n,r,s,a,o,h,l){var u;void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=1),(u=t.call(this)||this).elements=new Float32Array(9);var c=u.elements;return c[0]=e,c[1]=i,c[2]=n,c[3]=r,c[4]=s,c[5]=a,c[6]=o,c[7]=h,c[8]=l,u}(0,s.Z)(e,t);var i=e.prototype;return i.set=function(t,e,i,n,r,s,a,o,h){return(0,c.t8)(this.elements,t,e,i,n,r,s,a,o,h),this},i.transpose=function(){return(0,c.p4)(this.elements,this.elements),this},i.invert=function(t){return void 0===t&&(t=this),(0,c.U_)(this.elements,t.elements),this},i.adjoint=function(t){return void 0===t&&(t=this),(0,c.uj)(this.elements,t.elements),this},i.determinant=function(){return(0,c.GH)(this.elements)},i.multiply=function(t,e){return e?(0,c.Jp)(this.elements,t.elements,e.elements):(0,c.Jp)(this.elements,this.elements,t.elements),this},i.premultiply=function(t,e){return e?(0,c.Jp)(this.elements,e.elements,t.elements):(0,c.Jp)(this.elements,t.elements,this.elements),this},i.translate=function(t){return(0,c.Iu)(this.elements,this.elements,t.elements),this},i.rotate=function(t){return(0,c.U1)(this.elements,this.elements,t),this},i.scale=function(t){return(0,c.bA)(this.elements,this.elements,t.elements),this},i.fromTranslation=function(t){return(0,c.vc)(this.elements,t.elements),this},i.fromRotation=function(t){return(0,c.Us)(this.elements,t),this},i.fromScaling=function(t){return(0,c.xJ)(this.elements,t.elements),this},i.fromQuat=function(t){return(0,c.en)(this.elements,t.elements),this},i.normalFromMat4=function(t){return(0,c.XL)(this.elements,t.elements),this},i.fromMat4=function(t){return(0,c.xO)(this.elements,t.elements),this},i.frob=function(){return(0,c.Du)(this.elements)},i.add=function(t,e){return e?(0,c.IH)(this.elements,t.elements,e.elements):(0,c.IH)(this.elements,this.elements,t.elements),this},i.subtract=function(t,e){return e?(0,c.$X)(this.elements,t.elements,e.elements):(0,c.$X)(this.elements,this.elements,t.elements),this},i.equals=function(t,e){return e?(0,c.fS)(t.elements,e.elements):(0,c.fS)(this.elements,t.elements)},i.fromRotationTranslationScale=function(t,e,i,n,r){var s=Math.cos(t),a=Math.sin(t);return this.set(n*s,-r*a,0,n*a,r*s,0,e,i,1),this},i.getNormalMatrix=function(t){return(0,c.XL)(this.elements,t.elements),this},i.copy=function(t){return(0,c.JG)(this.elements,t.elements),this},i.clone=function(){return(new e).copy(this)},i.toString=function(){return(0,c.Bd)(this.elements)},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[12]}},{key:"y",get:function(){return this.elements[13]}},{key:"z",get:function(){return this.elements[14]}}],[{key:"identity",get:function(){return(new e).fromArray((0,c.yR)())}}]),e}(pt),yt=[],wt=function(t){function e(e,i,n,r,s,a,o,h,l,u,c,d,f,m,g,p){var v;void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===a&&(a=1),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===c&&(c=1),void 0===d&&(d=0),void 0===f&&(f=0),void 0===m&&(m=0),void 0===g&&(g=0),void 0===p&&(p=1),(v=t.call(this)||this).elements=new Float32Array(16);var y=v.elements;return y[0]=e,y[1]=i,y[2]=n,y[3]=r,y[4]=s,y[5]=a,y[6]=o,y[7]=h,y[8]=l,y[9]=u,y[10]=c,y[11]=d,y[12]=f,y[13]=m,y[14]=g,y[15]=p,v}(0,s.Z)(e,t);var i=e.prototype;return i.set=function(t,e,i,n,r,s,a,o,h,l,u,c,f,m,g,p){return(0,d.t8)(this.elements,t,e,i,n,r,s,a,o,h,l,u,c,f,m,g,p),this},i.transpose=function(){return(0,d.p4)(this.elements,this.elements),this},i.invert=function(t){return void 0===t&&(t=this),(0,d.U_)(this.elements,t.elements),this},i.adjoint=function(t){return void 0===t&&(t=this),(0,d.uj)(this.elements,t.elements),this},i.determinant=function(){return(0,d.GH)(this.elements)},i.add=function(t,e){return(0,d.IH)(this.elements,t.elements,e.elements),this},i.subtract=function(t,e){return(0,d.$X)(this.elements,t.elements,e.elements),this},i.multiply=function(t,e){return e?(0,d.Jp)(this.elements,t.elements,e.elements):(0,d.Jp)(this.elements,this.elements,t.elements),this},i.multiplyScalar=function(t,e){return void 0===t&&(t=this),(0,d.cf)(this.elements,t.elements,e),this},i.premultiply=function(t,e){return e?(0,d.Jp)(this.elements,e.elements,t.elements):(0,d.Jp)(this.elements,t.elements,this.elements),this},i.translate=function(t){return(0,d.Iu)(this.elements,this.elements,t.elements),this},i.rotate=function(t){return(0,d.U1)(this.elements,this.elements,t),this},i.scale=function(t){return(0,d.bA)(this.elements,this.elements,t.elements),this},i.scaleScalar=function(t){return(0,d.bA)(this.elements,this.elements,[t,t,t]),this},i.fromTranslation=function(t){return(0,d.vc)(this.elements,t.elements),this},i.fromRotation=function(t,e){return(0,d.Us)(this.elements,t,e),this},i.fromRotationX=function(t){return(0,d.aC)(this.elements,t),this},i.fromRotationY=function(t){return(0,d.gT)(this.elements,t),this},i.fromRotationZ=function(t){return(0,d.QO)(this.elements,t),this},i.fromScale=function(t){return(0,d.xJ)(this.elements,t.elements),this},i.fromRotationTranslation=function(t,e){return(0,d.yl)(this.elements,t.elements,e.elements),this},i.fromPerspective=function(t,e,i,n){return(0,d.G3)(this.elements,w(t),e,i,n),this},i.fromOrthogonal=function(t,e,i,n,r,s){return(0,d.M5)(this.elements,t,e,i,n,r,s),this},i.fromQuat=function(t){return(0,d.en)(this.elements,t.elements),this},i.equals=function(t){return(0,d.fS)(this.elements,t.value)},i.getRotation=function(t){return void 0===t&&(t=new ct),(0,d.j6)(yt,this.elements),t.set(yt[0],yt[1],yt[2],yt[3]),t},i.getScale=function(t){return void 0===t&&(t=new mt),(0,d.Q$)(yt,this.elements),t.set(yt[0],yt[1],yt[2]),t},i.getTranslation=function(t){return void 0===t&&(t=new mt),(0,d.i0)(yt,this.elements),t.set(yt[0],yt[1],yt[2]),t},i.rotateX=function(t){return(0,d.lM)(this.elements,this.elements,t),this},i.rotateY=function(t){return(0,d.uD)(this.elements,this.elements,t),this},i.rotateZ=function(t){return(0,d.jI)(this.elements,this.elements,t),this},i.compose=function(t,e,i){return(0,d.Iw)(this.elements,e.elements,t.elements,i.elements),this},i.decompose=function(){return{rotation:this.getRotation(),scale:this.getScale(),translation:this.getTranslation()}},i.copy=function(t){return(0,d.JG)(this.elements,t.elements),this},i.clone=function(){return(new e).copy(this)},i.toString=function(){return(0,d.Bd)(this.elements)},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[12]}},{key:"y",get:function(){return this.elements[13]}},{key:"z",get:function(){return this.elements[14]}},{key:"w",get:function(){return this.elements[15]}}],[{key:"identity",get:function(){return(new e).fromArray((0,d.yR)())}}]),e}(pt),bt=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},Et=function(t,e,i){return bt(t,e,"read from private field"),i?i.call(t):e.get(t)},At=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},xt=function(t,e,i,n){return bt(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Tt=function(t){function e(e,i,n,s){var a;void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s="xyz"),(a=t.call(this)||this).elements=new Float32Array(3),At((0,r.Z)(a),dt,[]),At((0,r.Z)(a),ft,"xyz");var o=a.elements;return o[0]=e,o[1]=i,o[2]=n,xt((0,r.Z)(a),ft,s),a}(0,s.Z)(e,t);var i=e.prototype;return i.fromObject=function(t){var e=t.x,i=t.y,n=t.z,r=t.order;return void 0!==e&&(this.x=e),void 0!==i&&(this.y=i),void 0!==n&&(this.z=n),void 0!==r&&(this.order=r),this.triggerChange(),this},i.toObject=function(){return{x:this.x,y:this.y,z:this.z,order:this.order}},i.fromRotationMatrix=function(t,e,i){void 0===e&&(e=Et(this,ft)),void 0===i&&(i=!0);var n=t.toArray(),r=n[0],s=n[4],a=n[8],o=n[1],h=n[5],l=n[9],u=n[2],c=n[6],d=n[10];switch(e){case"xyz":this.y=Math.asin(E(a,-1,1)),Math.abs(a)<.9999999?(this.x=Math.atan2(-l,d),this.z=Math.atan2(-s,r)):(this.x=Math.atan2(c,h),this.z=0);break;case"yxz":this.x=Math.asin(-E(l,-1,1)),Math.abs(l)<.9999999?(this.y=Math.atan2(a,d),this.z=Math.atan2(o,h)):(this.y=Math.atan2(-u,r),this.z=0);break;case"zxy":this.x=Math.asin(E(c,-1,1)),Math.abs(c)<.9999999?(this.y=Math.atan2(-u,d),this.z=Math.atan2(-s,h)):(this.y=0,this.z=Math.atan2(o,r));break;case"zyx":this.y=Math.asin(-E(u,-1,1)),Math.abs(u)<.9999999?(this.x=Math.atan2(c,d),this.z=Math.atan2(o,r)):(this.x=0,this.z=Math.atan2(-s,h));break;case"yzx":this.z=Math.asin(E(o,-1,1)),Math.abs(o)<.9999999?(this.x=Math.atan2(-l,h),this.y=Math.atan2(-u,r)):(this.x=0,this.y=Math.atan2(a,d));break;case"xzy":this.z=Math.asin(-E(s,-1,1)),Math.abs(s)<.9999999?(this.x=Math.atan2(c,h),this.y=Math.atan2(a,r)):(this.x=Math.atan2(-l,d),this.y=0);break;default:throw new Error("Unknown Euler angle order")}return xt(this,ft,e),i&&this.triggerChange(),this},i.fromQuaternion=function(t){var i=t.elements,n=i[0],r=i[1],s=i[2],a=i[3],o=r*r,h=-2*(o+s*s)+1,l=2*(n*r+a*s),u=-2*(n*s-a*r),c=2*(r*s+a*n),d=-2*(n*n+o)+1;return u=(u=u>1?1:u)<-1?-1:u,new e(Math.atan2(c,d),Math.asin(u),Math.atan2(l,h),"zyx")},i.fromVector3=function(t,e){return void 0===e&&(e=Et(this,ft)),this.set(t.x,t.y,t.z,e)},i.toQuaternion=function(){var t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),i=Math.cos(.5*this.roll),n=Math.sin(.5*this.roll),r=Math.cos(.5*this.pitch),s=Math.sin(.5*this.pitch);return new ct(t*n*r-e*i*s,t*i*s+e*n*r,e*i*r-t*n*s,t*i*r+e*n*s)},i.toVector3=function(){return new mt(this.x,this.y,this.z)},i.set=function(t,e,i,n){return void 0===n&&(n=Et(this,ft)),this.elements[0]=t,this.elements[1]=e,this.elements[2]=i,xt(this,ft,n),this.triggerChange(),this},i.clone=function(){return(new e).copy(this)},i.copy=function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]=t.elements[e];return xt(this,ft,t.order),this.triggerChange(),this},i.equals=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.order===t.order},i.onChange=function(t){Et(this,dt).includes(t)||Et(this,dt).push(t)},i.triggerChange=function(){Et(this,dt).forEach((function(t){return t()}))},(0,a.Z)(e,[{key:"x",get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.triggerChange()}},{key:"y",get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.triggerChange()}},{key:"z",get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.triggerChange()}},{key:"order",get:function(){return Et(this,ft)},set:function(t){xt(this,ft,t),this.triggerChange()}},{key:"roll",get:function(){return this.x},set:function(t){this.x=t}},{key:"pitch",get:function(){return this.y},set:function(t){this.y=t}},{key:"yaw",get:function(){return this.z},set:function(t){this.z=t}}]),e}(ot);dt=new WeakMap,ft=new WeakMap,(0,f.l7)([function(t,e){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in i)n[i[r]]=r;var s={};t.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var r,a,o=n[this.toHex()];if(o)return o;if(null==e?void 0:e.closest){var h=this.toRgb(),l=1/0,u="black";if(!s.length)for(var c in i)s[c]=new t(i[c]).toRgb();for(var d in i){var f=(r=h,a=s[d],Math.pow(r.r-a.r,2)+Math.pow(r.g-a.g,2)+Math.pow(r.b-a.b,2));f<l&&(l=f,u=d)}return u}},e.string.push([function(e){var n=e.toLowerCase(),r="transparent"===n?"#0000":i[n];return r?new t(r).toRgb():null},"name"])}]);var Mt,St,kt,Rt,_t=function(t,e,i){var n=F(t),r=i-e,s=E(Number.parseFloat(""+t),e,i);return n&&(s=Number.parseInt(""+t*i,10)/100),Math.abs(s-i)<1e-6?1:t%r/r},Ft=function(){function t(t,e,i,n,r){if(void 0===t&&(t=255),void 0===n&&(n=1),void 0===r&&(r=!1),this.r=1,this.g=1,this.b=1,this.a=1,_(e)&&_(i))if(C(t)&&t<=255)this.setRGBA(t,t,t,this.a,r);else{var s=(0,f.Vi)(t).toRgb();s?this.setRGBA(s.r,s.g,s.b,s.a):console.error("Unsupported color value {".concat(String(t),"} provided"))}else this.setRGBA(t,e,i,n)}var e=t.prototype;return e.fromColor=function(t){var e=(0,f.Vi)(t).toRgb();return this.setRGBA(e.r,e.g,e.b,e.a)},e.fromHSL=function(t,e,i,n){void 0===n&&(n=1);var r=(0,f.Vi)({h:t,s:e,l:i,a:n}).toRgb();return this.setRGBA(r.r,r.g,r.b,r.a)},e.fromHSV=function(t,e,i,n){void 0===n&&(n=1);var r=(0,f.Vi)({h:t,s:e,v:i,a:n}).toRgb();return this.setRGBA(r.r,r.g,r.b,r.a)},e.setRGB=function(t,e,i){return this.setRGBA(t,e,i,this.a),this},e.setRGBA=function(t,e,i,n,r){return this.r=r?t:_t(t,0,255),this.g=r?e:_t(e,0,255),this.b=r?i:_t(i,0,255),this.setAlpha(n),this},e.setAlpha=function(t){return this.a=t>1?_t(t,0,255):t,this},e.toHex=function(){return(0,f.Vi)(this.toObject()).toHex()},e.toHSL=function(){return(0,f.Vi)(this.toObject()).toHsl()},e.toHSV=function(){return(0,f.Vi)(this.toObject()).toHsv()},e.toObject=function(t){void 0===t&&(t=!1);var e=t?1:255;return{r:this.r*e,g:this.g*e,b:this.b*e,a:this.a}},e.toArray=function(){return[this.r,this.g,this.b,this.a]},e.toVector=function(){return(new gt).fromArray(this.toArray())},e.toVector3=function(){return(new mt).fromArray(this.toArray())},e.toString=function(){return this.constructor.name+"("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},t}(),Ct=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var i=e.prototype;return i.frustum=function(t,e,i,n,r,s,a){return(0,d.oy)(t.elements,e,i,r,n,s,a),this},i.orthographic=function(t,e,i,n,r,s){return(0,d.M5)(this.elements,t,e,n,i,r,s),this},i.perspective=function(t,e,i,n){return(0,d.G3)(this.elements,t,e,i,n),this},i.lookAt=function(t,e,i){return void 0===e&&(e=new mt(0,0,0)),void 0===i&&(i=new mt(0,1,0)),(0,d.zB)(this.elements,t.elements,e.elements,i.elements),this},e}(wt),Ut=function(){function t(){var t=this;this.visible=!0,this.localMatrix=new Ct,this.worldMatrix=new Ct,this.matrixAutoUpdate=!0,this.position=new mt,this.scale=new mt(1,1,1),this.rotation=new Tt,this.quaternion=new ct,this.up=new mt(0,1,0),this.parent=null,this.children=[],this.worldMatrixNeedsUpdate=!1,this.rotation.onChange((function(){t.quaternion.fromEuler(t.rotation)})),this.quaternion.onChange((function(){t.rotation.fromQuaternion(t.quaternion)}))}var e=t.prototype;return e.add=function(t,e){void 0===e&&(e=!0),this.contains(t)||this.children.push(t),e&&t.setParent(this,!1)},e.remove=function(t,e){void 0===e&&(e=!0),this.contains(t)&&this.children.splice(this.children.indexOf(t),1),e&&t.setParent(null,!1)},e.contains=function(t){return this.children.includes(t)},e.setParent=function(t,e){void 0===e&&(e=!0),this.parent&&t!==this.parent&&this.parent.remove(this,!1),this.parent=t,e&&t&&t.add(this,!1)},e.traverse=function(t){if(!t(this))for(var e=0,i=this.children.length;e<i;e++)this.children[e].traverse(t)},e.lookAt=function(t,e){e?this.localMatrix.lookAt(this.position,t,this.up):this.localMatrix.lookAt(t,this.position,this.up),this.quaternion=this.localMatrix.getRotation(),this.rotation.fromQuaternion(this.quaternion)},e.updateMatrixWorld=function(t){var e=t;this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(null===this.parent?this.worldMatrix.copy(this.localMatrix):(this.worldMatrix.multiply(this.parent.worldMatrix,this.localMatrix),this.worldMatrixNeedsUpdate=!1,e=!0));for(var i=0,n=this.children.length;i<n;i++){this.children[i].updateMatrixWorld(e)}},e.updateMatrix=function(){this.localMatrix.compose(this.position,this.quaternion,this.scale),this.worldMatrixNeedsUpdate=!0},e.decompose=function(){this.localMatrix.getTranslation(this.position),this.localMatrix.getRotation(this.quaternion),this.localMatrix.getScale(this.scale),this.rotation.fromQuaternion(this.quaternion)},e.clone=function(){return(new t).copy(this,!1)},e.copy=function(t,e){if(this.visible=t.visible,this.position.copy(t.position),this.scale.copy(t.scale),this.rotation.copy(t.rotation),this.quaternion.copy(t.quaternion),this.up.copy(t.up),this.localMatrix.copy(t.localMatrix),this.worldMatrix.copy(t.worldMatrix),this.matrixAutoUpdate=t.matrixAutoUpdate,e)for(var i=0,n=t.children.length;i<n;i++){var r=t.children[i];this.add(r.clone())}return this},t}(),Ot=function(){function t(t){this.renderer=t}return(0,a.Z)(t,[{key:"gl",get:function(){return this.renderer.gl}},{key:"rendererState",get:function(){return this.renderer.state}}]),t}(),Nt=function(t,e){var i,n,r=Object.assign({},{size:1,normalized:!0,stride:0,offset:0,divisor:0,usage:t.gl.STATIC_DRAW},e);if(this.id=I("attribute"),this.needsUpdate=!1,!e.data||Array.isArray(e.data))throw new TypeError("BufferAttribute: data should be a typed array");this.data=r.data,this.size=r.size||1,this.type=r.type||(i=t.gl,(n=r.data)instanceof Float32Array||n instanceof Float64Array?i.FLOAT:n instanceof Uint16Array?i.UNSIGNED_SHORT:n instanceof Uint8Array||n instanceof Uint8ClampedArray?i.UNSIGNED_BYTE:n instanceof Uint32Array?i.UNSIGNED_INT:n instanceof Int8Array?i.BYTE:n instanceof Int16Array?i.SHORT:n instanceof Int32Array?i.INT:void 0),this.normalized=r.normalized||!1,this.stride=r.stride||0,this.offset=r.offset||0,this.divisor=r.divisor||0,this.instanced=r.divisor>0,this.usage=r.usage||t.gl.STATIC_DRAW,r.target&&(this.target=r.target);var s=r.count;void 0!==r.count&&null!==r.count||(s=r.stride?r.data.byteLength/r.stride:r.data.length/r.size),this.count=s},Lt=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},It=function(t,e,i){return Lt(t,e,"read from private field"),i?i.call(t):e.get(t)},Dt=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Wt=function(t,e,i,n){return Lt(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Pt=new mt,Bt=function(t){function e(e,i){var n;for(var s in void 0===i&&(i={}),n=t.call(this,e)||this,Dt((0,r.Z)(n),Mt,void 0),Dt((0,r.Z)(n),St,void 0),Dt((0,r.Z)(n),kt,void 0),Dt((0,r.Z)(n),Rt,void 0),n.drawRange={start:0,count:0},n.instancedCount=0,n.isInstanced=!1,Wt((0,r.Z)(n),St,new Map),Wt((0,r.Z)(n),kt,new Map),Wt((0,r.Z)(n),Mt,I("geometry")),n.drawMode=n.gl.TRIANGLES,e.bindVertexArray(null),e.state.setActiveGeometry(null),i){var a=i[s];if(a instanceof Nt)"index"===s?n.setIndex(a):n.addAttribute(s,a);else if(a.data){var o=new Nt(n.renderer,a);"index"===s?n.setIndex(o):n.addAttribute(s,o)}}return n}(0,s.Z)(e,t);var i=e.prototype;return i.addAttribute=function(t,e){if(e.target||(e.target="index"===t?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER),e.needsUpdate=!1,this.attributes.set(t,e),e.buffer||(e.buffer=this.gl.createBuffer(),this.updateAttribute(e)),e.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==e.count*e.divisor)return this.instancedCount=Math.min(this.instancedCount,e.count*e.divisor),console.warn("Geometry has multiple instanced buffers of different length - instancedCount: "+this.instancedCount+", count: "+e.count+", divisor: "+e.divisor+", attribute: "+t);this.instancedCount=e.count*e.divisor}else"index"===t?this.drawRange.count=e.count:this.index||(this.drawRange.count=Math.max(this.drawRange.count,e.count))},i.getAttribute=function(t){return this.attributes.get(t)},i.setAttributeData=function(t,e){var i=this.getAttribute(t);i&&(i.data=e,i.needsUpdate=!0)},i.updateAttribute=function(t){this.rendererState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.rendererState.boundBuffer=t.buffer),this.gl.bufferData(t.target,t.data,t.usage),t.needsUpdate=!1},i.removeAttribute=function(t){this.attributes.delete(t)},i.setIndex=function(t){var e;if(t instanceof Nt)t.size=1,this.addAttribute("index",t);else{var i=new Nt(this.renderer,{data:t.length>65535?new Uint32Array(t):new Uint16Array(t),size:1});this.addAttribute("index",i)}this.drawRange.count=null==(e=this.index)?void 0:e.count},i.setVertices=function(t){for(var e=[],i=t.length,n=0;n<i;n++){var r=t[n];e.push(r[0],r[1],r[2])}this.addAttribute("position",new Nt(this.renderer,{data:new Float32Array(e),size:3}))},i.setNormals=function(t){this.addAttribute("normal",new Nt(this.renderer,{data:new Float32Array(t),size:2}))},i.setUVs=function(t){this.addAttribute("uv",new Nt(this.renderer,{data:new Float32Array(t),size:2}))},i.setColors=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];n&&(n instanceof mt||n instanceof gt)&&(n=n.toArray()),e.push(n[0],n[1],n[2],n[3]||1)}this.addAttribute("color",new Nt(this.renderer,{data:new Float32Array(e),size:4}))},i.setDrawRange=function(t,e){this.drawRange.start=t,this.drawRange.count=e},i.setInstancedCount=function(t){this.instancedCount=t},i.createVAO=function(t){var e=t.attributeOrder,i=this.renderer.createVertexArray();this.renderer.bindVertexArray(i),It(this,kt).set(e,i),this.bindAttributes(t)},i.bindAttributes=function(t){var e=this;t.attributeLocations.forEach((function(t,i){var n=i.name,r=i.type,s=e.attributes.get(n);if(s){e.gl.bindBuffer(s.target,s.buffer),e.rendererState.boundBuffer=s.buffer;var a=1;r===e.gl.FLOAT_MAT2&&(a=2),r===e.gl.FLOAT_MAT3&&(a=3),r===e.gl.FLOAT_MAT4&&(a=4);for(var o=s.size/a,h=1===a?0:a*a*a,l=1===a?0:a*a,u=0;u<a;u++){var c=t+u;e.gl.vertexAttribPointer(c,o,s.type,s.normalized,s.stride+h,s.offset+l),e.gl.enableVertexAttribArray(c),e.renderer.vertexAttribDivisor(c,s.divisor)}}}));var i=this.attributes.get("index");i&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,i.buffer)},i.computeBoundingBox=function(){var t=this.attributes.get("position"),e=t.data,i=t.offset,n=void 0===i?0:i,r=t.stride,s=t.size;It(this,Rt)||Wt(this,Rt,{min:new mt,max:new mt,center:new mt,scale:new mt,radius:Number.POSITIVE_INFINITY}),It(this,Rt).min.setScalar(+Number.POSITIVE_INFINITY),It(this,Rt).max.setScalar(Number.NEGATIVE_INFINITY);for(var a=r||s,o=n;o<e.length;o+=a){var h=e[o+0],l=e[o+1],u=e[o+2];It(this,Rt).min.x=Math.min(h,It(this,Rt).min.x),It(this,Rt).min.y=Math.min(l,It(this,Rt).min.y),It(this,Rt).min.z=Math.min(u,It(this,Rt).min.z),It(this,Rt).max.x=Math.max(h,It(this,Rt).max.x),It(this,Rt).max.y=Math.max(l,It(this,Rt).max.y),It(this,Rt).max.z=Math.max(u,It(this,Rt).max.z)}return It(this,Rt).scale.subVectors(It(this,Rt).max,It(this,Rt).min),It(this,Rt).center.add(It(this,Rt).min).add(It(this,Rt).max).divideScalar(2),It(this,Rt)},i.computeBoundingSphere=function(){var t=this.attributes.get("position"),e=t.data,i=t.offset,n=void 0===i?0:i,r=t.stride,s=t.size;It(this,Rt)||this.computeBoundingBox();for(var a=0,o=r||s,h=n;h<e.length;h+=o)Pt.fromArray([].concat(e),h),a=Math.max(a,It(this,Rt).center.distanceToSquared(Pt));It(this,Rt).radius=Math.sqrt(a)},i.draw=function(t,e){var i=this;void 0===e&&(e=this.drawMode);var n=this.drawRange,r=n.start,s=n.count,a=this.id+"_"+t.attributeOrder;this.rendererState.activeGeometryId!==a&&(It(this,kt).get(t.attributeOrder)||this.createVAO(t),this.renderer.bindVertexArray(It(this,kt).get(t.attributeOrder)),this.rendererState.activeGeometryId=a);if(t.attributeLocations.forEach((function(t,e){var n=e.name,r=i.getAttribute(n);r&&r.needsUpdate&&i.updateAttribute(r)})),this.isInstanced)if(this.index){var o=this.index.offset+2*r;this.renderer.drawElementsInstanced(e,s,this.index.type,o,this.instancedCount)}else this.renderer.drawArraysInstanced(e,r,s,this.instancedCount);else if(this.index){var h=this.index.offset+2*r;this.gl.drawElements(e,s,this.index.type,h)}else this.gl.drawArrays(e,r,s)},i.copy=function(t){var e=t.attributesData;for(var i in e){var n=e[i];if(n instanceof Nt)"index"===i?this.setIndex(n):this.addAttribute(i,n);else if(n.data){var r=new Nt(this.renderer,n);"index"===i?this.setIndex(r):this.addAttribute(i,r)}}return t.bounds&&(this.bounds={min:(new mt).copy(t.bounds.min),max:(new mt).copy(t.bounds.max),center:(new mt).copy(t.bounds.center),scale:(new mt).copy(t.bounds.scale),radius:t.bounds.radius}),this},i.clone=function(){var t=new e(this.renderer,{}).copy(this);return t.drawMode=this.drawMode,t},i.destroy=function(){var t=this;It(this,kt).forEach((function(e){t.renderer.deleteVertexArray(e)})),It(this,kt).clear(),It(this,St).forEach((function(e){t.gl.deleteBuffer(e.buffer)})),It(this,St).clear()},(0,a.Z)(e,[{key:"id",get:function(){return It(this,Mt)}},{key:"attributes",get:function(){return It(this,St)}},{key:"attributesData",get:function(){for(var t={},e=It(this,St).entries(),i=0;i<It(this,St).size;i++){var n=e.next().value;t[n[0]]=D(n[1],["id","buffer"])}return t}},{key:"index",get:function(){return this.attributes.get("index")}},{key:"bounds",get:function(){return It(this,Rt)},set:function(t){Wt(this,Rt,t)}}]),e}(Ot),Zt=Bt;Mt=new WeakMap,St=new WeakMap,kt=new WeakMap,Rt=new WeakMap;var Gt,zt,jt,Ht,Vt,qt,Xt=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},Yt=function(t,e,i){return Xt(t,e,"read from private field"),i?i.call(t):e.get(t)},Jt=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Kt=function(t,e,i,n){return Xt(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Qt=function(t){function e(e,i){var n;void 0===i&&(i={}),n=t.call(this)||this,Jt((0,r.Z)(n),Gt,void 0),Jt((0,r.Z)(n),zt,void 0),Jt((0,r.Z)(n),jt,void 0),Jt((0,r.Z)(n),Ht,void 0),Jt((0,r.Z)(n),Vt,void 0),Jt((0,r.Z)(n),qt,void 0);var s=Object.assign({},{mode:e.gl.TRIANGLES,frustumCulled:!0,renderOrder:0},i);return n.renderer=e,n.gl=n.renderer.gl,n.modelViewMatrix=new wt,n.normalMatrix=new vt,n.renderOrder=s.renderOrder,n.frustumCulled=s.frustumCulled,n.zDepth=0,Kt((0,r.Z)(n),Gt,s.id||I("mesh")),Kt((0,r.Z)(n),jt,s.geometry),Kt((0,r.Z)(n),Ht,s.program),Kt((0,r.Z)(n),Vt,Boolean(s.wireframe)),n.mode=s.mode,Kt((0,r.Z)(n),zt,s.mode),Yt((0,r.Z)(n),Vt)&&(n.mode=n.gl.LINES,n.updateWireframeGeometry(Yt((0,r.Z)(n),Vt))),n}(0,s.Z)(e,t);var i=e.prototype;return i.draw=function(t){var e=this;void 0===t&&(t={});var i=t,n=i.camera,r=i.target,s={};n?(Object.assign(s,{projectionMatrix:n.projectionMatrix,cameraPosition:n.worldPosition,viewMatrix:n.viewMatrix}),this.modelViewMatrix.multiply(n.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix)):this.modelViewMatrix.copy(this.worldMatrix),Object.assign(s,{resolution:new ht(this.gl.canvas.width,this.gl.canvas.height),modelMatrix:this.worldMatrix,modelViewMatrix:this.modelViewMatrix,normalMatrix:this.normalMatrix}),Object.keys(s).forEach((function(t){Object.hasOwn(e.program.uniforms,t)||(e.program.uniforms[t]={value:null}),e.program.uniforms[t].value=s[t]})),r&&r.bind(),this.program.use(),this.geometry.draw(this.program,this.mode),r&&r.unbind()},i.updateWireframeGeometry=function(t,e){var i,n;if(void 0===e&&(e=!1),Yt(this,jt)&&(e||!Yt(this,qt))){Yt(this,qt)&&Yt(this,qt).destroy();var r=null==(i=Yt(this,jt).attributes.get("position"))?void 0:i.data,s=null==(n=Yt(this,jt).index)?void 0:n.data,a=s?s.length:Math.floor(r.length/3),o=[];Yt(this,jt).index?s&&g(r,o,a,s):g(r,o,a);var h=o.length>65536?new Uint32Array(o):new Uint16Array(o);Kt(this,qt,new Zt(this.renderer,Object.assign({},Yt(this,jt).attributesData,{index:{data:h}})))}},i.updateGeometry=function(t,e){void 0===e&&(e=!0),e&&Yt(this,jt)&&Yt(this,jt).destroy(),Kt(this,jt,t),this.updateWireframeGeometry(Yt(this,Vt),!0)},i.updateProgram=function(t,e){void 0===e&&(e=!0),e&&Yt(this,Ht)&&Yt(this,Ht).destroy(),Kt(this,Ht,t)},i.destroy=function(){this.program.destroy(),this.geometry.destroy()},i.clone=function(){return new e(this.gl,{geometry:this.geometry,program:this.program,frustumCulled:this.frustumCulled,mode:this.mode,renderOrder:this.renderOrder}).copy(this)},i.copy=function(e,i){return void 0===i&&(i=!0),t.prototype.copy.call(this,e,i),this.modelViewMatrix.copy(e.modelViewMatrix),this.normalMatrix.copy(e.normalMatrix),this.mode=e.mode,this.renderOrder=e.renderOrder,this.zDepth=e.zDepth,this},(0,a.Z)(e,[{key:"id",get:function(){return Yt(this,Gt)}},{key:"geometry",get:function(){return Yt(this,Vt)?Yt(this,qt):Yt(this,jt)}},{key:"program",get:function(){return Yt(this,Ht)}},{key:"wireframe",get:function(){return Yt(this,Vt)},set:function(t){this.mode=t?this.gl.LINES:Yt(this,zt),Kt(this,Vt,t),this.updateWireframeGeometry(Yt(this,Vt))}}]),e}(Ut);Gt=new WeakMap,zt=new WeakMap,jt=new WeakMap,Ht=new WeakMap,Vt=new WeakMap,qt=new WeakMap;var $t,te=function(t){function e(){return t.apply(this,arguments)||this}(0,s.Z)(e,t);var i=e.prototype;return i.clone=function(){return(new e).copy(this,!1)},i.copy=function(e,i){return t.prototype.copy.call(this,e,i),this.matrixAutoUpdate=e.matrixAutoUpdate,this},e}(Ut),ee=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},ie=function(t,e,i){return ee(t,e,"read from private field"),i?i.call(t):e.get(t)},ne=function(t,e,i,n){return ee(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},re=function(t){function e(e,i){var n;n=t.call(this,e)||this,function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(n),$t,void 0);var s=e.gl;return ne((0,r.Z)(n),$t,{viewport:{x:0,y:0,width:0,height:0}}),n.apply(i||{frontFace:s.CCW,depthTest:!1,depthWrite:!0,depthMask:!0,depthFunc:s.LESS,blending:1,blendFunc:{src:s.ONE,dst:s.ZERO},blendEquation:{modeRGB:s.FUNC_ADD},premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,framebuffer:null,textureUnits:[],activeTextureUnit:-1,activeGeometryId:null,clearAlpha:1,clearColor:new Ft(0)}),n}(0,s.Z)(e,t);var i=e.prototype;return i.apply=function(t){if(t.blending)this.setBlending(t.blending);else{if(t.blendFunc){var e=t.blendFunc,i=e.src,n=e.dst,r=e.srcAlpha,s=e.dstAlpha;this.setBlendFunc(i,n,r,s),this.enable(this.gl.BLEND)}else this.disable(this.gl.BLEND);if(t.blendEquation){var a=t.blendEquation,o=a.modeRGB,h=a.modeAlpha;this.setBlendEquation(o,h)}}_(t.cullFace)||O(t.cullFace)||this.setCullFace(t.cullFace),_(t.frontFace)||O(t.frontFace)||this.setFrontFace(t.frontFace),t.depthTest?this.enable(this.gl.DEPTH_TEST):this.disable(this.gl.DEPTH_TEST),_(t.depthMask)||O(t.depthMask)||this.setDepthMask(t.depthMask),_(t.depthWrite)||O(t.depthWrite)||this.setDepthMask(t.depthWrite),_(t.depthFunc)||O(t.depthFunc)||this.setDepthFunc(t.depthFunc),_(t.lineWidth)||O(t.lineWidth)||this.setLineWidth(t.lineWidth),ne(this,$t,Object.assign(ie(this,$t),t))},i.enable=function(t){!0!==ie(this,$t)[t]&&(this.gl.enable(t),ie(this,$t)[t]=!0)},i.disable=function(t){!1!==ie(this,$t)[t]&&(this.gl.disable(t),ie(this,$t)[t]=!1)},i.setViewport=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),ie(this,$t).viewport.width===t&&ie(this,$t).viewport.height===e||(this.gl.viewport(i,n,t,e),ie(this,$t).viewport={width:t,height:e,x:i,y:n})},i.setLocked=function(t){this.locked=t},i.setMask=function(t){ie(this,$t).colorMask===t||this.locked||(this.gl.colorMask(t,t,t,t),ie(this,$t).colorMask=t)},i.setBlending=function(t){ie(this,$t).blending=t,0===t?this.disable(this.gl.BLEND):this.enable(this.gl.BLEND),2===t?ie(this,$t).premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ONE,this.gl.ONE,this.gl.ONE,this.gl.ONE)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE)):3===t?ie(this,$t).premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE_MINUS_SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR)):4===t?ie(this,$t).premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.SRC_COLOR,this.gl.ZERO,this.gl.SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.SRC_COLOR)):1===t?ie(this,$t).premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)):5===t?console.info("TODO: \u9700\u8981\u5b9e\u73b0"):console.error("State: Invalid blending: ",t)},i.setBlendFunc=function(t,e,i,n){var r,s,a,o;t===(null==(r=ie(this,$t).blendFunc)?void 0:r.src)&&e===(null==(s=ie(this,$t).blendFunc)?void 0:s.dst)&&i===(null==(a=ie(this,$t).blendFunc)?void 0:a.srcAlpha)&&n===(null==(o=ie(this,$t).blendFunc)?void 0:o.dstAlpha)||(ie(this,$t).blendFunc={src:t,dst:e,srcAlpha:i,dstAlpha:n},_(i)||O(i)||_(n)||O(n)?this.gl.blendFunc(t,e):this.gl.blendFuncSeparate(t,e,i,n))},i.setBlendEquation=function(t,e){var i,n;t===(null==(i=ie(this,$t).blendEquation)?void 0:i.modeRGB)&&e===(null==(n=ie(this,$t).blendEquation)?void 0:n.modeAlpha)||(ie(this,$t).blendEquation={modeRGB:t,modeAlpha:e},_(e)||O(e)?this.gl.blendEquation(t):this.gl.blendEquationSeparate(t,e))},i.setClearAlpha=function(t){ie(this,$t).clearAlpha!==t&&(ie(this,$t).clearAlpha=t)},i.setClearColor=function(t,e){ie(this,$t).clearAlpha===e&&ie(this,$t).clearColor===t||(ie(this,$t).clearColor=t,_(e)||O(e)?ie(this,$t).clearAlpha=t.a:ie(this,$t).clearAlpha=e,this.gl.clearColor(t.r,t.g,t.b,ie(this,$t).clearAlpha))},i.setCullFace=function(t){ie(this,$t).cullFace!==t&&(t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),ie(this,$t).cullFace=t,this.gl.cullFace(t))},i.setFrontFace=function(t){ie(this,$t).frontFace!==t&&(ie(this,$t).frontFace=t,this.gl.frontFace(t))},i.setDepthMask=function(t){ie(this,$t).depthMask!==t&&(ie(this,$t).depthMask=t,this.gl.depthMask(t))},i.setDepthFunc=function(t){ie(this,$t).depthFunc!==t&&(ie(this,$t).depthFunc=t,this.gl.depthFunc(t))},i.setDepthTest=function(t){ie(this,$t).depthTest!==t&&(ie(this,$t).depthTest=t,t?this.enable(this.gl.DEPTH_TEST):this.disable(this.gl.DEPTH_TEST))},i.setStencil=function(t,e,i){ie(this,$t).stencil.func===t&&ie(this,$t).stencil.ref===e&&ie(this,$t).stencil.mask===i||(ie(this,$t).stencil={func:t,ref:e,mask:i},this.gl.stencilFunc(t,e,i))},i.setActiveTexture=function(t){ie(this,$t).activeTextureUnit!==t&&(ie(this,$t).activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))},i.setLineWidth=function(t){ie(this,$t).lineWidth!==t&&(ie(this,$t).lineWidth=t,this.gl.lineWidth(t))},i.setPolygonOffset=function(t,e,i){t?(this.enable(this.gl.POLYGON_OFFSET_FILL),ie(this,$t).polygonOffsetFactor===e&&ie(this,$t).polygonOffsetUnits===i||(this.gl.polygonOffset(e,i),ie(this,$t).polygonOffsetFactor=e,ie(this,$t).polygonOffsetUnits=i)):this.disable(this.gl.POLYGON_OFFSET_FILL)},i.bindFramebuffer=function(t){void 0===t&&(t={});var e=t,i=e.target,n=void 0===i?this.gl.FRAMEBUFFER:i,r=e.buffer,s=void 0===r?null:r;ie(this,$t).framebuffer!==s&&(ie(this,$t).framebuffer=s,this.gl.bindFramebuffer(n,s))},i.setActiveGeometry=function(t){ie(this,$t).activeGeometryId=t},(0,a.Z)(e,[{key:"state",get:function(){return ie(this,$t)}},{key:"viewport",get:function(){return ie(this,$t).viewport}},{key:"textureUnits",get:function(){return ie(this,$t).textureUnits}},{key:"activeTextureUnit",get:function(){return ie(this,$t).activeTextureUnit},set:function(t){ie(this,$t).activeTextureUnit=t}},{key:"currentProgramId",get:function(){return ie(this,$t).currentProgramId},set:function(t){ie(this,$t).currentProgramId=t}},{key:"activeGeometryId",get:function(){return ie(this,$t).activeGeometryId},set:function(t){ie(this,$t).activeGeometryId=t}},{key:"flipY",get:function(){return ie(this,$t).flipY},set:function(t){ie(this,$t).flipY=t}},{key:"unpackAlignment",get:function(){return ie(this,$t).unpackAlignment},set:function(t){ie(this,$t).unpackAlignment=t}},{key:"premultiplyAlpha",get:function(){return ie(this,$t).premultiplyAlpha},set:function(t){ie(this,$t).premultiplyAlpha=t}}]),e}(Ot);$t=new WeakMap;var se,ae,oe,he,le,ue,ce,de,fe,me,ge,pe,ve,ye=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},we=function(t,e,i){return ye(t,e,"read from private field"),i?i.call(t):e.get(t)},be=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Ee=function(t,e,i,n){return ye(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Ae=function(){function t(t,e){void 0===e&&(e={}),be(this,se,void 0),be(this,ae,void 0),be(this,oe,void 0),be(this,he,void 0),be(this,le,void 0),be(this,ue,void 0),be(this,ce,void 0),be(this,de,void 0),be(this,fe,void 0),be(this,me,void 0),be(this,ge,void 0),be(this,pe,void 0),be(this,ve,void 0);var i=Object.assign({},{autoClear:!0,depth:!0,alpha:!1,stencil:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,requestWebGl2:!0},e);Ee(this,he,Boolean(i.autoClear)),Ee(this,le,i.depth),Ee(this,ue,i.alpha),Ee(this,ce,i.stencil),Ee(this,de,i.antialias),Ee(this,fe,i.premultipliedAlpha),Ee(this,me,i.preserveDrawingBuffer),Ee(this,se,x(t)||T(t)?t:M(t,{alpha:we(this,ue),depth:we(this,le),stencil:we(this,ce),antialias:we(this,de),powerPreference:i.powerPreference,premultipliedAlpha:we(this,fe),preserveDrawingBuffer:we(this,me)},i.requestWebGl2)),Ee(this,ae,new re(this)),Ee(this,ge,!0),Ee(this,pe,i.dpr||1),Ee(this,ve,!!i.frustumCull),Ee(this,oe,{}),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES")}var e=t.prototype;return e.setSize=function(t,e){this.width=t,this.height=e,this.gl.canvas.width=t*we(this,pe),this.gl.canvas.height=e*we(this,pe)},e.setViewport=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),we(this,ae).setViewport(t,e,i,n)},e.getExtension=function(t,e,i){var n=this.gl[e];if(e&&n)return n.bind(this.gl);we(this,oe)[t]||(we(this,oe)[t]=this.gl.getExtension(t));var r=we(this,oe)[t];return e?r?r[i].bind(r):null:r},e.getRenderList=function(t){var e=this,i=t.scene,n=t.camera,r=[];return i.traverse((function(t){if(!t.visible)return!0;t.draw&&(we(e,ve)&&t.frustumCulled&&n&&!n.frustumIntersectsMesh(t)||r.push(t))})),r},e.render=function(t){var e=t.scene,i=t.camera,n=t.target,r=void 0===n?null:n,s=t.update,a=void 0===s||s,o=t.clear;null===r?(we(this,ae).bindFramebuffer({buffer:null}),this.setViewport(this.width*we(this,pe),this.height*we(this,pe))):(r.bind(),this.setViewport(r.width,r.height)),(o||we(this,he)&&!1!==o)&&(!we(this,le)||r&&!r.depth||(we(this,ae).enable(this.gl.DEPTH_TEST),we(this,ae).setDepthMask(!0)),this.gl.clear((we(this,ge)?this.gl.COLOR_BUFFER_BIT:0)|(we(this,le)?this.gl.DEPTH_BUFFER_BIT:0)|(we(this,ce)?this.gl.STENCIL_BUFFER_BIT:0))),a&&e.updateMatrixWorld(),i&&i.updateMatrixWorld();for(var h=this.getRenderList({scene:e,camera:i}),l=0,u=h.length;l<u;l++){h[l].draw({camera:i})}},(0,a.Z)(t,[{key:"gl",get:function(){return we(this,se)}},{key:"canvas",get:function(){return we(this,se).canvas}},{key:"isWebGL",get:function(){return x(this.gl)}},{key:"isWebGL2",get:function(){return T(this.gl)}},{key:"size",get:function(){return{width:"clientWidth"in this.canvas?this.canvas.clientWidth:this.canvas.width,height:"clientHeight"in this.canvas?this.canvas.clientHeight:this.canvas.height}}},{key:"state",get:function(){return we(this,ae)}},{key:"premultipliedAlpha",get:function(){return we(this,fe)}}]),t}();se=new WeakMap,ae=new WeakMap,oe=new WeakMap,he=new WeakMap,le=new WeakMap,ue=new WeakMap,ce=new WeakMap,de=new WeakMap,fe=new WeakMap,me=new WeakMap,ge=new WeakMap,pe=new WeakMap,ve=new WeakMap;var xe,Te=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},Me=function(t,e,i){return Te(t,e,"read from private field"),i?i.call(t):e.get(t)},Se=function(t,e,i,n){return Te(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},ke="Resource subclass must define virtual methods",Re=function(t){function e(e,i){var n;return void 0===i&&(i={}),n=t.call(this,e)||this,function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(n),xe,void 0),n.id=(null==i?void 0:i.id)||I(n.constructor.name),n.name=null==i?void 0:i.name,n.userData=null==i?void 0:i.userData,Se((0,r.Z)(n),xe,null==i?void 0:i.handle),n.options=i,void 0===Me((0,r.Z)(n),xe)&&Se((0,r.Z)(n),xe,n.createHandle()),n.byteLength=0,n}(0,s.Z)(e,t);var i=e.prototype;return i.destroy=function(){this.delete()},i.delete=function(t){var e=(void 0===t?{}:t).deleteChildren,i=void 0!==e&&e,n=this.handle&&this.deleteHandle(this.handle);return this.handle&&this.removeStats(),Se(this,xe,null),n&&i&&n.filter(Boolean).forEach((function(t){return t.delete()})),this},i.bind=function(t){throw void 0===t&&(t=this.handle),new Error(ke)},i.unbind=function(){this.bind(null)},i.removeStats=function(){throw new Error(ke)},i.createHandle=function(){throw new Error(ke)},i.deleteHandle=function(){throw new Error(ke)},i.toString=function(){return this.constructor.name+"("+this.id+")"},(0,a.Z)(e,[{key:"handle",get:function(){return Me(this,xe)}}]),e}(Ot);xe=new WeakMap;var _e,Fe=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},Ce=function(t,e,i){return Fe(t,e,"read from private field"),i?i.call(t):e.get(t)},Ue=function(t){function e(e,i){var n,s,a,o,h;return void 0===i&&(i={}),n=t.call(this,e,Object.assign({},i,{format:i.format||e.gl.DEPTH_COMPONENT16}))||this,function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(n),_e,void 0),s=(0,r.Z)(n),a=_e,o=n.options.format,Fe(s,a,"write to private field"),h?h.call(s,o):a.set(s,o),n.width=n.options.width,n.height=n.options.height,console.assert(n.width>0&&n.height>0,"Renderbuffer object requires valid width and height greater than zero"),n.bind(),e.gl.renderbufferStorage(e.gl.RENDERBUFFER,Ce((0,r.Z)(n),_e),n.width,n.height),n}(0,s.Z)(e,t);var i=e.prototype;return i.resize=function(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.bind(),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,Ce(this,_e),t,e),this.unbind())},i.bind=function(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.handle)},i.unbind=function(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null)},i.destroy=function(){this.unbind(),this.deleteHandle()},i.createHandle=function(){return this.gl.createRenderbuffer()},i.deleteHandle=function(){this.handle&&this.gl.deleteRenderbuffer(this.handle)},e}(Re);_e=new WeakMap;var Oe,Ne=function(t,e,i){return function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)}(t,e,"read from private field"),i?i.call(t):e.get(t)},Le=function(t){function e(e,i,n){var s;void 0===i&&(i={}),void 0===n&&(n=!0);var a=e.gl,o={type:a.UNSIGNED_BYTE,format:a.RGBA,internalFormat:i.format||a.RGBA,wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,generateMipmaps:!0,minFilter:a.LINEAR,magFilter:a.LINEAR,premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,level:0},h=Object.assign({},o,i);return(s=t.call(this,e,h)||this).needsUpdate=!1,s.textureUnit=0,function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(s),Oe,{}),s.needsUpdate=!1,s.textureUnit=0,s.image=s.options.image,s.width=s.options.width,s.height=s.options.height,Ne((0,r.Z)(s),Oe).version=-1,s.needsUpdate=Boolean(n),s.needsUpdate&&s.update(),s}(0,s.Z)(e,t);var i=e.prototype;return i.setData=function(t,e,i){void 0===e&&(e=this.width),void 0===i&&(i=this.height),this.image=t,this.width=e,this.height=i,this.needsUpdate=!0},i.setOptions=function(t){this.options=Object.assign(this.options,t),this.width=this.options.width,this.height=this.options.height,this.needsUpdate=!0},i.fromSrc=function(t){var e=this;return new Promise((function(i,n){var r=new Image;r.onload=function(){e.setData(r,r.width,r.height),i(e)},r.onerror=function(t){n(t)},r.crossOrigin="*",r.src=t}))},i.update=function(t){void 0===t&&(t=0);var e=!(this.image===Ne(this,Oe).image&&!this.needsUpdate);(e||this.rendererState.textureUnits[t]!==this.id||this.rendererState.activeTextureUnit!==t)&&(this.rendererState.setActiveTexture(t),this.bind(t)),e&&(this.needsUpdate=!1,this.options.wrapS!==Ne(this,Oe).wrapS&&(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.options.wrapS),Ne(this,Oe).wrapS=this.options.wrapS),this.options.wrapT!==Ne(this,Oe).wrapT&&(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.options.wrapT),Ne(this,Oe).wrapT=this.options.wrapT),this.options.minFilter!==Ne(this,Oe).minFilter&&(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.options.minFilter),Ne(this,Oe).minFilter=this.options.minFilter),this.options.magFilter!==this.rendererState.magFilter&&(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.options.magFilter),this.rendererState.magFilter=this.options.magFilter),this.options.flipY!==this.rendererState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.options.flipY),this.rendererState.flipY=this.options.flipY),this.options.premultiplyAlpha!==this.rendererState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),this.rendererState.premultiplyAlpha=this.options.premultiplyAlpha),this.options.unpackAlignment!==this.rendererState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.options.unpackAlignment),this.rendererState.unpackAlignment=this.options.unpackAlignment),this.image?(this.image.width&&(this.width=this.image.width,this.height=this.image.height),ArrayBuffer.isView(this.image)?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,this.image):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.options.internalFormat,this.options.format,this.options.type,this.image),this.options.generateMipmaps&&(this.renderer.isWebGL2||A(this.image.width)&&A(this.image.height)?this.gl.generateMipmap(this.gl.TEXTURE_2D):(this.options.generateMipmaps=!1,this.options.wrapS=this.gl.CLAMP_TO_EDGE,this.options.wrapT=this.options.wrapS,this.options.minFilter=this.gl.LINEAR))):this.width>0?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(4)),Ne(this,Oe).image=this.image,Ne(this,Oe).version+=1)},i.bind=function(t){void 0===t&&(t=this.textureUnit),this.rendererState.textureUnits[this.rendererState.activeTextureUnit]!==this.id&&(this.textureUnit=t,this.rendererState.textureUnits[this.textureUnit]=this.id,this.gl.bindTexture(this.gl.TEXTURE_2D,this.handle))},i.unbind=function(){this.gl.activeTexture(this.gl.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.gl.TEXTURE_2D,null),delete this.rendererState.textureUnits[this.textureUnit]},i.destroy=function(){this.unbind(),t.prototype.destroy.call(this)},i.createHandle=function(){return this.gl.createTexture()},i.deleteHandle=function(){this.handle&&this.gl.deleteTexture(this.handle)},i.toString=function(){return"Texture("+this.id+","+this.width+"x"+this.height+")"},e}(Re);Oe=new WeakMap;var Ie,De,We,Pe,Be,Ze=function(t){function e(e,i){var n;return void 0===i&&(i={}),(n=t.call(this,e,Object.assign({},i,{image:i.data,premultiplyAlpha:!0,flipY:!1,unpackAlignment:1}))||this).needsUpdate=!0,n}return(0,s.Z)(e,t),e}(Le),Ge=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},ze=function(t,e,i){return Ge(t,e,"read from private field"),i?i.call(t):e.get(t)},je=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},He=function(t,e,i,n){return Ge(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Ve=function(t){function e(e,i){var n;void 0===i&&(i={}),n=t.call(this,e,Object.assign({color:1,depth:!0,depthTexture:!1,stencil:!1},i))||this,je((0,r.Z)(n),Ie,void 0),je((0,r.Z)(n),De,void 0),je((0,r.Z)(n),We,void 0),je((0,r.Z)(n),Pe,void 0),je((0,r.Z)(n),Be,void 0),He((0,r.Z)(n),De,new Map),He((0,r.Z)(n),Ie,new Map),n.depth=Boolean(i.depth),n.drawBuffers=[],n.drawBuffersChanged=!1,n.width=n.options.width,n.height=n.options.height,n.viewport=new gt(0,0,n.width,n.height),n.name=n.options.name;var s=n.options.attachments||[];if(0===s.length){for(var a=0;a<n.options.color;a++){var o=Object.assign({wrapS:n.gl.CLAMP_TO_EDGE,wrapT:n.gl.CLAMP_TO_EDGE,minFilter:n.gl.LINEAR,magFilter:n.gl.LINEAR,type:n.gl.UNSIGNED_BYTE,format:n.gl.RGBA,flipY:!1,generateMipmaps:!1},i),h=void 0;h=o.data?new Ze(e,o):new Le(e,D(o,["data","name","attachments","depthTexture"])),s.push([n.gl.COLOR_ATTACHMENT0+a,h])}if(i.depthTexture&&(e.isWebGL2||e.gl.getExtension("WEBGL_depth_texture"))){var l=new Le(e,{width:n.width,height:n.height,minFilter:n.gl.NEAREST,magFilter:n.gl.NEAREST,format:n.gl.DEPTH_COMPONENT,internalFormat:e.isWebGL2?n.gl.DEPTH_COMPONENT16:n.gl.DEPTH_COMPONENT,type:n.gl.UNSIGNED_INT});s.push([n.gl.DEPTH_ATTACHMENT,l])}else{var u=i,c=u.depth,d=u.stencil;if(c&&!d){var f=new Ue(e,{format:n.gl.DEPTH_COMPONENT16,width:n.width,height:n.height});s.push([n.gl.DEPTH_ATTACHMENT,f])}else if(d&&!c){var m=new Ue(e,{format:n.gl.STENCIL_INDEX8,width:n.width,height:n.height});s.push([n.gl.STENCIL_ATTACHMENT,m])}else if(c&&d){var g=new Ue(e,{format:n.gl.DEPTH_STENCIL,width:n.width,height:n.height});s.push([n.gl.DEPTH_STENCIL_ATTACHMENT,g])}}}return n.create(s),n}(0,s.Z)(e,t);var i=e.prototype;return i.create=function(t){var e=this;He(this,We,[]),He(this,Pe,1),He(this,Be,0);for(var i,r=(0,n.Z)(t);!(i=r()).done;){var s=i.value,a=s[0],o=s[1];o instanceof Ue?ze(this,De).set(a,o):o instanceof Le&&(ze(this,Ie).set(a,o),this.drawBuffers.push(a));var h=a-this.gl.COLOR_ATTACHMENT0;ze(this,We)[h]=[0,0,0,0]}this.options.color>1&&this.renderer.isWebGL2&&this.gl.drawBuffers(this.drawBuffers),this.drawBuffersChanged=!0,this.bind(),ze(this,De).forEach((function(t,i){e.gl.framebufferRenderbuffer(e.gl.FRAMEBUFFER,i,e.gl.RENDERBUFFER,t.handle)})),ze(this,Ie).forEach((function(t,i){e.gl.framebufferTexture2D(e.gl.FRAMEBUFFER,i,e.gl.TEXTURE_2D,t.handle,0)})),this.unbind();var l=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);if(l!==this.gl.FRAMEBUFFER_COMPLETE)switch(l){case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete");case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment");case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error(" Height and width of the attachment are not the same.");case this.gl.FRAMEBUFFER_UNSUPPORTED:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer")}return this.handle},i.clear=function(){this.bind();var t=0;if(this.clearColors[0]){var e=this.clearColors[0];this.gl.clearColor(e[0],e[1],e[2],e[3]),t|=this.gl.COLOR_BUFFER_BIT}C(ze(this,Pe))&&(this.gl.clearDepth(ze(this,Pe)),t|=this.gl.DEPTH_BUFFER_BIT),C(ze(this,Be))&&(this.gl.clearStencil(ze(this,Be)),t|=this.gl.STENCIL_BUFFER_BIT),this.gl.clear(t),this.unbind()},i.getTexture=function(t){return ze(this,Ie).get(t)},i.resize=function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,ze(this,Ie).forEach((function(i){i.width===t&&i.height===e||(i.width=t,i.height=e,i.needsUpdate=!0,i.update())})),ze(this,De).forEach((function(i){i.resize(t,e)})),this.viewport.set(0,0,t,e))},i.bind=function(t){void 0===t&&(t=this.gl.FRAMEBUFFER),this.gl.bindFramebuffer(t,this.handle)},i.unbind=function(t){void 0===t&&(t=this.gl.FRAMEBUFFER),this.gl.bindFramebuffer(t,null)},i.destroy=function(){ze(this,Ie).forEach((function(t){t.destroy()})),ze(this,De).forEach((function(t){t.destroy()})),this.deleteHandle()},i.createHandle=function(){return this.gl.createFramebuffer()},i.deleteHandle=function(){this.handle&&this.gl.deleteFramebuffer(this.handle)},i.toString=function(){return"RenderTarget("+this.id+","+this.width+"x"+this.height+")"},(0,a.Z)(e,[{key:"texture",get:function(){return ze(this,Ie).values().next().value}},{key:"clearColors",get:function(){return ze(this,We)},set:function(t){He(this,We,t)}},{key:"clearDepth",get:function(){return ze(this,Pe)},set:function(t){He(this,Pe,t)}},{key:"clearStencil",get:function(){return ze(this,Be)},set:function(t){He(this,Be,t)}}]),e}(Re);function qe(t,e,i,n,r,s,a,o,h,l,u,c,d,f,m,g){void 0===r&&(r=1),void 0===s&&(s=1),void 0===a&&(a=0),void 0===o&&(o=1),void 0===h&&(h=1),void 0===l&&(l=0),void 0===u&&(u=1),void 0===c&&(c=2),void 0===d&&(d=1),void 0===f&&(f=-1),void 0===m&&(m=0),void 0===g&&(g=0);for(var p=m,v=r/2,y=s/2,w=a/2,b=Math.floor(o),E=Math.floor(h),A=b+1,x=E+1,T=r/b,M=s/E,S=0;S<x;S++)for(var k=S*M-y,R=0;R<A;R++)if(t[3*m+l]=(R*T-v)*d,t[3*m+u]=k*f,t[3*m+c]=w,e[3*m+l]=0,e[3*m+u]=0,e[3*m+c]=a>=0?1:-1,i[2*m]=R/b,i[2*m+1]=1-S/E,m++,S!==E&&R!==b){var _=p+R+A*S,F=p+R+A*(S+1),C=p+R+1+A*(S+1),U=p+R+1+A*S;n[6*g]=_,n[6*g+1]=F,n[6*g+2]=U,n[6*g+3]=F,n[6*g+4]=C,n[6*g+5]=U,g++}}Ie=new WeakMap,De=new WeakMap,We=new WeakMap,Pe=new WeakMap,Be=new WeakMap;var Xe,Ye,Je=function(t){function e(e,i){var n=void 0===i?{}:i,r=n.width,s=void 0===r?1:r,a=n.height,o=void 0===a?1:a,h=n.widthSegments,l=void 0===h?1:h,u=n.heightSegments,c=void 0===u?1:u,d=n.attributes,f=void 0===d?{}:d,m=Math.floor(l),g=Math.floor(c),p=(m+1)*(g+1),v=m*g*6,y=new Float32Array(3*p),w=new Float32Array(3*p),b=new Float32Array(2*p),E=p>65536?new Uint32Array(v):new Uint16Array(v);return qe(y,w,b,E,s,o,0,l,c),t.call(this,e,Object.assign({},f,{position:{size:3,data:y},normal:{size:3,data:w},uv:{size:2,data:b},index:{data:E}}))||this}return(0,s.Z)(e,t),e}(Zt),Ke=function(t){function e(e,i){var n=void 0===i?{}:i,r=n.width,s=void 0===r?1:r,a=n.height,o=void 0===a?1:a,h=n.depth,l=void 0===h?1:h,u=n.widthSegments,c=void 0===u?1:u,d=n.heightSegments,f=void 0===d?1:d,m=n.depthSegments,g=void 0===m?1:m,p=n.attributes,v=void 0===p?{}:p,y=Math.floor(c),w=Math.floor(f),b=Math.floor(g),E=y+1,A=w+1,x=b+1,T=E*A*2+E*x*2+A*x*2,M=6*(y*w*2+y*b*2+w*b*2),S=new Float32Array(3*T),k=new Float32Array(3*T),R=new Float32Array(2*T),_=T>65536?new Uint32Array(M):new Uint16Array(M),F=0,C=0,U=x*A,O=E*x,N=E*A,L=b*w,I=y*b,D=y*w;return qe(S,k,R,_,l,o,s,g,f,2,1,0,-1,-1,F,C),qe(S,k,R,_,l,o,-s,g,f,2,1,0,1,-1,F+=U,C+=L),qe(S,k,R,_,s,l,o,g,c,0,2,1,1,1,F+=U,C+=L),qe(S,k,R,_,s,l,-o,g,c,0,2,1,1,-1,F+=O,C+=I),qe(S,k,R,_,s,o,-l,c,f,0,1,2,-1,-1,F+=O,C+=I),qe(S,k,R,_,s,o,l,c,f,0,1,2,1,-1,F+=N,C+=D),t.call(this,e,Object.assign({},v,{position:{size:3,data:S},normal:{size:3,data:k},uv:{size:2,data:R},index:{data:_}}))||this}return(0,s.Z)(e,t),e}(Zt),Qe=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},$e=function(t,e,i){return Qe(t,e,"read from private field"),i?i.call(t):e.get(t)},ti=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},ei=function(t,e,i,n){return Qe(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},ii=function(t){var e=t.match(/#define[\s*]SHADER_NAME[\s*]([\w-]+)[\s*]/);return e?e[1]:"unnamed"},ni={};function ri(t){void 0===t&&(t="id"),ni[t]=ni[t]||1;var e=ni[t];return ni[t]+=1,"".concat(t,"-").concat(e)}var si=function(t,e){switch(e){case t.VERTEX_SHADER:return"vertex-shader";case t.FRAGMENT_SHADER:return"fragment-shader";default:return"unknown"}};var ai=function(t){function e(e,i,n,s){var a;void 0===s&&(s={});var o=function(t,e){switch(e){case"fragment":return t.FRAGMENT_SHADER;case"vertex":return t.VERTEX_SHADER;default:return}}(e.gl,n);return a=t.call(this,e,{name:ii(i)||ri(si(e,o))})||this,ti((0,r.Z)(a),Xe,void 0),ti((0,r.Z)(a),Ye,void 0),console.assert("string"==typeof i,"Shader: GLSL source code must be a JavaScript string"),ei((0,r.Z)(a),Ye,s),ei((0,r.Z)(a),Xe,o),a.sourceCode=a.injectShaderModule(i,s||{}).replace(/\n\n+/gm,"\n\n"),a.createShader(a.sourceCode),a}(0,s.Z)(e,t);var i=e.prototype;return i.injectShaderModule=function(t,e){var i=this;void 0===e&&(e={});return t.replace(/^[\t ]*#glsl_include +<([\w.]+)>/gm,(function(t,n){var r=e[n];if(void 0===r)throw new Error("Cannot resolve #include <".concat(n,">"));return r=r.replace(/#include </g,"#glsl_include <"),i.injectShaderModule(r,e)}))},i.createShader=function(t){void 0===t&&(t=this.source);var e=t.replace(/#include </g,"#glsl_include <");if(e=this.injectShaderModule(e,$e(this,Ye)||{}).replace(/\n\n+/gm,"\n\n"),this.gl.shaderSource(this.handle,e),this.gl.compileShader(this.handle),!this.gl.getShaderParameter(this.handle,this.gl.COMPILE_STATUS)){var i=this.gl.getShaderInfoLog(this.handle)||"";throw this.gl.deleteShader(this.handle),new Error(this.toString()+"\n"+i+"\n"+function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}(e))}},i.getSource=function(){return this.gl.getShaderSource(this.handle)},i.setSource=function(t){var e=ii(t);e&&(this.name=ri(e)),this.createShader(t)},i.deleteHandle=function(){this.gl.deleteShader(this.handle)},i.toString=function(){return si(this.gl,this.shaderType)+":"+this.id},(0,a.Z)(e,[{key:"source",get:function(){return this.sourceCode}},{key:"shaderType",get:function(){return $e(this,Xe)}}]),e}(Re);Xe=new WeakMap,Ye=new WeakMap;var oi,hi,li,ui,ci,di,fi,mi,gi,pi=function(t){function e(e,i,n){return t.call(this,e,i,"vertex",n)||this}return(0,s.Z)(e,t),e.prototype.createHandle=function(){return this.gl.createShader(this.gl.VERTEX_SHADER)},e}(ai),vi=function(t){function e(e,i,n){return t.call(this,e,i,"fragment",n)||this}return(0,s.Z)(e,t),e.prototype.createHandle=function(){return this.gl.createShader(this.gl.FRAGMENT_SHADER)},e}(ai),yi=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},wi=function(t,e,i){return yi(t,e,"read from private field"),i?i.call(t):e.get(t)},bi=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Ei=function(t,e,i,n){return yi(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Ai=function(t,e,i){return yi(t,e,"access private method"),i},xi={};function Ti(t,e,i,n){var r=(n=n.length?function(t){var e=t.length,i=t[0].length;if(void 0===i)return t;var n=e*i,r=xi[n];r||(xi[n]=r=new Float32Array(n));for(var s=0;s<e;s++)r.set(t[s],s*i);return r}(n):n).length;switch(e){case WebGLRenderingContext.FLOAT:return r?t.uniform1fv(i,n):t.uniform1f(i,n);case WebGLRenderingContext.FLOAT_VEC2:return t.uniform2fv(i,n);case WebGLRenderingContext.FLOAT_VEC3:return t.uniform3fv(i,n);case WebGLRenderingContext.FLOAT_VEC4:return t.uniform4fv(i,n);case WebGLRenderingContext.BOOL:case WebGLRenderingContext.INT:case WebGLRenderingContext.SAMPLER_2D:case WebGLRenderingContext.SAMPLER_CUBE:return r?t.uniform1iv(i,n):t.uniform1i(i,n);case WebGLRenderingContext.BOOL_VEC2:case WebGLRenderingContext.INT_VEC2:return t.uniform2iv(i,n);case WebGLRenderingContext.BOOL_VEC3:case WebGLRenderingContext.INT_VEC3:return t.uniform3iv(i,n);case WebGLRenderingContext.BOOL_VEC4:case WebGLRenderingContext.INT_VEC4:return t.uniform4iv(i,n);case WebGLRenderingContext.FLOAT_MAT2:return t.uniformMatrix2fv(i,!1,n);case WebGLRenderingContext.FLOAT_MAT3:return t.uniformMatrix3fv(i,!1,n);case WebGLRenderingContext.FLOAT_MAT4:return t.uniformMatrix4fv(i,!1,n)}}var Mi=function(t){function e(e,i){var n;void 0===i&&(i={}),n=t.call(this,e,i)||this,bi((0,r.Z)(n),di),bi((0,r.Z)(n),mi),bi((0,r.Z)(n),oi,void 0),bi((0,r.Z)(n),hi,void 0),bi((0,r.Z)(n),li,void 0),bi((0,r.Z)(n),ui,void 0),bi((0,r.Z)(n),ci,void 0);var s=i,a=s.id,o=s.vertexShader,h=s.fragmentShader,l=s.uniforms,u=void 0===l?{}:l,c=s.transparent,d=void 0!==c&&c,f=s.defines,g=void 0===f?[]:f,p=s.includes,v=void 0===p?{}:p,y=s.cullFace,w=s.frontFace,b=void 0===w?e.gl.CCW:w,E=s.depthTest,A=void 0===E||E,x=s.depthWrite,T=void 0===x||x,M=s.depthFunc,S=void 0===M?e.gl.LESS:M,k=s.blendFunc,R=s.blendEquation;n.id=a||I("program");var _=[].concat((Object.assign({},i,u),[].map((function(t){return"#define ".concat(t)}))),g).map((function(t){return t.startsWith("#define ")?t:"#define ".concat(t)}));if(!o||!h)throw new Error("Program: "+n.id+"\uff1amust provide vertexShader and fragmentShader");if(Ei((0,r.Z)(n),li,"string"==typeof o?new pi(e,m(o,_),v):o),Ei((0,r.Z)(n),ui,"string"==typeof h?new vi(e,m(h,_),v):h),n.gl.attachShader(n.handle,wi((0,r.Z)(n),li).handle),n.gl.attachShader(n.handle,wi((0,r.Z)(n),ui).handle),n.gl.linkProgram(n.handle),n.gl.validateProgram(n.handle),!n.gl.getProgramParameter(n.handle,n.gl.LINK_STATUS))throw new Error("Program:".concat(n.id,": Error linking ").concat(n.gl.getProgramInfoLog(n.handle)));return n.uniforms=u,Ei((0,r.Z)(n),ci,{cullFace:y,frontFace:b,depthTest:A,depthWrite:T,depthFunc:S,blendFunc:k,blendEquation:R}),Ei((0,r.Z)(n),oi,new Map),Ei((0,r.Z)(n),hi,new Map),Ai((0,r.Z)(n),di,fi).call((0,r.Z)(n),u),Ai((0,r.Z)(n),mi,gi).call((0,r.Z)(n)),d&&!(null==k?void 0:k.src)&&(n.renderer.premultipliedAlpha?wi((0,r.Z)(n),ci).blendFunc=Object.assign({},k,{src:n.gl.ONE,dst:n.gl.ONE_MINUS_SRC_ALPHA}):wi((0,r.Z)(n),ci).blendFunc=Object.assign({},k,{src:n.gl.SRC_ALPHA,dst:n.gl.ONE_MINUS_SRC_ALPHA})),n}(0,s.Z)(e,t);var i=e.prototype;return i.use=function(){var t=this,e=this.rendererState.currentProgramId===this.id,i=-1;e||(this.gl.useProgram(this.handle),this.rendererState.currentProgramId=this.id),wi(this,oi).forEach((function(e,n){var r=n.name,s=t.uniforms[r];if(s)if(s&&(_(s.value)||O(s.value)))console.warn("Program:".concat(t.id,": Uniform ").concat(r," is missing a value parameter"));else{var a=null==s?void 0:s.value;if(a instanceof Le)return i+=1,s.value.update(i),Ti(t.gl,n.type,e.location,i);if((a instanceof pt||a instanceof ot||a instanceof Ft)&&(a=s.value.toArray()),a&&a.length>0&&a[0]instanceof Le){for(var o=[],h=0;h<s.value.length;h++){var l=a[h];i+=1,l.update(i),o.push(i)}return Ti(t.gl,n.type,e.location,o)}Ti(t.gl,n.type,e.location,a)}else console.warn("Program:".concat(t.id,": Active uniform ").concat(r," has not been supplied"))})),this.applyState()},i.setStates=function(t,e){void 0===e&&(e=!0),Ei(this,ci,e?Object.assign({},wi(this,ci),t,{blendFunc:Object.assign({},wi(this,ci).blendFunc,t.blendFunc),blendEquation:Object.assign({},wi(this,ci).blendEquation,t.blendEquation)}):t)},i.applyState=function(){this.rendererState.apply(wi(this,ci))},i.setUniform=function(t,e){this.uniforms[t]&&(this.uniforms[t].value=e)},i.bind=function(){this.gl.useProgram(this.handle)},i.unbind=function(){this.gl.useProgram(null)},i.createHandle=function(){return this.gl.createProgram()},i.deleteHandle=function(){this.gl.deleteProgram(this.handle)},i.destroy=function(){this.unbind(),this.deleteHandle()},(0,a.Z)(e,[{key:"uniformLocations",get:function(){return wi(this,oi)}},{key:"attributeLocations",get:function(){return wi(this,hi)}},{key:"vertexShader",get:function(){return wi(this,li)}},{key:"fragmentShader",get:function(){return wi(this,ui)}}]),e}(Re);oi=new WeakMap,hi=new WeakMap,li=new WeakMap,ui=new WeakMap,ci=new WeakMap,di=new WeakSet,fi=function(t){var e;void 0===t&&(t={});for(var i=this.gl.getProgramParameter(this.handle,this.gl.ACTIVE_UNIFORMS),n=0;n<i;n++){var r=this.gl.getActiveUniform(this.handle,n);if(!r)break;var s=r.name,a=s.match(/(\w+)/g),o={location:this.gl.getUniformLocation(this.handle,s),type:r.type,name:a[0],isStruct:!1};3===a.length?(o.isStructArray=!0,o.structIndex=Number(a[1]),o.structProperty=a[2]):2===a.length&&isNaN(Number(a[1]))&&(o.isStruct=!0,o.structProperty=a[1]);var h=null==(e=t[s])?void 0:e.value;_(h)||O(h)||(o.value=t[s].value),this.uniforms[s]=o,wi(this,oi).set(r,o)}},mi=new WeakSet,gi=function(){for(var t=this.gl.getProgramParameter(this.handle,this.gl.ACTIVE_ATTRIBUTES),e=[],i=0;i<t;i++){var n=this.gl.getActiveAttrib(this.handle,i);if(!n)break;var r=this.gl.getAttribLocation(this.handle,n.name);e[r]=n.name,wi(this,hi).set(n,r)}this.attributeOrder=e.join("")};var Si,ki=function(t,e,i){return function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)}(t,e,"read from private field"),i?i.call(t):e.get(t)},Ri=function(t){function e(e,i){var n;void 0===i&&(i={});var s=e.gl,a={type:s.UNSIGNED_BYTE,format:s.RGBA,internalFormat:i.format||s.RGBA,wrapS:s.CLAMP_TO_EDGE,wrapT:s.CLAMP_TO_EDGE,wrapR:s.CLAMP_TO_EDGE,generateMipmaps:!0,minFilter:s.LINEAR,magFilter:s.LINEAR,premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,level:0,depth:0},o=Object.assign({},a,i);return(n=t.call(this,e,o,!1)||this).needsUpdate=!1,n.textureUnit=0,function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)}((0,r.Z)(n),Si,{}),n.needsUpdate=!0,n.depth=n.options.depth,ki((0,r.Z)(n),Si).version=-1,n.update(),n}(0,s.Z)(e,t);var i=e.prototype;return i.setData=function(t,e,i,n){void 0===e&&(e=this.width),void 0===i&&(i=this.height),void 0===n&&(n=this.depth),this.image=t,this.width=e,this.height=i,this.depth=n,this.needsUpdate=!0},i.setOptions=function(t){this.options=Object.assign(this.options,t),this.width=this.options.width,this.height=this.options.height,this.depth=this.options.depth,this.needsUpdate=!0},i.update=function(t){void 0===t&&(t=0);var e=!(this.image===ki(this,Si).image&&!this.needsUpdate);(e||this.rendererState.textureUnits[t]!==this.id||this.rendererState.activeTextureUnit!==t)&&(this.rendererState.setActiveTexture(t),this.bind(t)),e&&(this.needsUpdate=!1,this.options.wrapS!==ki(this,Si).wrapS&&(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.options.wrapS),ki(this,Si).wrapS=this.options.wrapS),this.options.wrapT!==ki(this,Si).wrapT&&(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.options.wrapT),ki(this,Si).wrapT=this.options.wrapT),this.options.wrapR!==ki(this,Si).wrapR&&(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.options.wrapR),ki(this,Si).wrapR=this.options.wrapR),this.options.minFilter!==ki(this,Si).minFilter&&(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.options.minFilter),ki(this,Si).minFilter=this.options.minFilter),this.options.magFilter!==ki(this,Si).magFilter&&(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.options.magFilter),ki(this,Si).magFilter=this.options.magFilter),this.options.flipY!==this.rendererState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.options.flipY),this.rendererState.flipY=this.options.flipY),this.options.premultiplyAlpha!==this.rendererState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),this.rendererState.premultiplyAlpha=this.options.premultiplyAlpha),this.options.unpackAlignment!==this.rendererState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.options.unpackAlignment),this.rendererState.unpackAlignment=this.options.unpackAlignment),this.image?(this.image.width&&(this.width=this.image.width,this.height=this.image.height),ArrayBuffer.isView(this.image),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.options.internalFormat,this.width,this.height,this.depth,0,this.options.format,this.options.type,this.image),this.options.generateMipmaps&&(this.renderer.isWebGL2||A(this.image.width)&&A(this.image.height)?this.gl.generateMipmap(this.gl.TEXTURE_3D):(this.options.generateMipmaps=!1,this.options.wrapS=this.gl.CLAMP_TO_EDGE,this.options.wrapT=this.options.wrapS,this.options.minFilter=this.gl.LINEAR))):this.width>0?this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.options.internalFormat,this.width,this.height,this.depth,0,this.options.format,this.options.type,null):this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,1,1,this.depth,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(4)),ki(this,Si).image=this.image,ki(this,Si).version+=1)},i.bind=function(t){void 0===t&&(t=this.textureUnit),this.rendererState.textureUnits[this.rendererState.activeTextureUnit]!==this.id&&(this.textureUnit=t,this.rendererState.textureUnits[this.textureUnit]=this.id,this.gl.bindTexture(this.gl.TEXTURE_3D,this.handle))},i.unbind=function(){this.gl.activeTexture(this.gl.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.gl.TEXTURE_3D,null),delete this.rendererState.textureUnits[this.textureUnit]},i.destroy=function(){this.unbind(),t.prototype.destroy.call(this)},i.toString=function(){return"Texture3D("+this.id+","+this.width+"x"+this.height+")"},(0,a.Z)(e,[{key:"gl",get:function(){return this.renderer.gl}}]),e}(Le);Si=new WeakMap;var _i,Fi,Ci,Ui,Oi,Ni,Li=function(t,e,i){if(!e.has(t))throw TypeError("Cannot "+i)},Ii=function(t,e,i){return Li(t,e,"read from private field"),i?i.call(t):e.get(t)},Di=function(t,e,i){if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Wi=function(t,e,i,n){return Li(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i},Pi=new wt,Bi=new mt,Zi=new mt,Gi=function(t){function e(e){var i,n=void 0===e?{}:e,s=n.near,a=void 0===s?.1:s,o=n.far,h=void 0===o?100:o,l=n.fov,u=void 0===l?45:l,c=n.aspect,d=void 0===c?1:c,f=n.bounds,m=n.zoom,g=void 0===m?1:m;i=t.call(this)||this,Di((0,r.Z)(i),_i,void 0),Di((0,r.Z)(i),Fi,void 0),Di((0,r.Z)(i),Ci,void 0),Di((0,r.Z)(i),Ui,void 0),Di((0,r.Z)(i),Oi,void 0),Di((0,r.Z)(i),Ni,void 0),i.cameraType="perspective",i.projectionMatrix=new Ct,i.viewMatrix=new wt,i.projectionViewMatrix=new Ct,i.worldPosition=new mt,i.frustum=new wt,Wi((0,r.Z)(i),_i,a),Wi((0,r.Z)(i),Fi,h),Wi((0,r.Z)(i),Ci,u),Wi((0,r.Z)(i),Ui,d),Wi((0,r.Z)(i),Ni,f),Wi((0,r.Z)(i),Oi,g);var p=f||{},v=p.left,y=p.right,w=p.top,b=p.bottom;return i.cameraType=v||y?"orthographic":"perspective","orthographic"===i.cameraType?i.orthographic(v,y,w,b,a,h,g):i.perspective(u,d,a,h),i}(0,s.Z)(e,t);var i=e.prototype;return i.perspective=function(t,e,i,n){void 0===t&&(t=this.fov),void 0===e&&(e=this.aspect),void 0===i&&(i=this.near),void 0===n&&(n=this.far),Wi(this,Ci,t),Wi(this,Ui,e),Wi(this,_i,i),Wi(this,Fi,n),this.projectionMatrix.fromPerspective(t,e,i,n),this.cameraType="perspective"},i.orthographic=function(t,e,i,n,r,s,a){void 0===r&&(r=this.near),void 0===s&&(s=this.far),void 0===a&&(a=1),Wi(this,Ni,{left:t,right:e,top:i,bottom:n}),this.near=r,this.far=s,this.projectionMatrix.orthographic(t/a,e/a,i/a,n/a,r,s),this.cameraType="orthographic",this.projectionMatrix.frustum(this.frustum,Ii(this,Ni).left,Ii(this,Ni).right,Ii(this,Ni).top,Ii(this,Ni).bottom,Ii(this,_i),Ii(this,Fi))},i.lookAt=function(e){return t.prototype.lookAt.call(this,e,!0),this},i.updateMatrixWorld=function(){return t.prototype.updateMatrixWorld.call(this),this.viewMatrix.invert(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this},i.frustumIntersectsMesh=function(t,e){if(void 0===e&&(e=t.worldMatrix),!t.geometry.attributes.position)return!0;if(t.geometry.bounds&&t.geometry.bounds.radius!==1/0||t.geometry.computeBoundingSphere(),!t.geometry.bounds)return!0;var i=Bi;i.copy(t.geometry.bounds.center),i.applyMatrix4(e);var n=t.geometry.bounds.radius*e.getMaxScaleOnAxis();return this.frustumIntersectsSphere(i,n)},i.frustumIntersectsSphere=function(t,e){for(var i=Zi,n=0;n<6;n++){var r=this.frustum[n];if(i.copy(r).dot(t)+r.constant<-e)return!1}return!0},i.project=function(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this},i.unproject=function(t){return t.applyMatrix4(Pi.invert(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this},i.updateProjectionMatrix=function(){throw new Error("Camera subclass must define virtual methods")},(0,a.Z)(e,[{key:"near",get:function(){return Ii(this,_i)},set:function(t){Wi(this,_i,t),this.updateProjectionMatrix()}},{key:"far",get:function(){return Ii(this,Fi)},set:function(t){Wi(this,Fi,t),this.updateProjectionMatrix()}},{key:"fov",get:function(){return Ii(this,Ci)},set:function(t){Wi(this,Ci,t),this.updateProjectionMatrix()}},{key:"aspect",get:function(){return Ii(this,Ui)},set:function(t){Wi(this,Ui,t),this.updateProjectionMatrix()}},{key:"zoom",get:function(){return Ii(this,Oi)},set:function(t){Wi(this,Oi,t),this.updateProjectionMatrix()}},{key:"bounds",get:function(){return Ii(this,Ni)},set:function(t){Wi(this,Ni,t),this.updateProjectionMatrix()}}]),e}(Ut);_i=new WeakMap,Fi=new WeakMap,Ci=new WeakMap,Ui=new WeakMap,Oi=new WeakMap,Ni=new WeakMap;var zi=function(t){function e(e,i,n,r){return t.call(this,{fov:e,aspect:i,near:n,far:r})||this}return(0,s.Z)(e,t),e.prototype.updateProjectionMatrix=function(){this.projectionMatrix.fromPerspective(this.fov,this.aspect,this.near,this.far)},e}(Gi),ji=function(t){function e(e,i,n,r,s,a,o){return void 0===o&&(o=1),t.call(this,{bounds:{left:e,right:i,top:n,bottom:r},near:s,far:a,zoom:o})||this}return(0,s.Z)(e,t),e.prototype.updateProjectionMatrix=function(){var t=this.bounds,e=t.left,i=t.right,n=t.top,r=t.bottom,s=this.zoom;this.projectionMatrix.orthographic(e/s,i/s,n/s,r/s,this.near,this.far)},e}(Gi)}}]);