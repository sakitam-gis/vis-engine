"use strict";(self.webpackChunkvis_engine_docs=self.webpackChunkvis_engine_docs||[]).push([[3235,7918],{1101:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>y,contentTitle:()=>g,default:()=>Z,frontMatter:()=>v,metadata:()=>b,toc:()=>x});var i=n(5250),r=n(3274),s=n(3494),a=n(3580),o=n(4667),l=n(79),h=n(2799),u=n(6703),c=n(9206),d=n(6792),f=n(889);function m(e){var t=(0,l.useRef)(null),n=(0,l.useRef)(null),r=(0,l.useRef)(null),s=(0,l.useRef)(null),a=(0,h.useCreateStore)(),o={fov:{value:15,min:-50,max:50,step:1,onChange:function(e){r.current&&(r.current.fov=e)}},nearZ:{value:.1,min:-50,max:50,step:.1,onChange:function(e){r.current&&(r.current.near=e)}},farZ:{value:100,min:-500,max:500,step:1,onChange:function(e){r.current&&(r.current.far=e)}},cameraPosition:{value:[0,0,15],onChange:function(e){var t;r.current&&(t=r.current.position).set.apply(t,e)}},wireframe:{value:!1,onChange:function(e){n.current&&(n.current.wireframe=e)}}};(0,h.useControls)(o,{store:a});return(0,l.useEffect)((function(){var e=function(){var e=t.current;e.width=e.clientWidth,e.height=e.clientHeight;var i=new f.Renderer(e,{alpha:!0});s.current=i;var a=new f.PerspectiveCamera(15,e.width/e.height,.1,100);a.position.z=15,r.current=a;var o=new f.Scene,l=new f.Geometry(i,{position:{size:3,data:new Float32Array([-1.6,1.5,0,-1,-1,0,1,-1,0,-1,-1,0,1,-1,0,1.6,1.5,0])}}),h=new f.Program(i,{vertexShader:u.Z,fragmentShader:c.Z,uniforms:{uTime:{value:0}}}),d=new f.Mesh(i,{mode:i.gl.TRIANGLES,geometry:l,program:h});return d.setParent(o),d.position.set(0,0,0),n.current=d,new f.Raf((function(e){h.setUniform("uTime",e),i.render({scene:o,camera:a})})),{canvas:e,resize:function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;i.setSize(n,r),a.aspect=n/r}}}(),i=e.canvas,a=e.resize;return(0,d.N7)(i,a),function(){(0,d.p_)(i,a)}}),[]),(0,i.jsxs)("div",{className:"live-wrap",children:[(0,i.jsxs)("div",{className:"leva-wrap",children:[(0,i.jsx)(h.Leva,{fill:!0}),(0,i.jsx)(h.LevaPanel,{store:a,fill:!0})]}),(0,i.jsx)("canvas",{className:"scene-canvas",ref:t})]})}const p="import React, { useRef, useEffect } from 'react';\nimport { useControls, Leva, useCreateStore, LevaPanel } from 'leva';\nimport vertex from 'raw-loader!glslify-loader!./shaders/draw-modes.vert.glsl';\nimport fragment from 'raw-loader!glslify-loader!./shaders/draw-modes.frag.glsl';\n\nimport { observe, unobserve } from '../utils/observer';\n\nimport { Renderer, Mesh, Raf, Scene, Program, PerspectiveCamera, Geometry } from '@sakitam-gis/vis-engine';\n\nexport default function DrawModel(props) {\n  const refDom = useRef(null);\n  const meshRef = useRef(null);\n  const cameraRef = useRef(null);\n  const renderRef = useRef(null);\n\n  const store = useCreateStore();\n\n  const fov = 15;\n  const nearZ = 0.1;\n\n  const farZ = 100;\n\n  const config: any = {\n    fov: {\n      value: fov,\n      min: -50,\n      max: 50,\n      step: 1,\n      onChange: (fov) => {\n        if (cameraRef.current) {\n          cameraRef.current.fov = fov;\n        }\n      },\n    },\n    nearZ: {\n      value: nearZ,\n      min: -50,\n      max: 50,\n      step: 0.1,\n      onChange: (nearZ) => {\n        if (cameraRef.current) {\n          cameraRef.current.near = nearZ;\n        }\n      },\n    },\n    farZ: {\n      value: farZ,\n      min: -500,\n      max: 500,\n      step: 1,\n      onChange: (farZ) => {\n        if (cameraRef.current) {\n          cameraRef.current.far = farZ;\n        }\n      },\n    },\n    cameraPosition: {\n      value: [0, 0, 15],\n      onChange: (p) => {\n        if (cameraRef.current) {\n          cameraRef.current.position.set(...p);\n        }\n      },\n    },\n    wireframe: {\n      value: false,\n      onChange: (p) => {\n        if (meshRef.current) {\n          meshRef.current.wireframe = p;\n        }\n      },\n    }\n  };\n\n  useControls(config, {\n    store: store,\n  });\n\n  const init = () => {\n    const canvas = refDom.current;\n\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n    const renderer = new Renderer(canvas, {\n      alpha: true,\n    });\n\n    renderRef.current = renderer;\n\n    const camera = new PerspectiveCamera(fov, canvas.width / canvas.height, nearZ, farZ);\n    camera.position.z = fov;\n\n    cameraRef.current = camera;\n\n    function resize(target) {\n      const { width, height } = target.getBoundingClientRect();\n      renderer.setSize(width, height);\n      camera.aspect = width / height;\n    }\n\n    const scene = new Scene();\n\n    const geometry = new Geometry(renderer, {\n      position: {\n        size: 3,\n        data: new Float32Array([\n          -1.6, 1.5, 0,\n          -1, -1, 0,\n          1, -1, 0,\n          -1, -1, 0,\n          1, -1, 0,\n          1.6, 1.5, 0,\n        ])\n      },\n    });\n\n    const program = new Program(renderer, {\n      vertexShader: vertex,\n      fragmentShader: fragment,\n      uniforms: {\n        uTime: { value: 0 },\n      },\n    });\n\n    const triangles = new Mesh(renderer, { mode: renderer.gl.TRIANGLES, geometry, program });\n    triangles.setParent(scene);\n    triangles.position.set(0, 0, 0);\n\n    meshRef.current = triangles;\n\n    const raf = new Raf((t) => {\n      program.setUniform('uTime', t);\n      renderer.render({ scene, camera });\n    });\n\n    return {\n      canvas,\n      resize,\n    }\n  }\n\n  useEffect(() => {\n    const { canvas, resize } = init();\n\n    observe(canvas, resize);\n\n    return () => {\n      unobserve(canvas, resize);\n    };\n  }, []);\n\n  return (\n    <div className=\"live-wrap\">\n      <div className=\"leva-wrap\">\n        <Leva\n          fill\n        ></Leva>\n        <LevaPanel store={store} fill></LevaPanel>\n      </div>\n      <canvas className=\"scene-canvas\" ref={refDom}></canvas>\n    </div>\n  );\n}\n",v={id:"try",title:"Try vis-engine"},g=void 0,b={id:"intro/try",title:"Try vis-engine",description:"Using an ES6 Module Bundler",source:"@site/docs/intro/try.mdx",sourceDirName:"intro",slug:"/intro/try",permalink:"/vis-engine/docs/intro/try",draft:!1,unlisted:!1,editUrl:"https://github.com/sakitam-gis/vis-engine/edit/master/documents/docs/docs/intro/try.mdx",tags:[],version:"current",lastUpdatedBy:"sakitam-fdd",lastUpdatedAt:1711203377,formattedLastUpdatedAt:"Mar 23, 2024",frontMatter:{id:"try",title:"Try vis-engine"},sidebar:"docs",previous:{title:"Introduction (\u7b80\u4ecb)",permalink:"/vis-engine/docs/"},next:{title:"Draw Model",permalink:"/vis-engine/docs/playground"}},y={},x=[{value:"Using an ES6 Module Bundler",id:"using-an-es6-module-bundler",level:3},{value:"\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b",id:"\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b",level:3}];function w(e){const t={code:"code",h3:"h3",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h3,{id:"using-an-es6-module-bundler",children:"Using an ES6 Module Bundler"}),"\n",(0,i.jsx)(t.p,{children:"Install the package."}),"\n",(0,i.jsxs)(s.Z,{defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"pnpm",value:"pnpm"}],children:[(0,i.jsx)(a.Z,{value:"yarn",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-zsh",children:"yarn add @sakitam-gis/vis-engine\n"})})}),(0,i.jsx)(a.Z,{value:"pnpm",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-zsh",children:"pnpm i @sakitam-gis/vis-engine\n"})})})]}),"\n",(0,i.jsx)(t.h3,{id:"\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b",children:"\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-jsx",metastring:"live",live:!0,children:'function render(props) {\n  const drawModelVertex = `\n    attribute vec2 uv;\n    attribute vec3 position;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    varying vec2 vUv;\n\n    void main() {\n        vUv = uv;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n        // gl_PointSize only applicable for gl.POINTS draw mode\n        gl_PointSize = 5.0;\n    }\n    `;\n\n  const drawModelFragment = `\n    precision highp float;\n\n    uniform float uTime;\n    varying vec2 vUv;\n\n    void main() {\n        gl_FragColor.rgb = 0.5 + 0.3 * sin(vUv.yxx + uTime) + vec3(0.2, 0.0, 0.1);\n        gl_FragColor.a = 1.0;\n    }\n    `;\n\n  const refDom = useRef(null);\n  const meshRef = useRef(null);\n  const cameraRef = useRef(null);\n  const renderRef = useRef(null);\n\n  const store = leva.useCreateStore();\n\n  const fov = 15;\n  const nearZ = 0.1;\n\n  const farZ = 100;\n\n  const config = {\n    fov: {\n      value: fov,\n      min: -50,\n      max: 50,\n      step: 1,\n      onChange: (fov) => {\n        if (cameraRef.current) {\n          cameraRef.current.fov = fov;\n        }\n      },\n    },\n    nearZ: {\n      value: nearZ,\n      min: -50,\n      max: 50,\n      step: 0.1,\n      onChange: (nearZ) => {\n        if (cameraRef.current) {\n          cameraRef.current.nearZ = nearZ;\n        }\n      },\n    },\n    farZ: {\n      value: farZ,\n      min: -500,\n      max: 500,\n      step: 1,\n      onChange: (farZ) => {\n        if (cameraRef.current) {\n          cameraRef.current.farZ = farZ;\n        }\n      },\n    },\n    cameraPosition: {\n      value: [0, 0, 15],\n      onChange: (p) => {\n        if (cameraRef.current) {\n          cameraRef.current.position.set(...p);\n        }\n      },\n    },\n    wireframe: {\n      value: false,\n      onChange: (p) => {\n        if (meshRef.current) {\n          meshRef.current.wireframe = p;\n        }\n      },\n    }\n  };\n\n  leva.useControls(config, {\n    store: store,\n  });\n\n  const init = () => {\n    const canvas = refDom.current;\n\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n    const renderer = new Renderer(canvas, {\n      alpha: true,\n    });\n\n    renderRef.current = renderer;\n\n    const camera = new PerspectiveCamera(fov, canvas.width / canvas.height, nearZ, farZ);\n    camera.position.z = fov;\n\n    cameraRef.current = camera;\n\n    function resize(target) {\n      const { width, height } = target.getBoundingClientRect();\n      renderer.setSize(width, height);\n      camera.aspect = width / height;\n    }\n\n    const scene = new Scene();\n\n    const geometry = new Geometry(renderer, {\n      position: {\n        size: 3,\n        data: new Float32Array([\n          -1.6, 1.5, 0,\n          -1, -1, 0,\n          1, -1, 0,\n          -1, -1, 0,\n          1, -1, 0,\n          1.6, 1.5, 0,\n        ])\n      },\n    });\n\n    const program = new Program(renderer, {\n      vertexShader: drawModelVertex,\n      fragmentShader: drawModelFragment,\n      uniforms: {\n        uTime: { value: 0 },\n      },\n    });\n\n    const triangles = new Mesh(renderer, { mode: renderer.gl.TRIANGLES, geometry, program });\n    triangles.setParent(scene);\n    triangles.position.set(0, 0, 0);\n\n    meshRef.current = triangles;\n\n    const raf = new Raf((t) => {\n      program.setUniform(\'uTime\', t);\n      renderer.render({ scene, camera });\n    });\n\n    return {\n      canvas,\n      resize,\n    }\n  }\n\n  useEffect(() => {\n    const { canvas, resize } = init();\n\n    observe(canvas, resize);\n\n    return () => {\n      unobserve(canvas, resize);\n    };\n  }, []);\n\n  return (\n    <div className="live-wrap">\n      <div className="leva-wrap">\n        <Leva\n          fill\n        ></Leva>\n        <LevaPanel store={store} fill></LevaPanel>\n      </div>\n      <canvas className="scene-canvas" ref={refDom}></canvas>\n    </div>\n  );\n}\n'})}),"\n","\n","\n",(0,i.jsx)(s.Z,{children:(0,i.jsxs)(a.Z,{value:"tsx",label:"React Components",children:[(0,i.jsx)(m,{}),(0,i.jsx)(o.Z,{language:"tsx",children:p})]})})]})}function Z(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(w,{...e})}):w(e)}},889:(e,t,n)=>{n.r(t),n.d(t,{BlendType:()=>We,Box:()=>_t,BufferAttribute:()=>Ce,Camera:()=>ln,Clock:()=>te,Color:()=>Te,DataTexture:()=>xt,Euler:()=>Ae,EventEmitter:()=>ue,Geometry:()=>Ie,Matrix3:()=>ye,Matrix4:()=>we,Mesh:()=>ze,Object3D:()=>Re,OrthographicCamera:()=>un,PerspectiveCamera:()=>hn,Plane:()=>Rt,Program:()=>qt,ProjectionMatrix:()=>Se,Quaternion:()=>pe,Raf:()=>le,RenderBuffer:()=>vt,RenderTarget:()=>Tt,Renderer:()=>ut,Resource:()=>mt,Scene:()=>Ve,State:()=>qe,Texture:()=>yt,Texture3D:()=>Jt,Vector2:()=>de,Vector3:()=>ve,Vector4:()=>ge,getPlaneBuffer:()=>St,highPrecision:()=>R,utils:()=>J});var i=n(9824),r=n(4244),s=n(5327),a=n(6958),o=n(5015),l=n(1031),h=n(7897),u=n(663),c=n(1606),d=n(4717),f=n(9196),m=n(5316),p=n(6518),v=n(1354);function g(e,t,n){return void 0===t&&(t=[]),void 0===n&&(n=[]),e.replace(/#defines/,t.join("\n")).replace(/#includes/,n.join("\n"))}function b(e,t){void 0===t&&(t="unnamed");var n=e.match(/#define\s*SHADER_NAME\s*([A-Za-z0-9_-]+)\s*/);return n?n[1]:t}function y(e,t,n,i){var r=new Set;if(i)for(var s=0,a=n;s<a;s+=3)for(var o=i[s],l=i[s+1],h=i[s+2],u=[o,l,l,h,h,o],c=0;c<u.length;c+=2)x(3*u[c],3*u[c+1],e,r)&&t.push(u[c],u[c+1]);else for(var d=0,f=n;d<f;d+=3)for(var m=d+1,p=d+2,v=[d,m,m,p,p,d],g=0;g<v.length;g+=2)x(3*v[g],3*v[g+1],e,r)&&t.push(v[g],v[g+1]);return t}function x(e,t,n,i){var r=n[e]+","+n[e+1]+","+n[e+2]+"-"+n[t]+","+n[t+1]+","+n[t+2],s=n[t]+","+n[t+1]+","+n[t+2]+"-"+n[e]+","+n[e+1]+","+n[e+2];return!0!==i.has(r)&&!0!==i.has(s)&&(i.add(r),i.add(s),!0)}var w=Math.PI/180,Z=180/Math.PI;function E(e){return e*w}function A(e){return e*Z}function M(e,t,n){return Math.min(Math.max(e,t),n)}function T(e){return Math.log(e)/Math.LN2%1==0}var S=Float32Array;function R(e,t){void 0===t&&(t=!0),S=e?Float64Array:Float32Array,t&&h.ZR(S)}function _(){return S}function C(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||(!(null==e||!e.gl||!(e.gl instanceof WebGLRenderingContext||e.gl instanceof WebGL2RenderingContext))||Boolean(e&&Number.isFinite(e._version))))}function F(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||(!!(null!=e&&e.gl&&e.gl instanceof WebGL2RenderingContext)||Boolean(e&&2===e._version))}function P(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1);var i=["webgl2","webgl","experimental-webgl"];n||i.shift();var r=null;function s(e){console.error(e.statusMessage)}null==e||null==e.addEventListener||e.addEventListener("webglcontextcreationerror",s,!1);for(var a=0;a<i.length;++a){try{r=e.getContext(i[a],t)}catch(o){}if(r)break}return null==e||null==e.removeEventListener||e.removeEventListener("webglcontextcreationerror",s,!1),r}var O=function(){return("undefined"==typeof performance?Date:performance).now()};function L(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function N(e){return"string"===L(e)}function I(e){return"undefined"===L(e)}function k(e){return N(e)&&e.includes("%")}function B(e){return"number"===L(e)}function U(e){return"regexp"===L(e)}function j(e){return null==e}function D(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}var G={};function z(e){return void 0===e&&(e="id"),G[e]=G[e]||1,e+"-"+G[e]++}function V(e,t){return void 0===t&&(t=[]),Object.keys(e).filter((function(e){return t.indexOf(e)<0})).reduce((function(t,n){var i;return Object.assign(t,((i={})[n]=e[n],i))}),{})}var W=[],H=1e3/60,q=performance.now();function X(){var e=O(),t=e-q;if(t>=H){q=e-t%H;var n=W.slice();W.length=0;for(var i=0;i<n.length;i++)n[i]&&n[i](e,t)}else setImmediate(X)}function Y(e){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):(t=e,W.push(t),1===W.length&&setImmediate(X),W.length-1);var t}function K(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):void(W[e]=void 0)}var J=Object.freeze({__proto__:null,DEG_TO_RAD:w,RAD_TO_DEG:Z,cancelAnimationFrame:K,clamp:M,defineShader:function(e,t){return void 0===t&&(t={}),Object.keys(t).reduce((function(e,n){return t[n]?"#define "+n+" "+t[n]+"\n"+e:e}),e)},degToRad:E,getContext:P,getFloatArrayConstructor:_,getShaderName:b,getWireframeIndex:y,hasValue:function(e,t){return D(e)?!j(e.value)&&(j(t)||e.value===t):!j(e)&&(j(t)||e===t)},highPrecision:R,isHex:k,isNull:j,isNumber:B,isObject:D,isPowerOfTwo:T,isRegexp:U,isString:N,isUndef:I,isUniqueEdge:x,isWebGL:C,isWebGL2:F,now:O,omit:V,parseShader:g,pick:function(e,t){return void 0===t&&(t=[]),Object.keys(e).filter((function(e){return t.indexOf(e)>-1})).reduce((function(t,n){var i;return Object.assign(t,((i={})[n]=e[n],i))}),{})},radToDeg:A,requestAnimationFrame:Y,typeOf:L,uid:z}),$=(0,l.Z)("lastTime"),Q=(0,l.Z)("elapsedTime"),ee=(0,l.Z)("start"),te=function(){function e(e){void 0===e&&(e=!0),Object.defineProperty(this,$,{writable:!0,value:0}),Object.defineProperty(this,Q,{writable:!0,value:0}),Object.defineProperty(this,ee,{writable:!0,value:!1}),this.running=void 0,this.running=e}var t=e.prototype;return t.start=function(){(0,o.Z)(this,ee)[ee]||(this.reset(),(0,o.Z)(this,ee)[ee]=!0)},t.stop=function(){this.getElapsedTime(),(0,o.Z)(this,ee)[ee]=!1,this.running=!1},t.reset=function(){(0,o.Z)(this,$)[$]=O(),(0,o.Z)(this,Q)[Q]=0},t.getElapsedTime=function(){return this.getDelta(),(0,o.Z)(this,Q)[Q]},t.getDelta=function(){var e=0;if(this.running&&!(0,o.Z)(this,ee)[ee])return this.start(),0;if((0,o.Z)(this,ee)[ee]){var t=O();e=(t-(0,o.Z)(this,$)[$])/1e3,(0,o.Z)(this,$)[$]=t,(0,o.Z)(this,Q)[Q]=(0,o.Z)(this,Q)[Q]+e}return e},e}(),ne={autoStart:!0},ie=(0,l.Z)("raf"),re=(0,l.Z)("animating"),se=(0,l.Z)("isVisible"),ae=(0,l.Z)("clock"),oe=(0,l.Z)("callback"),le=function(){function e(e,t){var n=this;void 0===t&&(t={}),this.options=void 0,Object.defineProperty(this,ie,{writable:!0,value:void 0}),Object.defineProperty(this,re,{writable:!0,value:void 0}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,oe,{writable:!0,value:void 0}),this.options=Object.assign({},t,ne),(0,o.Z)(this,ae)[ae]=new te,this.reset(),this.onVisibilityChange=this.onVisibilityChange.bind(this),(0,o.Z)(this,oe)[oe]=function(){var t=(0,o.Z)(n,ae)[ae].getElapsedTime();e&&e(t)},this.options.autoStart&&this.start()}var t=e.prototype;return t.reset=function(){(0,o.Z)(this,re)[re]=!1,(0,o.Z)(this,se)[se]=!0,void 0!==(0,o.Z)(this,ie)[ie]&&K((0,o.Z)(this,ie)[ie])},t.start=function(){(0,o.Z)(this,re)[re]||((0,o.Z)(this,re)[re]=!0,(0,o.Z)(this,ae)[ae].start(),this.tick(),"undefined"!=typeof window&&window.document&&window.document.addEventListener("visibilitychange",this.onVisibilityChange,!1))},t.stop=function(){(0,o.Z)(this,ae)[ae].stop(),this.reset(),"undefined"!=typeof window&&window.document&&window.document.removeEventListener("visibilitychange",this.onVisibilityChange,!1)},t.tick=function(){var e=this;(0,o.Z)(this,re)[re]&&(0,o.Z)(this,se)[se]&&((0,o.Z)(this,ie)[ie]=Y((function(){e.tick()})),(0,o.Z)(this,oe)[oe]())},t.onVisibilityChange=function(){"undefined"!=typeof window&&window.document&&((0,o.Z)(this,se)[se]=!window.document.hidden),(0,o.Z)(this,se)[se]&&(this.reset(),this.start())},(0,a.Z)(e,[{key:"visible",get:function(){return(0,o.Z)(this,se)[se]}},{key:"animating",get:function(){return(0,o.Z)(this,re)[re]}},{key:"elapsedTime",get:function(){return(0,o.Z)(this,ae)[ae].getElapsedTime()}}]),e}(),he=function(e,t){var n=this;void 0===t&&(t={}),this.type=void 0,this.type=e,(Object.getOwnPropertyNames(t)||[]).forEach((function(e){n[e]=t[e]}))},ue=function(){function e(e){var t=(void 0===e?{}:e).validEventTypes,n=void 0===t?[/.*/]:t;this.fns=void 0,this.validateEventTypes=void 0,this.fns=new Map,this.validateEventTypes=n}var t=e.prototype;return t.validateEventType=function(e){var t=this.validateEventTypes;Array.isArray(this.validateEventTypes)||(t=[this.validateEventTypes]);var n=!0;if(t.forEach((function(t){U(t)&&!t.test(e)&&(n=!1)})),!n)throw new Error("Invalid Event Type: '"+e+"'.\nEvent type should be any of: "+t+".")},t.on=function(e,t,n){var i=this;if(this.validateEventType(e),N(e)){var r=e.split(" ");if(r.length>1)return r.forEach((function(e){i.on(e,t,n)})),this}return this.has(e)||this.fns.set(e,[]),this.fns.get(e).push(t),this},t.once=function(e,t,n){var i=this;if(this.validateEventType(e),N(e)){var r=e.split(" ");if(r.length>1)return r.forEach((function(e){i.once(e,t,n)})),this}return this.on(e,(function r(){i.off(e,r);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];t.call.apply(t,[n||i].concat(a))}),n)},t.off=function(e,t,n){var i=this;if(this.validateEventType(e),N(e)){var r=e.split(" ");if(r.length>1)return r.forEach((function(e){i.off(e,t,n)})),this}var s=this.has(e);if(s)if(t){var a=s.filter((function(e){return e!==t}));this.fns.set(e,a)}else this.fns.delete(e);return this},t.emit=function(e,t){var n=this,i=e instanceof he?e:new he(e,t);this.validateEventType(i.type);var r=this.has(i.type);if(r)return r.map((function(e){return e.call(n,i)}))},t.has=function(e){return this.fns.get(e)},t.clear=function(){return this.fns.clear(),this},e}(),ce=function(){function e(){this.elements=new(_())(2)}var t=e.prototype;return t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<this.elements.length;n++)this.elements[n]=e[t+n];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=0;n<this.elements.length;n++)e[t+n]=this.elements[n];return e},e}(),de=function(e){function t(t,n){var i;void 0===t&&(t=0),void 0===n&&(n=0),(i=e.call(this)||this).elements=new(_())(2);var r=i.elements;return r[0]=t,r[1]=n,i}(0,s.Z)(t,e);var n=t.prototype;return n.fromObject=function(e){var t=e.x,n=e.y;return void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),this},n.toObject=function(){return{x:this.x,y:this.y}},n.set=function(e,t){return this.x=e,this.y=t,this},n.setScalar=function(e){return this.set(e,e)},n.add=function(e){return(0,u.IH)(this.elements,this.elements,e.elements),this},n.addScalar=function(e){return(0,u.IH)(this.elements,this.elements,[e,e]),this},n.subtract=function(e){return(0,u.$X)(this.elements,this.elements,e.elements),this},n.subtractScalar=function(e){return(0,u.$X)(this.elements,this.elements,[e,e]),this},n.multiply=function(e){return(0,u.Jp)(this.elements,this.elements,e.elements),this},n.multiplyScalar=function(e){return(0,u.Jp)(this.elements,this.elements,[e,e]),this},n.divide=function(e){return(0,u.cs)(this.elements,this.elements,e.elements),this},n.divideScalar=function(e){return(0,u.cs)(this.elements,this.elements,[e,e]),this},n.scale=function(e){return(0,u.bA)(this.elements,this.elements,e),this},n.distanceTo=function(e){return(0,u.TE)(this.elements,e.elements)},n.length=function(){return(0,u.kE)(this.elements)},n.distanceToSquared=function(e){return(0,u.bI)(e.elements,this.elements)},n.angle=function(){return(0,u.EU)(this.elements,[1,0])},n.angleTo=function(e){return(0,u.EU)(this.elements,e.elements)},n.dot=function(e){return(0,u.AK)(this.elements,e.elements)},n.equals=function(e){return(0,u.fS)(this.elements,e.elements)},n.cross=function(e){return(0,u.kC)(this.elements,this.elements,e.elements),this},n.negate=function(){return(0,u.tk)(this.elements,this.elements),this},n.inverse=function(){return(0,u.SO)(this.elements,this.elements),this},n.lerp=function(e,t){return(0,u.t7)(this.elements,this.elements,e.elements,t),this},n.normalize=function(){return(0,u.Fv)(this.elements,this.elements),this},n.applyMatrix3=function(e){return(0,u.kK)(this.elements,this.elements,e.elements),this},n.applyMatrix4=function(e){return(0,u.fF)(this.elements,this.elements,e.elements),this},n.copy=function(e){return this.x=e.x,this.y=e.y,this},n.clone=function(){return new t(this.x,this.y)},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}}]),t}(ce),fe=[],me=(0,l.Z)("changeCallbacks"),pe=function(e){function t(t,n,i,s){var a;void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===s&&(s=0),(a=e.call(this)||this).elements=new(_())(4),Object.defineProperty((0,r.Z)(a),me,{writable:!0,value:[]});var o=a.elements;return o[0]=t,o[1]=n,o[2]=i,o[3]=s,a}(0,s.Z)(t,e);var n=t.prototype;return n.fromObject=function(e){var t=e.x,n=e.y,i=e.z,r=e.w;return void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==i&&(this.z=i),void 0!==r&&(this.w=r),this.triggerChange(),this},n.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},n.fromAxisAngle=function(e,t){return(0,d.yY)(this.elements,e.elements,t),this.triggerChange(),this},n.getAxisAngle=function(e){void 0===e&&(e=new ve);var t=(0,d.Bh)(fe,this.elements);return e.set(fe[0],fe[1],fe[2]),t},n.fromEuler=function(e){return(0,d.Su)(this.elements,A(e.x),A(e.y),A(e.z)),this.triggerChange(),this},n.fromMat3=function(e){return(0,d.bz)(this.elements,e),this},n.set=function(e,t,n,i){return(0,d.t8)(this.elements,e,t,n,i),this.triggerChange(),this},n.length=function(){return(0,d.kE)(this.elements)},n.multiply=function(e,t){return t?(0,d.Jp)(this.elements,e.elements,t.elements):(0,d.Jp)(this.elements,this.elements,e.elements),this.triggerChange(),this},n.slerp=function(e,t){return(0,d.ZA)(this.elements,this.elements,e.elements,t),this.triggerChange(),this},n.invert=function(){return(0,d.U_)(this.elements,this.elements),this.triggerChange(),this},n.conjugate=function(){return(0,d.Kx)(this.elements,this.elements),this.triggerChange(),this},n.normalize=function(){return(0,d.Fv)(this.elements,this.elements),this.triggerChange(),this},n.dot=function(e){return(0,d.AK)(this.elements,e.elements)},n.angleTo=function(e){return(0,d._O)(this.elements,e.elements)},n.clone=function(){return(new t).copy(this)},n.copy=function(e){return(0,d.JG)(this.elements,e.elements),this.triggerChange(),this},n.equals=function(e){return(0,f.fS)(this.elements,e.elements)},n.onChange=function(e){(0,o.Z)(this,me)[me].includes(e)||(0,o.Z)(this,me)[me].push(e)},n.triggerChange=function(){(0,o.Z)(this,me)[me].forEach((function(e){return e()}))},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e,this.triggerChange()}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e,this.triggerChange()}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e,this.triggerChange()}},{key:"w",get:function(){return this.elements[3]},set:function(e){this.elements[3]=e,this.triggerChange()}}]),t}(ce),ve=function(e){function t(t,n,i){var r;void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),(r=e.call(this)||this).elements=new(_())(3);var s=r.elements;return s[0]=t,s[1]=n,s[2]=i,r}(0,s.Z)(t,e);var n=t.prototype;return n.fromObject=function(e){var t=e.x,n=e.y,i=e.z;return void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==i&&(this.z=i),this},n.toObject=function(){return{x:this.x,y:this.y,z:this.z}},n.set=function(e,t,n){return(0,c.t8)(this.elements,e,t,n),this},n.setScalar=function(e){return this.set(e,e,e)},n.length=function(){return(0,c.kE)(this.elements)},n.add=function(e){return(0,c.IH)(this.elements,this.elements,e.elements),this},n.addScalar=function(e){return(0,c.IH)(this.elements,this.elements,[e,e,e]),this},n.subtract=function(e){return(0,c.$X)(this.elements,this.elements,e.elements),this},n.subtractScalar=function(e){return(0,c.$X)(this.elements,this.elements,[e,e,e]),this},n.subVectors=function(e,t){return(0,c.$X)(this.elements,e.elements,t.elements),this},n.multiply=function(e){return(0,c.Jp)(this.elements,this.elements,e.elements),this},n.multiplyScalar=function(e){return(0,c.Jp)(this.elements,this.elements,[e,e,e]),this},n.divide=function(e){return(0,c.cs)(this.elements,this.elements,e.elements),this},n.divideScalar=function(e){return(0,c.cs)(this.elements,this.elements,[e,e,e]),this},n.scale=function(e){return(0,c.bA)(this.elements,this.elements,e),this},n.scaleAndAdd=function(e,t){return(0,c.od)(this.elements,this.elements,e.elements,t),this},n.distanceTo=function(e){return(0,c.TE)(this.elements,e.elements)},n.distanceToSquared=function(e){return(0,c.bI)(this.elements,e.elements)},n.angle=function(e){return(0,c.EU)(this.elements,[1,0,0])},n.angleTo=function(e){return(0,c.EU)(this.elements,e.elements)},n.dot=function(e){return(0,c.AK)(this.elements,e.elements)},n.equals=function(e){return(0,c.fS)(this.elements,e.elements)},n.cross=function(e){return(0,c.kC)(this.elements,this.elements,e.elements),this},n.negate=function(){return(0,c.tk)(this.elements,this.elements),this},n.inverse=function(){return(0,c.SO)(this.elements,this.elements),this},n.lerp=function(e,t){return(0,c.t7)(this.elements,this.elements,e.elements,t),this},n.normalize=function(){return(0,c.Fv)(this.elements,this.elements),this},n.applyEuler=function(e){var t=(new pe).fromEuler(e);return this.applyQuaternion(t)},n.applyMatrix3=function(e){return(0,c.kK)(this.elements,this.elements,e.elements),this},n.applyMatrix4=function(e){return(0,c.fF)(this.elements,this.elements,e.elements),this},n.applyQuaternion=function(e){return(0,c.VC)(this.elements,this.elements,e.elements),this},n.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},n.clone=function(){return new t(this.x,this.y,this.z)},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e}}]),t}(ce),ge=function(e){function t(t,n,i,r){var s;void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),(s=e.call(this)||this).elements=new(_())(4);var a=s.elements;return a[0]=t,a[1]=n,a[2]=i,a[3]=r,s}(0,s.Z)(t,e);var n=t.prototype;return n.fromObject=function(e){var t=e.x,n=e.y,i=e.z,r=e.w;return void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==i&&(this.z=i),void 0!==r&&(this.w=r),this},n.toObject=function(){return{x:this.x,y:this.y,z:this.z,w:this.w}},n.set=function(e,t,n,i){return(0,f.t8)(this.elements,e,t,n,i),this},n.setScalar=function(e){return this.set(e,e,e,e)},n.add=function(e){return(0,f.IH)(this.elements,this.elements,e.elements),this},n.addScalar=function(e){return(0,f.IH)(this.elements,this.elements,[e,e,e,e]),this},n.subtract=function(e){return(0,f.$X)(this.elements,this.elements,e.elements),this},n.subtractScalar=function(e){return(0,f.$X)(this.elements,this.elements,[e,e,e,e]),this},n.subVectors=function(e,t){return(0,f.$X)(this.elements,e.elements,t.elements),this},n.multiply=function(e){return(0,f.Jp)(this.elements,this.elements,e.elements),this},n.multiplyScalar=function(e){return(0,f.Jp)(this.elements,this.elements,[e,e,e,e]),this},n.divide=function(e){return(0,f.cs)(this.elements,this.elements,e.elements),this},n.divideScalar=function(e){return(0,f.cs)(this.elements,this.elements,[e,e,e,e]),this},n.scale=function(e){return(0,f.bA)(this.elements,this.elements,e),this},n.scaleAndAdd=function(e,t){return(0,f.od)(this.elements,this.elements,e.elements,t),this},n.distanceTo=function(e){return(0,f.TE)(this.elements,e.elements)},n.distanceToSquared=function(e){return(0,f.bI)(this.elements,e.elements)},n.length=function(){return(0,f.kE)(this.elements)},n.dot=function(e){return(0,f.AK)(this.elements,e.elements)},n.equals=function(e){return(0,f.fS)(this.elements,e.elements)},n.cross=function(e){return(0,f.kC)(this.elements,this.elements,e.elements),this},n.negate=function(){return(0,f.tk)(this.elements,this.elements),this},n.inverse=function(){return(0,f.SO)(this.elements,this.elements),this},n.lerp=function(e,t){return(0,f.t7)(this.elements,this.elements,e.elements,t),this},n.normalize=function(){return(0,f.Fv)(this.elements,this.elements),this},n.applyMatrix4=function(e){return(0,f.fF)(this.elements,this.elements,e.elements),this},n.applyQuaternion=function(e){return(0,f.VC)(this.elements,this.elements,e.elements),this},n.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},n.clone=function(){return new t(this.x,this.y,this.z,this.w)},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e}},{key:"w",get:function(){return this.elements[3]},set:function(e){this.elements[3]=e}}]),t}(ce),be=function(){function e(){this.elements=new(_())(16)}var t=e.prototype;return t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<this.elements.length;n++)this.elements[n]=e[t+n];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=0;n<this.elements.length;n++)e[t+n]=this.elements[n];return e},e}(),ye=function(e){function t(t,n,i,r,s,a,o,l,h){var u;void 0===t&&(t=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===l&&(l=0),void 0===h&&(h=1),(u=e.call(this)||this).elements=new(_())(9);var c=u.elements;return c[0]=t,c[1]=n,c[2]=i,c[3]=r,c[4]=s,c[5]=a,c[6]=o,c[7]=l,c[8]=h,u}(0,s.Z)(t,e);var n=t.prototype;return n.set=function(e,t,n,i,r,s,a,o,l){return(0,m.t8)(this.elements,e,t,n,i,r,s,a,o,l),this},n.transpose=function(){return(0,m.p4)(this.elements,this.elements),this},n.invert=function(e){return void 0===e&&(e=this),(0,m.U_)(this.elements,e.elements),this},n.adjoint=function(e){return void 0===e&&(e=this),(0,m.uj)(this.elements,e.elements),this},n.determinant=function(){return(0,m.GH)(this.elements)},n.multiply=function(e,t){return t?(0,m.Jp)(this.elements,e.elements,t.elements):(0,m.Jp)(this.elements,this.elements,e.elements),this},n.premultiply=function(e,t){return t?(0,m.Jp)(this.elements,t.elements,e.elements):(0,m.Jp)(this.elements,e.elements,this.elements),this},n.translate=function(e){return(0,m.Iu)(this.elements,this.elements,e.elements),this},n.rotate=function(e){return(0,m.U1)(this.elements,this.elements,e),this},n.scale=function(e){return(0,m.bA)(this.elements,this.elements,e.elements),this},n.fromTranslation=function(e){return(0,m.vc)(this.elements,e.elements),this},n.fromRotation=function(e){return(0,m.Us)(this.elements,e),this},n.fromScaling=function(e){return(0,m.xJ)(this.elements,e.elements),this},n.fromQuat=function(e){return(0,m.en)(this.elements,e.elements),this},n.normalFromMat4=function(e){return(0,m.XL)(this.elements,e.elements),this},n.fromMat4=function(e){return(0,m.xO)(this.elements,e.elements),this},n.frob=function(){return(0,m.Du)(this.elements)},n.add=function(e,t){return t?(0,m.IH)(this.elements,e.elements,t.elements):(0,m.IH)(this.elements,this.elements,e.elements),this},n.subtract=function(e,t){return t?(0,m.$X)(this.elements,e.elements,t.elements):(0,m.$X)(this.elements,this.elements,e.elements),this},n.equals=function(e,t){return t?(0,m.fS)(e.elements,t.elements):(0,m.fS)(this.elements,e.elements)},n.fromRotationTranslationScale=function(e,t,n,i,r){var s=Math.cos(e),a=Math.sin(e);return this.set(i*s,-r*a,0,i*a,r*s,0,t,n,1),this},n.getNormalMatrix=function(e){return(0,m.XL)(this.elements,e.elements),this},n.copy=function(e){return(0,m.JG)(this.elements,e.elements),this},n.clone=function(){return(new t).copy(this)},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[2]}},{key:"y",get:function(){return this.elements[5]}},{key:"z",get:function(){return this.elements[8]}}],[{key:"identity",get:function(){return(new t).fromArray((0,m.yR)([]))}}]),t}(be),xe=[],we=function(e){function t(t,n,i,r,s,a,o,l,h,u,c,d,f,m,p,v){var g;void 0===t&&(t=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===a&&(a=1),void 0===o&&(o=0),void 0===l&&(l=0),void 0===h&&(h=0),void 0===u&&(u=0),void 0===c&&(c=1),void 0===d&&(d=0),void 0===f&&(f=0),void 0===m&&(m=0),void 0===p&&(p=0),void 0===v&&(v=1),(g=e.call(this)||this).elements=new(_())(16);var b=g.elements;return b[0]=t,b[1]=n,b[2]=i,b[3]=r,b[4]=s,b[5]=a,b[6]=o,b[7]=l,b[8]=h,b[9]=u,b[10]=c,b[11]=d,b[12]=f,b[13]=m,b[14]=p,b[15]=v,g}(0,s.Z)(t,e);var n=t.prototype;return n.set=function(e,t,n,i,r,s,a,o,l,h,u,c,d,f,m,v){return(0,p.t8)(this.elements,e,t,n,i,r,s,a,o,l,h,u,c,d,f,m,v),this},n.transpose=function(){return(0,p.p4)(this.elements,this.elements),this},n.invert=function(e){return void 0===e&&(e=this),(0,p.U_)(this.elements,e.elements),this},n.adjoint=function(e){return void 0===e&&(e=this),(0,p.uj)(this.elements,e.elements),this},n.determinant=function(){return(0,p.GH)(this.elements)},n.add=function(e,t){return t?(0,p.IH)(this.elements,e.elements,t.elements):(0,p.IH)(this.elements,this.elements,e.elements),this},n.subtract=function(e,t){return t?(0,p.$X)(this.elements,e.elements,t.elements):(0,p.$X)(this.elements,this.elements,e.elements),this},n.multiply=function(e,t){return t?(0,p.Jp)(this.elements,e.elements,t.elements):(0,p.Jp)(this.elements,this.elements,e.elements),this},n.multiplyScalar=function(e,t){return void 0===e&&(e=this),(0,p.cf)(this.elements,e.elements,t),this},n.premultiply=function(e,t){return t?(0,p.Jp)(this.elements,t.elements,e.elements):(0,p.Jp)(this.elements,e.elements,this.elements),this},n.translate=function(e){return(0,p.Iu)(this.elements,this.elements,e.elements),this},n.rotate=function(e){return(0,p.U1)(this.elements,this.elements,e),this},n.scale=function(e){return(0,p.bA)(this.elements,this.elements,e.elements),this},n.scaleScalar=function(e){return(0,p.bA)(this.elements,this.elements,[e,e,e]),this},n.fromTranslation=function(e){return(0,p.vc)(this.elements,e.elements),this},n.fromRotation=function(e,t){return(0,p.Us)(this.elements,e,t),this},n.fromRotationX=function(e){return(0,p.aC)(this.elements,e),this},n.fromRotationY=function(e){return(0,p.gT)(this.elements,e),this},n.fromRotationZ=function(e){return(0,p.QO)(this.elements,e),this},n.fromScale=function(e){return(0,p.xJ)(this.elements,e.elements),this},n.fromRotationTranslation=function(e,t){return(0,p.yl)(this.elements,e.elements,t.elements),this},n.fromPerspective=function(e,t,n,i){return(0,p.G3)(this.elements,E(e),t,n,i),this},n.fromOrthogonal=function(e,t,n,i,r,s){return(0,p.M5)(this.elements,e,t,n,i,r,s),this},n.fromQuat=function(e){return(0,p.en)(this.elements,e.elements),this},n.equals=function(e){return(0,p.fS)(this.elements,e.value)},n.getRotation=function(e){return void 0===e&&(e=new pe),(0,p.j6)(xe,this.elements),e.set(xe[0],xe[1],xe[2],xe[3]),e},n.getScale=function(e){return void 0===e&&(e=new ve),(0,p.Q$)(xe,this.elements),e.set(xe[0],xe[1],xe[2]),e},n.getTranslation=function(e){return void 0===e&&(e=new ve),(0,p.i0)(xe,this.elements),e.set(xe[0],xe[1],xe[2]),e},n.rotateX=function(e){return(0,p.lM)(this.elements,this.elements,e),this},n.rotateY=function(e){return(0,p.uD)(this.elements,this.elements,e),this},n.rotateZ=function(e){return(0,p.jI)(this.elements,this.elements,e),this},n.compose=function(e,t,n){return(0,p.Iw)(this.elements,t.elements,e.elements,n.elements),this},n.decompose=function(){return{rotation:this.getRotation(),scale:this.getScale(),translation:this.getTranslation()}},n.copy=function(e){return(0,p.JG)(this.elements,e.elements),this},n.clone=function(){return(new t).copy(this)},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[12]}},{key:"y",get:function(){return this.elements[13]}},{key:"z",get:function(){return this.elements[14]}},{key:"w",get:function(){return this.elements[15]}}],[{key:"identity",get:function(){return(new t).fromArray((0,p.yR)([]))}}]),t}(be),Ze=(0,l.Z)("changeCallbacks"),Ee=(0,l.Z)("order"),Ae=function(e){function t(t,n,i,s){var a;void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===s&&(s="xyz"),(a=e.call(this)||this).elements=new(_())(3),Object.defineProperty((0,r.Z)(a),Ze,{writable:!0,value:[]}),Object.defineProperty((0,r.Z)(a),Ee,{writable:!0,value:"xyz"});var l=a.elements;return l[0]=t,l[1]=n,l[2]=i,(0,o.Z)((0,r.Z)(a),Ee)[Ee]=s,a}(0,s.Z)(t,e);var n=t.prototype;return n.fromObject=function(e){var t=e.x,n=e.y,i=e.z,r=e.order;return void 0!==t&&(this.x=t),void 0!==n&&(this.y=n),void 0!==i&&(this.z=i),void 0!==r&&(this.order=r),this.triggerChange(),this},n.toObject=function(){return{x:this.x,y:this.y,z:this.z,order:this.order}},n.fromRotationMatrix=function(e,t,n){void 0===t&&(t=(0,o.Z)(this,Ee)[Ee]),void 0===n&&(n=!0);var i=e.toArray(),r=i[0],s=i[4],a=i[8],l=i[1],h=i[5],u=i[9],c=i[2],d=i[6],f=i[10];switch(t){case"xyz":this.y=Math.asin(M(a,-1,1)),Math.abs(a)<.9999999?(this.x=Math.atan2(-u,f),this.z=Math.atan2(-s,r)):(this.x=Math.atan2(d,h),this.z=0);break;case"yxz":this.x=Math.asin(-M(u,-1,1)),Math.abs(u)<.9999999?(this.y=Math.atan2(a,f),this.z=Math.atan2(l,h)):(this.y=Math.atan2(-c,r),this.z=0);break;case"zxy":this.x=Math.asin(M(d,-1,1)),Math.abs(d)<.9999999?(this.y=Math.atan2(-c,f),this.z=Math.atan2(-s,h)):(this.y=0,this.z=Math.atan2(l,r));break;case"zyx":this.y=Math.asin(-M(c,-1,1)),Math.abs(c)<.9999999?(this.x=Math.atan2(d,f),this.z=Math.atan2(l,r)):(this.x=0,this.z=Math.atan2(-s,h));break;case"yzx":this.z=Math.asin(M(l,-1,1)),Math.abs(l)<.9999999?(this.x=Math.atan2(-u,h),this.y=Math.atan2(-c,r)):(this.x=0,this.y=Math.atan2(a,f));break;case"xzy":this.z=Math.asin(-M(s,-1,1)),Math.abs(s)<.9999999?(this.x=Math.atan2(d,h),this.y=Math.atan2(a,r)):(this.x=Math.atan2(-u,f),this.y=0);break;default:throw new Error("Unknown Euler angle order")}return(0,o.Z)(this,Ee)[Ee]=t,n&&this.triggerChange(),this},n.fromQuaternion=function(e){var n=e.elements,i=n[0],r=n[1],s=n[2],a=n[3],o=r*r,l=-2*(o+s*s)+1,h=2*(i*r+a*s),u=-2*(i*s-a*r),c=2*(r*s+a*i),d=-2*(i*i+o)+1;return u=(u=u>1?1:u)<-1?-1:u,new t(Math.atan2(c,d),Math.asin(u),Math.atan2(h,l),"zyx")},n.fromVector3=function(e,t){return void 0===t&&(t=(0,o.Z)(this,Ee)[Ee]),this.set(e.x,e.y,e.z,t)},n.toQuaternion=function(){var e=Math.cos(.5*this.yaw),t=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),i=Math.sin(.5*this.roll),r=Math.cos(.5*this.pitch),s=Math.sin(.5*this.pitch);return new pe(e*i*r-t*n*s,e*n*s+t*i*r,t*n*r-e*i*s,e*n*r+t*i*s)},n.toVector3=function(){return new ve(this.x,this.y,this.z)},n.set=function(e,t,n,i){return void 0===i&&(i=(0,o.Z)(this,Ee)[Ee]),this.elements[0]=e,this.elements[1]=t,this.elements[2]=n,(0,o.Z)(this,Ee)[Ee]=i,this.triggerChange(),this},n.clone=function(){return(new t).copy(this)},n.copy=function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]=e.elements[t];return(0,o.Z)(this,Ee)[Ee]=e.order,this.triggerChange(),this},n.equals=function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.order===e.order},n.onChange=function(e){(0,o.Z)(this,Ze)[Ze].includes(e)||(0,o.Z)(this,Ze)[Ze].push(e)},n.triggerChange=function(){(0,o.Z)(this,Ze)[Ze].forEach((function(e){return e()}))},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},(0,a.Z)(t,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e,this.triggerChange()}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e,this.triggerChange()}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e,this.triggerChange()}},{key:"order",get:function(){return(0,o.Z)(this,Ee)[Ee]},set:function(e){(0,o.Z)(this,Ee)[Ee]=e,this.triggerChange()}},{key:"roll",get:function(){return this.x},set:function(e){this.x=e}},{key:"pitch",get:function(){return this.y},set:function(e){this.y=e}},{key:"yaw",get:function(){return this.z},set:function(e){this.z=e}}]),t}(ce);(0,v.l7)([function(e,t){var n={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var r in n)i[n[r]]=r;var s={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var r,a,o=i[this.toHex()];if(o)return o;if(null==t?void 0:t.closest){var l=this.toRgb(),h=1/0,u="black";if(!s.length)for(var c in n)s[c]=new e(n[c]).toRgb();for(var d in n){var f=(r=l,a=s[d],Math.pow(r.r-a.r,2)+Math.pow(r.g-a.g,2)+Math.pow(r.b-a.b,2));f<h&&(h=f,u=d)}return u}},t.string.push([function(t){var i=t.toLowerCase(),r="transparent"===i?"#0000":n[i];return r?new e(r).toRgb():null},"name"])}]);var Me=function(e,t,n){var i=k(e),r=n-t,s=M(Number.parseFloat(""+e),t,n);return i&&(s=Number.parseInt(""+e*n,10)/100),Math.abs(s-n)<1e-6?1:e%r/r},Te=function(){function e(e,t,n,i,r){if(void 0===e&&(e=255),void 0===i&&(i=1),void 0===r&&(r=!1),this.r=void 0,this.g=void 0,this.b=void 0,this.a=void 0,this.r=1,this.g=1,this.b=1,this.a=1,I(t)&&I(n))if(B(e)&&e<=255)this.setRGBA(e,e,e,this.a,r);else{var s=(0,v.Vi)(e).toRgb();s?this.setRGBA(s.r,s.g,s.b,s.a):console.error("Unsupported color value {".concat(String(e),"} provided"))}else this.setRGBA(e,t,n,i)}var t=e.prototype;return t.fromColor=function(e){var t=(0,v.Vi)(e).toRgb();return this.setRGBA(t.r,t.g,t.b,t.a)},t.fromHSL=function(e,t,n,i){void 0===i&&(i=1);var r=(0,v.Vi)({h:e,s:t,l:n,a:i}).toRgb();return this.setRGBA(r.r,r.g,r.b,r.a)},t.fromHSV=function(e,t,n,i){void 0===i&&(i=1);var r=(0,v.Vi)({h:e,s:t,v:n,a:i}).toRgb();return this.setRGBA(r.r,r.g,r.b,r.a)},t.setRGB=function(e,t,n){return this.setRGBA(e,t,n,this.a),this},t.setRGBA=function(e,t,n,i,r){return this.r=r?e:Me(e,0,255),this.g=r?t:Me(t,0,255),this.b=r?n:Me(n,0,255),this.setAlpha(i),this},t.setAlpha=function(e){return this.a=e>1?Me(e,0,255):e,this},t.toHex=function(){return(0,v.Vi)(this.toObject()).toHex()},t.toHSL=function(){return(0,v.Vi)(this.toObject()).toHsl()},t.toHSV=function(){return(0,v.Vi)(this.toObject()).toHsv()},t.toObject=function(e){void 0===e&&(e=!1);var t=e?1:255;return{r:this.r*t,g:this.g*t,b:this.b*t,a:this.a}},t.toArray=function(){return[this.r,this.g,this.b,this.a]},t.toVector=function(){return(new ge).fromArray(this.toArray())},t.toVector3=function(){return(new ve).fromArray(this.toArray())},t.toString=function(){return this.constructor.name+"("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},e}(),Se=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.frustum=function(e,t,n,i,r,s,a){return(0,p.oy)(e.elements,t,n,r,i,s,a),this},n.orthographic=function(e,t,n,i,r,s){return(0,p.M5)(this.elements,e,t,i,n,r,s),this},n.perspective=function(e,t,n,i){return(0,p.G3)(this.elements,e,t,n,i),this},n.lookAt=function(e,t,n){return void 0===t&&(t=new ve(0,0,0)),void 0===n&&(n=new ve(0,1,0)),(0,p.zB)(this.elements,e.elements,t.elements,n.elements),this},n.toString=function(){return this.constructor.name+"("+this.elements.join(", ")+")"},t}(we),Re=function(){function e(){var e=this;this.visible=void 0,this.localMatrix=void 0,this.worldMatrix=void 0,this.matrixAutoUpdate=void 0,this.position=void 0,this.scale=void 0,this.rotation=void 0,this.quaternion=void 0,this.up=void 0,this.children=void 0,this.parent=void 0,this.worldMatrixNeedsUpdate=void 0,this.visible=!0,this.localMatrix=new Se,this.worldMatrix=new Se,this.matrixAutoUpdate=!0,this.position=new ve,this.scale=new ve(1,1,1),this.rotation=new Ae,this.quaternion=new pe,this.up=new ve(0,1,0),this.parent=null,this.children=[],this.worldMatrixNeedsUpdate=!1,this.rotation.onChange((function(){e.quaternion.fromEuler(e.rotation)})),this.quaternion.onChange((function(){e.rotation.fromQuaternion(e.quaternion)}))}var t=e.prototype;return t.add=function(e,t){void 0===t&&(t=!0),this.contains(e)||this.children.push(e),t&&e.setParent(this,!1)},t.remove=function(e,t){void 0===t&&(t=!0),this.contains(e)&&this.children.splice(this.children.indexOf(e),1),t&&e.setParent(null,!1)},t.contains=function(e){return this.children.includes(e)},t.setParent=function(e,t){void 0===t&&(t=!0),this.parent&&e!==this.parent&&this.parent.remove(this,!1),this.parent=e,t&&e&&e.add(this,!1)},t.traverse=function(e){if(!e(this))for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverse(e)},t.lookAt=function(e,t){t?this.localMatrix.lookAt(this.position,e,this.up):this.localMatrix.lookAt(e,this.position,this.up),this.localMatrix.getRotation(this.quaternion),this.rotation.fromQuaternion(this.quaternion)},t.updateMatrixWorld=function(e){var t=e;this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(null===this.parent?this.worldMatrix.copy(this.localMatrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.localMatrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(var n=0,i=this.children.length;n<i;n++){this.children[n].updateMatrixWorld(t)}},t.updateMatrix=function(){this.localMatrix.compose(this.position,this.quaternion,this.scale),this.worldMatrixNeedsUpdate=!0},t.decompose=function(){this.localMatrix.getTranslation(this.position),this.localMatrix.getRotation(this.quaternion),this.localMatrix.getScale(this.scale),this.rotation.fromQuaternion(this.quaternion)},t.clone=function(){return(new e).copy(this,!1)},t.copy=function(e,t){if(this.visible=e.visible,this.position.copy(e.position),this.scale.copy(e.scale),this.rotation.copy(e.rotation),this.quaternion.copy(e.quaternion),this.up.copy(e.up),this.localMatrix.copy(e.localMatrix),this.worldMatrix.copy(e.worldMatrix),this.matrixAutoUpdate=e.matrixAutoUpdate,t)for(var n=0,i=e.children.length;n<i;n++){var r=e.children[n];this.add(r.clone())}return this},e}(),_e=function(){function e(e){this.renderer=void 0,this.renderer=e}return(0,a.Z)(e,[{key:"gl",get:function(){return this.renderer.gl}},{key:"rendererState",get:function(){return this.renderer.state}}]),e}(),Ce=function(e,t){this.id=void 0,this.data=void 0,this.type=void 0,this.size=void 0,this.instanced=void 0,this.stride=void 0,this.offset=void 0,this.divisor=void 0,this.normalized=void 0,this.needsUpdate=void 0,this.count=void 0,this.usage=void 0,this.target=void 0,this.buffer=void 0;var n,i,r=Object.assign({},{size:1,normalized:!0,stride:0,offset:0,divisor:0,usage:e.gl.STATIC_DRAW},t);if(this.id=z("attribute"),this.needsUpdate=!1,!t.data||Array.isArray(t.data))throw new TypeError("BufferAttribute: data should be a typed array");this.data=r.data,this.size=r.size||1,this.type=r.type||(n=e.gl,(i=r.data)instanceof Float32Array||i instanceof Float64Array?n.FLOAT:i instanceof Uint16Array?n.UNSIGNED_SHORT:i instanceof Uint8Array||i instanceof Uint8ClampedArray?n.UNSIGNED_BYTE:i instanceof Uint32Array?n.UNSIGNED_INT:i instanceof Int8Array?n.BYTE:i instanceof Int16Array?n.SHORT:i instanceof Int32Array?n.INT:void 0),this.normalized=r.normalized||!1,this.stride=r.stride||0,this.offset=r.offset||0,this.divisor=r.divisor||0,this.instanced=r.divisor>0,this.usage=r.usage||e.gl.STATIC_DRAW,r.target&&(this.target=r.target);var s=r.count;void 0!==r.count&&null!==r.count||(s=r.stride?r.data.byteLength/r.stride:r.data.length/r.size),this.count=s},Fe=new ve,Pe=(0,l.Z)("id"),Oe=(0,l.Z)("attributes"),Le=(0,l.Z)("VAOs"),Ne=(0,l.Z)("bounds"),Ie=function(e){function t(t,n){var i;for(var s in void 0===n&&(n={}),i=e.call(this,t)||this,Object.defineProperty((0,r.Z)(i),Pe,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Oe,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Le,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Ne,{writable:!0,value:void 0}),i.drawRange=void 0,i.instancedCount=void 0,i.isInstanced=void 0,i.drawMode=void 0,i.drawRange={start:0,count:0},i.instancedCount=0,i.isInstanced=!1,(0,o.Z)((0,r.Z)(i),Oe)[Oe]=new Map,(0,o.Z)((0,r.Z)(i),Le)[Le]=new Map,(0,o.Z)((0,r.Z)(i),Pe)[Pe]=z("geometry"),i.drawMode=i.gl.TRIANGLES,t.bindVertexArray(null),t.state.setActiveGeometry(null),n){var a=n[s];if(a instanceof Ce)"index"===s?i.setIndex(a):i.addAttribute(s,a);else if(a.data){var l=new Ce(i.renderer,a);"index"===s?i.setIndex(l):i.addAttribute(s,l)}}return i}(0,s.Z)(t,e);var n=t.prototype;return n.addAttribute=function(e,t){if(t.target||(t.target="index"===e?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER),t.needsUpdate=!1,this.attributes.set(e,t),t.buffer||(t.buffer=this.gl.createBuffer(),this.updateAttribute(t)),t.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==t.count*t.divisor)return this.instancedCount=Math.min(this.instancedCount,t.count*t.divisor),console.warn("Geometry has multiple instanced buffers of different length - instancedCount: "+this.instancedCount+", count: "+t.count+", divisor: "+t.divisor+", attribute: "+e);this.instancedCount=t.count*t.divisor}else"index"===e?this.drawRange.count=t.count:this.index||(this.drawRange.count=Math.max(this.drawRange.count,t.count))},n.getAttribute=function(e){return this.attributes.get(e)},n.setAttributeData=function(e,t){var n=this.getAttribute(e);n&&(n.data=t,n.needsUpdate=!0)},n.updateAttribute=function(e){!e.buffer&&(e.buffer=this.gl.createBuffer()),this.rendererState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.rendererState.boundBuffer=e.buffer),this.gl.bufferData(e.target,e.data,e.usage),e.needsUpdate=!1},n.removeAttribute=function(e){this.attributes.delete(e)},n.setIndex=function(e){var t;if(e instanceof Ce)e.size=1,this.addAttribute("index",e);else{var n=new Ce(this.renderer,{data:e.length>65535?new Uint32Array(e):new Uint16Array(e),size:1});this.addAttribute("index",n)}this.drawRange.count=null==(t=this.index)?void 0:t.count},n.setVertices=function(e){for(var t=[],n=e.length,i=0;i<n;i++){var r=e[i];t.push(r[0],r[1],r[2])}this.addAttribute("position",new Ce(this.renderer,{data:new Float32Array(t),size:3}))},n.setNormals=function(e){this.addAttribute("normal",new Ce(this.renderer,{data:new Float32Array(e),size:2}))},n.setUVs=function(e){this.addAttribute("uv",new Ce(this.renderer,{data:new Float32Array(e),size:2}))},n.setColors=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i&&(i instanceof ve||i instanceof ge)&&(i=i.toArray()),t.push(i[0],i[1],i[2],i[3]||1)}this.addAttribute("color",new Ce(this.renderer,{data:new Float32Array(t),size:4}))},n.setDrawRange=function(e,t){this.drawRange.start=e,this.drawRange.count=t},n.setInstancedCount=function(e){this.instancedCount=e},n.createVAO=function(e){var t=e.attributeOrder,n=this.renderer.createVertexArray();this.renderer.bindVertexArray(n),(0,o.Z)(this,Le)[Le].set(t,n),this.bindAttributes(e)},n.bindAttributes=function(e){var t=this;e.attributeLocations.forEach((function(e,n){var i=n.name,r=n.type,s=t.attributes.get(i);if(s){t.gl.bindBuffer(s.target,s.buffer),t.rendererState.boundBuffer=s.buffer;var a=1;r===t.gl.FLOAT_MAT2&&(a=2),r===t.gl.FLOAT_MAT3&&(a=3),r===t.gl.FLOAT_MAT4&&(a=4);for(var o=s.size/a,l=1===a?0:a*a*a,h=1===a?0:a*a,u=0;u<a;u++){var c=e+u;t.gl.vertexAttribPointer(c,o,s.type,s.normalized,s.stride+l,s.offset+h),t.gl.enableVertexAttribArray(c),t.renderer.vertexAttribDivisor(c,s.divisor)}}}));var n=this.attributes.get("index");n&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,n.buffer)},n.computeBoundingBox=function(e){var t=this.attributes.get("position"),n=t.data,i=t.offset,r=void 0===i?0:i,s=t.stride,a=t.size;(0,o.Z)(this,Ne)[Ne]||((0,o.Z)(this,Ne)[Ne]={min:new ve,max:new ve,center:new ve,scale:new ve,radius:Number.POSITIVE_INFINITY}),(0,o.Z)(this,Ne)[Ne].min.setScalar(+Number.POSITIVE_INFINITY),(0,o.Z)(this,Ne)[Ne].max.setScalar(Number.NEGATIVE_INFINITY);for(var l=e||n,h=s||a,u=r;u<l.length;u+=h){var c=l[u+0],d=l[u+1],f=l[u+2];(0,o.Z)(this,Ne)[Ne].min.x=Math.min(c,(0,o.Z)(this,Ne)[Ne].min.x),(0,o.Z)(this,Ne)[Ne].min.y=Math.min(d,(0,o.Z)(this,Ne)[Ne].min.y),(0,o.Z)(this,Ne)[Ne].min.z=Math.min(f,(0,o.Z)(this,Ne)[Ne].min.z),(0,o.Z)(this,Ne)[Ne].max.x=Math.max(c,(0,o.Z)(this,Ne)[Ne].max.x),(0,o.Z)(this,Ne)[Ne].max.y=Math.max(d,(0,o.Z)(this,Ne)[Ne].max.y),(0,o.Z)(this,Ne)[Ne].max.z=Math.max(f,(0,o.Z)(this,Ne)[Ne].max.z)}return(0,o.Z)(this,Ne)[Ne].scale.subVectors((0,o.Z)(this,Ne)[Ne].max,(0,o.Z)(this,Ne)[Ne].min),(0,o.Z)(this,Ne)[Ne].center.add((0,o.Z)(this,Ne)[Ne].min).add((0,o.Z)(this,Ne)[Ne].max).divideScalar(2),(0,o.Z)(this,Ne)[Ne]},n.computeBoundingSphere=function(e){var t=this.attributes.get("position"),n=t.data,i=t.offset,r=void 0===i?0:i,s=t.stride,a=t.size;(0,o.Z)(this,Ne)[Ne]||this.computeBoundingBox(e);for(var l=e||n,h=0,u=s||a,c=l.length,d=r;d<c;d+=u)Fe.fromArray(l,d),h=Math.max(h,(0,o.Z)(this,Ne)[Ne].center.distanceToSquared(Fe));(0,o.Z)(this,Ne)[Ne].radius=Math.sqrt(h)},n.draw=function(e,t){var n=this;void 0===t&&(t=this.drawMode);var i=this.drawRange,r=i.start,s=i.count,a=this.id+"_"+e.attributeOrder;this.rendererState.activeGeometryId!==a&&((0,o.Z)(this,Le)[Le].get(e.attributeOrder)||this.createVAO(e),this.renderer.bindVertexArray((0,o.Z)(this,Le)[Le].get(e.attributeOrder)),this.rendererState.activeGeometryId=a);if(e.attributeLocations.forEach((function(e,t){var i=t.name,r=n.getAttribute(i);r&&r.needsUpdate&&n.updateAttribute(r)})),this.isInstanced)if(this.index){var l=this.index.offset+2*r;this.renderer.drawElementsInstanced(t,s,this.index.type,l,this.instancedCount)}else this.renderer.drawArraysInstanced(t,r,s,this.instancedCount);else if(this.index){var h=this.index.offset+2*r;this.gl.drawElements(t,s,this.index.type,h)}else this.gl.drawArrays(t,r,s)},n.copy=function(e){var t=e.attributesData;for(var n in t){var i=t[n];if(i instanceof Ce)"index"===n?this.setIndex(i):this.addAttribute(n,i);else if(i.data){var r=new Ce(this.renderer,i);"index"===n?this.setIndex(r):this.addAttribute(n,r)}}return e.bounds&&(this.bounds={min:(new ve).copy(e.bounds.min),max:(new ve).copy(e.bounds.max),center:(new ve).copy(e.bounds.center),scale:(new ve).copy(e.bounds.scale),radius:e.bounds.radius}),this},n.clone=function(){var e=new t(this.renderer,{}).copy(this);return e.drawMode=this.drawMode,e},n.destroy=function(){var e=this;(0,o.Z)(this,Le)[Le].forEach((function(t){e.renderer.deleteVertexArray(t)})),(0,o.Z)(this,Le)[Le].clear(),(0,o.Z)(this,Oe)[Oe].forEach((function(t){e.gl.deleteBuffer(t.buffer)})),(0,o.Z)(this,Oe)[Oe].clear()},(0,a.Z)(t,[{key:"id",get:function(){return(0,o.Z)(this,Pe)[Pe]}},{key:"attributes",get:function(){return(0,o.Z)(this,Oe)[Oe]}},{key:"attributesData",get:function(){for(var e={},t=(0,o.Z)(this,Oe)[Oe].entries(),n=0;n<(0,o.Z)(this,Oe)[Oe].size;n++){var i=t.next().value;e[i[0]]=V(i[1],["id","buffer"])}return e}},{key:"index",get:function(){return this.attributes.get("index")}},{key:"bounds",get:function(){return(0,o.Z)(this,Ne)[Ne]},set:function(e){(0,o.Z)(this,Ne)[Ne]=e}}]),t}(_e),ke=(0,l.Z)("id"),Be=(0,l.Z)("lastMode"),Ue=(0,l.Z)("geometry"),je=(0,l.Z)("program"),De=(0,l.Z)("wireframe"),Ge=(0,l.Z)("wireframeGeometry"),ze=function(e){function t(t,n){var i;void 0===n&&(n={}),(i=e.call(this)||this).gl=void 0,i.modelViewMatrix=void 0,i.normalMatrix=void 0,i.renderOrder=void 0,i.zDepth=void 0,i.frustumCulled=void 0,i.mode=void 0,i.renderer=void 0,Object.defineProperty((0,r.Z)(i),ke,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Be,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Ue,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),je,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),De,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Ge,{writable:!0,value:void 0});var s=Object.assign({},{mode:t.gl.TRIANGLES,frustumCulled:!0,renderOrder:0},n);return i.renderer=t,i.gl=i.renderer.gl,i.modelViewMatrix=new we,i.normalMatrix=new ye,i.renderOrder=s.renderOrder,i.frustumCulled=s.frustumCulled,i.zDepth=0,(0,o.Z)((0,r.Z)(i),ke)[ke]=s.id||z("mesh"),(0,o.Z)((0,r.Z)(i),Ue)[Ue]=s.geometry,(0,o.Z)((0,r.Z)(i),je)[je]=s.program,(0,o.Z)((0,r.Z)(i),De)[De]=Boolean(s.wireframe),i.mode=s.mode,(0,o.Z)((0,r.Z)(i),Be)[Be]=s.mode,(0,o.Z)((0,r.Z)(i),De)[De]&&(i.mode=i.gl.LINES,i.updateWireframeGeometry((0,o.Z)((0,r.Z)(i),De)[De])),i}(0,s.Z)(t,e);var n=t.prototype;return n.draw=function(e){var t,n,i=this;void 0===e&&(e={});var r=e,s=r.camera,a=r.target,o={};s?(Object.assign(o,{projectionMatrix:s.projectionMatrix,cameraPosition:s.worldPosition,viewMatrix:s.viewMatrix}),this.modelViewMatrix.multiply(s.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix)):this.modelViewMatrix.copy(this.worldMatrix),Object.assign(o,{resolution:new de((null==(t=this.renderer.state)||null==(t=t.viewport)?void 0:t.width)||1,(null==(n=this.renderer.state)||null==(n=n.viewport)?void 0:n.height)||1),modelMatrix:this.worldMatrix,modelViewMatrix:this.modelViewMatrix,normalMatrix:this.normalMatrix}),Object.keys(o).forEach((function(e){Object.hasOwn(i.program.uniforms,e)||(i.program.uniforms[e]={value:null}),i.program.uniforms[e].value=o[e]})),a&&a.bind(),this.program.use(),this.geometry.draw(this.program,this.mode),a&&a.unbind()},n.updateWireframeGeometry=function(e,t){if(void 0===t&&(t=!1),(0,o.Z)(this,Ue)[Ue]&&(t||!(0,o.Z)(this,Ge)[Ge])){var n,i;(0,o.Z)(this,Ge)[Ge]&&(0,o.Z)(this,Ge)[Ge].destroy();var r=null==(n=(0,o.Z)(this,Ue)[Ue].attributes.get("position"))?void 0:n.data,s=null==(i=(0,o.Z)(this,Ue)[Ue].index)?void 0:i.data,a=s?s.length:Math.floor(r.length/3),l=[];(0,o.Z)(this,Ue)[Ue].index?s&&y(r,l,a,s):y(r,l,a);var h=l.length>65536?new Uint32Array(l):new Uint16Array(l);(0,o.Z)(this,Ge)[Ge]=new Ie(this.renderer,Object.assign({},(0,o.Z)(this,Ue)[Ue].attributesData,{index:{data:h}}))}},n.updateGeometry=function(e,t){void 0===t&&(t=!0),t&&(0,o.Z)(this,Ue)[Ue]&&(0,o.Z)(this,Ue)[Ue].destroy(),(0,o.Z)(this,Ue)[Ue]=e,this.updateWireframeGeometry((0,o.Z)(this,De)[De],!0)},n.updateProgram=function(e,t){void 0===t&&(t=!0),t&&(0,o.Z)(this,je)[je]&&(0,o.Z)(this,je)[je].destroy(),(0,o.Z)(this,je)[je]=e},n.destroy=function(){this.program.destroy(),this.geometry.destroy()},n.clone=function(){return new t(this.gl,{geometry:this.geometry,program:this.program,frustumCulled:this.frustumCulled,mode:this.mode,renderOrder:this.renderOrder}).copy(this)},n.copy=function(t,n){return void 0===n&&(n=!0),e.prototype.copy.call(this,t,n),this.modelViewMatrix.copy(t.modelViewMatrix),this.normalMatrix.copy(t.normalMatrix),this.mode=t.mode,this.renderOrder=t.renderOrder,this.zDepth=t.zDepth,this},(0,a.Z)(t,[{key:"id",get:function(){return(0,o.Z)(this,ke)[ke]}},{key:"geometry",get:function(){return(0,o.Z)(this,De)[De]?(0,o.Z)(this,Ge)[Ge]:(0,o.Z)(this,Ue)[Ue]}},{key:"program",get:function(){return(0,o.Z)(this,je)[je]}},{key:"wireframe",get:function(){return(0,o.Z)(this,De)[De]},set:function(e){this.mode=e?this.gl.LINES:(0,o.Z)(this,Be)[Be],(0,o.Z)(this,De)[De]=e,this.updateWireframeGeometry((0,o.Z)(this,De)[De])}}]),t}(Re),Ve=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.clone=function(){return(new t).copy(this,!1)},n.copy=function(t,n){return e.prototype.copy.call(this,t,n),this.matrixAutoUpdate=t.matrixAutoUpdate,this},t}(Re),We=function(e){return e[e.NoBlending=0]="NoBlending",e[e.NormalBlending=1]="NormalBlending",e[e.AdditiveBlending=2]="AdditiveBlending",e[e.SubtractiveBlending=3]="SubtractiveBlending",e[e.MultiplyBlending=4]="MultiplyBlending",e[e.CustomBlending=5]="CustomBlending",e}(We||{}),He=(0,l.Z)("state"),qe=function(e){function t(t,n){var i;i=e.call(this,t)||this,Object.defineProperty((0,r.Z)(i),He,{writable:!0,value:void 0});var s=t.gl;return(0,o.Z)((0,r.Z)(i),He)[He]={viewport:{x:0,y:0,width:0,height:0}},i.apply(n||{frontFace:s.CCW,depthTest:!1,depthWrite:!0,depthMask:!0,depthFunc:s.LESS,blending:1,blendFunc:{src:s.ONE,dst:s.ZERO},blendEquation:{modeRGB:s.FUNC_ADD},premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,framebuffer:null,textureUnits:[],activeTextureUnit:-1,activeGeometryId:-1,currentProgramId:-1,clearAlpha:1,clearColor:new Te(0),stencil:{func:{},opFront:{},opBack:{}}}),i}(0,s.Z)(t,e);var n=t.prototype;return n.apply=function(e){if(void 0!==e.blending&&null!==e.blending)this.setBlending(e.blending,e);else{if(e.blendFunc){var t=e.blendFunc,n=t.src,i=t.dst,r=t.srcAlpha,s=t.dstAlpha;this.setBlendFunc(n,i,r,s),this.enable(this.gl.BLEND)}else this.disable(this.gl.BLEND);if(e.blendEquation){var a=e.blendEquation,l=a.modeRGB,h=a.modeAlpha;this.setBlendEquation(l,h)}}I(e.cullFace)||j(e.cullFace)||this.setCullFace(e.cullFace),I(e.frontFace)||j(e.frontFace)||this.setFrontFace(e.frontFace),e.depthTest?this.enable(this.gl.DEPTH_TEST):this.disable(this.gl.DEPTH_TEST),I(e.depthMask)||j(e.depthMask)||this.setDepthMask(e.depthMask),I(e.depthWrite)||j(e.depthWrite)||this.setDepthMask(e.depthWrite),I(e.depthFunc)||j(e.depthFunc)||this.setDepthFunc(e.depthFunc),I(e.lineWidth)||j(e.lineWidth)||this.setLineWidth(e.lineWidth),(0,o.Z)(this,He)[He]=Object.assign((0,o.Z)(this,He)[He],e)},n.enable=function(e){!0!==(0,o.Z)(this,He)[He][e]&&(this.gl.enable(e),(0,o.Z)(this,He)[He][e]=!0)},n.disable=function(e){!1!==(0,o.Z)(this,He)[He][e]&&(this.gl.disable(e),(0,o.Z)(this,He)[He][e]=!1)},n.setViewport=function(e,t,n,i){void 0===n&&(n=0),void 0===i&&(i=0),(0,o.Z)(this,He)[He].viewport.width===e&&(0,o.Z)(this,He)[He].viewport.height===t||(this.gl.viewport(n,i,e,t),(0,o.Z)(this,He)[He].viewport={width:e,height:t,x:n,y:i})},n.setMask=function(e){(0,o.Z)(this,He)[He].colorMask!==e&&(this.gl.colorMask(e,e,e,e),(0,o.Z)(this,He)[He].colorMask=e)},n.setBlending=function(e,t){if((0,o.Z)(this,He)[He].blending=e,0!==e)if(this.enable(this.gl.BLEND),2===e)(0,o.Z)(this,He)[He].premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ONE,this.gl.ONE,this.gl.ONE,this.gl.ONE)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE));else if(3===e)(0,o.Z)(this,He)[He].premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE_MINUS_SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR));else if(4===e)(0,o.Z)(this,He)[He].premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.SRC_COLOR,this.gl.ZERO,this.gl.SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ZERO,this.gl.SRC_COLOR));else if(1===e)(0,o.Z)(this,He)[He].premultiplyAlpha?(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)):(this.setBlendEquation(this.gl.FUNC_ADD,this.gl.FUNC_ADD),this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA));else if(5===e){if(null!=t&&t.blendFunc){var n=t.blendFunc,i=n.src,r=n.dst,s=n.srcAlpha,a=n.dstAlpha;this.setBlendFunc(i,r,s,a),this.enable(this.gl.BLEND)}if(null!=t&&t.blendEquation){var l=t.blendEquation,h=l.modeRGB,u=l.modeAlpha;this.setBlendEquation(h,u)}}else console.error("State: Invalid blending: ",e);else this.disable(this.gl.BLEND)},n.setBlendFunc=function(e,t,n,i){var r,s,a,l;e===(null==(r=(0,o.Z)(this,He)[He].blendFunc)?void 0:r.src)&&t===(null==(s=(0,o.Z)(this,He)[He].blendFunc)?void 0:s.dst)&&n===(null==(a=(0,o.Z)(this,He)[He].blendFunc)?void 0:a.srcAlpha)&&i===(null==(l=(0,o.Z)(this,He)[He].blendFunc)?void 0:l.dstAlpha)||((0,o.Z)(this,He)[He].blendFunc={src:e,dst:t,srcAlpha:n,dstAlpha:i},I(n)||j(n)||I(i)||j(i)?this.gl.blendFunc(e,t):this.gl.blendFuncSeparate(e,t,n,i))},n.setBlendEquation=function(e,t){var n,i;e===(null==(n=(0,o.Z)(this,He)[He].blendEquation)?void 0:n.modeRGB)&&t===(null==(i=(0,o.Z)(this,He)[He].blendEquation)?void 0:i.modeAlpha)||((0,o.Z)(this,He)[He].blendEquation={modeRGB:e,modeAlpha:t},I(t)||j(t)?this.gl.blendEquation(e):this.gl.blendEquationSeparate(e,t))},n.setClearAlpha=function(e){(0,o.Z)(this,He)[He].clearAlpha!==e&&((0,o.Z)(this,He)[He].clearAlpha=e)},n.setClearColor=function(e,t){(0,o.Z)(this,He)[He].clearAlpha===t&&(0,o.Z)(this,He)[He].clearColor===e||((0,o.Z)(this,He)[He].clearColor=e,I(t)||j(t)?(0,o.Z)(this,He)[He].clearAlpha=e.a:(0,o.Z)(this,He)[He].clearAlpha=t,this.gl.clearColor(e.r,e.g,e.b,(0,o.Z)(this,He)[He].clearAlpha))},n.setCullFace=function(e){(0,o.Z)(this,He)[He].cullFace!==e&&(e?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),(0,o.Z)(this,He)[He].cullFace=e,this.gl.cullFace(e))},n.setFrontFace=function(e){(0,o.Z)(this,He)[He].frontFace!==e&&((0,o.Z)(this,He)[He].frontFace=e,this.gl.frontFace(e))},n.setDepthMask=function(e){(0,o.Z)(this,He)[He].depthMask!==e&&((0,o.Z)(this,He)[He].depthMask=e,this.gl.depthMask(e))},n.setDepthFunc=function(e){(0,o.Z)(this,He)[He].depthFunc!==e&&((0,o.Z)(this,He)[He].depthFunc=e,this.gl.depthFunc(e))},n.setDepthTest=function(e){(0,o.Z)(this,He)[He].depthTest!==e&&((0,o.Z)(this,He)[He].depthTest=e,e?this.enable(this.gl.DEPTH_TEST):this.disable(this.gl.DEPTH_TEST))},n.setStencilFunc=function(e,t,n,i){var r,s,a,l,h;(null==(r=(0,o.Z)(this,He)[He])||null==(r=r.stencil)||null==(r=r.func)?void 0:r.cmp)===e&&(null==(s=(0,o.Z)(this,He)[He])||null==(s=s.stencil)||null==(s=s.func)?void 0:s.ref)===t&&(null==(a=(0,o.Z)(this,He)[He])||null==(a=a.stencil)||null==(a=a.func)?void 0:a.mask)===n||(null!=(l=(0,o.Z)(this,He)[He])&&l.stencil||((0,o.Z)(this,He)[He].stencil={}),null!=(h=(0,o.Z)(this,He)[He])&&null!=(h=h.stencil)&&h.func||((0,o.Z)(this,He)[He].stencil.func={}),(0,o.Z)(this,He)[He].stencil.func={ref:t,mask:n,cmp:e},i?this.gl.stencilFuncSeparate(i,e,t,n):this.gl.stencilFunc(e,t,n))},n.setStencilOp=function(e,t,n,i){var r,s,a,l,h,u,c,d,f,m,p,v,g;return null!=(r=(0,o.Z)(this,He)[He])&&r.stencil||((0,o.Z)(this,He)[He].stencil={}),i&&i!==this.gl.FRONT_AND_BACK?i===this.gl.FRONT?(null==(d=(0,o.Z)(this,He)[He].stencil)||null==(d=d.opFront)?void 0:d.fail)!==e||(null==(f=(0,o.Z)(this,He)[He].stencil)||null==(f=f.opFront)?void 0:f.zFail)!==t||(null==(m=(0,o.Z)(this,He)[He].stencil)||null==(m=m.opFront)?void 0:m.zPass)!==n:i===this.gl.BACK?(null==(p=(0,o.Z)(this,He)[He].stencil)||null==(p=p.opBack)?void 0:p.fail)!==e||(null==(v=(0,o.Z)(this,He)[He].stencil)||null==(v=v.opBack)?void 0:v.zFail)!==t||(null==(g=(0,o.Z)(this,He)[He].stencil)||null==(g=g.opBack)?void 0:g.zPass)!==n:void 0:(null==(s=(0,o.Z)(this,He)[He].stencil)||null==(s=s.opFront)?void 0:s.fail)!==e||(null==(a=(0,o.Z)(this,He)[He].stencil)||null==(a=a.opFront)?void 0:a.zFail)!==t||(null==(l=(0,o.Z)(this,He)[He].stencil)||null==(l=l.opFront)?void 0:l.zPass)!==n||(null==(h=(0,o.Z)(this,He)[He].stencil)||null==(h=h.opBack)?void 0:h.fail)!==e||(null==(u=(0,o.Z)(this,He)[He].stencil)||null==(u=u.opBack)?void 0:u.zFail)!==t||(null==(c=(0,o.Z)(this,He)[He].stencil)||null==(c=c.opBack)?void 0:c.zPass)!==n},n.setStencilMask=function(e,t){var n;(null==(n=(0,o.Z)(this,He)[He].stencil)?void 0:n.mask)!==e&&((0,o.Z)(this,He)[He].stencil=Object.assign({},(0,o.Z)(this,He)[He].stencil,{mask:e}),t?this.gl.stencilMaskSeparate(t,e):this.gl.stencilMask(e))},n.setActiveTexture=function(e){(0,o.Z)(this,He)[He].activeTextureUnit!==e&&((0,o.Z)(this,He)[He].activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))},n.setLineWidth=function(e){(0,o.Z)(this,He)[He].lineWidth!==e&&((0,o.Z)(this,He)[He].lineWidth=e,this.gl.lineWidth(e))},n.setPolygonOffset=function(e,t,n){e?(this.enable(this.gl.POLYGON_OFFSET_FILL),(0,o.Z)(this,He)[He].polygonOffsetFactor===t&&(0,o.Z)(this,He)[He].polygonOffsetUnits===n||(this.gl.polygonOffset(t,n),(0,o.Z)(this,He)[He].polygonOffsetFactor=t,(0,o.Z)(this,He)[He].polygonOffsetUnits=n)):this.disable(this.gl.POLYGON_OFFSET_FILL)},n.bindFramebuffer=function(e){void 0===e&&(e={});var t=e,n=t.target,i=void 0===n?this.gl.FRAMEBUFFER:n,r=t.buffer,s=void 0===r?null:r;(0,o.Z)(this,He)[He].framebuffer!==s&&((0,o.Z)(this,He)[He].framebuffer=s,this.gl.bindFramebuffer(i,s))},n.setActiveGeometry=function(e){(0,o.Z)(this,He)[He].activeGeometryId=e},n.reset=function(e){var t=this;void 0===e&&(e=!0);var n=Object.keys((0,o.Z)(this,He)[He]);e?(n.filter((function(e){return["viewport","premultiplyAlpha"].indexOf(e)<0})).forEach((function(e){delete(0,o.Z)(t,He)[He][e]})),this.bindFramebuffer({buffer:null}),this.apply({frontFace:this.gl.CCW,depthTest:!1,depthWrite:!0,depthMask:!0,depthFunc:this.gl.LESS,blending:1,blendFunc:{src:this.gl.ONE,dst:this.gl.ZERO},blendEquation:{modeRGB:this.gl.FUNC_ADD},premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,framebuffer:null,textureUnits:[],activeTextureUnit:-1,activeGeometryId:-1,currentProgramId:-1,clearAlpha:1,clearColor:new Te(0),stencil:{func:{},opFront:{},opBack:{}}})):(n.filter((function(e){return["flipY","framebuffer","textureUnits","activeTextureUnit","activeGeometryId","currentProgramId"].indexOf(e)>-1})).forEach((function(e){delete(0,o.Z)(t,He)[He][e]})),this.bindFramebuffer({buffer:null}),(0,o.Z)(this,He)[He].flipY=!1,(0,o.Z)(this,He)[He].activeGeometryId=-1,(0,o.Z)(this,He)[He].activeTextureUnit=-1,(0,o.Z)(this,He)[He].currentProgramId=-1,(0,o.Z)(this,He)[He].textureUnits=[],(0,o.Z)(this,He)[He].boundBuffer=null)},(0,a.Z)(t,[{key:"state",get:function(){return(0,o.Z)(this,He)[He]}},{key:"viewport",get:function(){return(0,o.Z)(this,He)[He].viewport}},{key:"textureUnits",get:function(){return(0,o.Z)(this,He)[He].textureUnits}},{key:"activeTextureUnit",get:function(){return(0,o.Z)(this,He)[He].activeTextureUnit},set:function(e){(0,o.Z)(this,He)[He].activeTextureUnit=e}},{key:"currentProgramId",get:function(){return(0,o.Z)(this,He)[He].currentProgramId},set:function(e){(0,o.Z)(this,He)[He].currentProgramId=e}},{key:"activeGeometryId",get:function(){return(0,o.Z)(this,He)[He].activeGeometryId},set:function(e){(0,o.Z)(this,He)[He].activeGeometryId=e}},{key:"flipY",get:function(){return(0,o.Z)(this,He)[He].flipY},set:function(e){(0,o.Z)(this,He)[He].flipY=e}},{key:"unpackAlignment",get:function(){return(0,o.Z)(this,He)[He].unpackAlignment},set:function(e){(0,o.Z)(this,He)[He].unpackAlignment=e}},{key:"premultiplyAlpha",get:function(){return(0,o.Z)(this,He)[He].premultiplyAlpha},set:function(e){(0,o.Z)(this,He)[He].premultiplyAlpha=e}},{key:"boundBuffer",get:function(){return(0,o.Z)(this,He)[He].boundBuffer},set:function(e){(0,o.Z)(this,He)[He].boundBuffer=e}},{key:"anisotropy",get:function(){return(0,o.Z)(this,He)[He].anisotropy},set:function(e){(0,o.Z)(this,He)[He].anisotropy=e}}]),t}(_e),Xe=["WEBGL_depth_texture","OES_texture_half_float","OES_texture_float","OES_standard_derivatives","OES_element_index_uint","EXT_frag_depth","EXT_blend_minmax","EXT_shader_texture_lod","WEBGL_draw_buffers","WEBGL_color_buffer_float"],Ye=["EXT_color_buffer_float"],Ke=["WEBGL_lose_context","OES_texture_half_float_linear","OES_texture_float_linear","EXT_color_buffer_half_float","WEBGL_debug_renderer_info","EXT_texture_filter_anisotropic"],Je=(0,l.Z)("gl"),$e=(0,l.Z)("state"),Qe=(0,l.Z)("extensions"),et=(0,l.Z)("autoClear"),tt=(0,l.Z)("depth"),nt=(0,l.Z)("alpha"),it=(0,l.Z)("stencil"),rt=(0,l.Z)("antialias"),st=(0,l.Z)("premultipliedAlpha"),at=(0,l.Z)("preserveDrawingBuffer"),ot=(0,l.Z)("color"),lt=(0,l.Z)("dpr"),ht=(0,l.Z)("frustumCull"),ut=function(){function e(e,t){var n,i,r,s=this;void 0===t&&(t={}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,$e,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),Object.defineProperty(this,nt,{writable:!0,value:void 0}),Object.defineProperty(this,it,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,st,{writable:!0,value:void 0}),Object.defineProperty(this,at,{writable:!0,value:void 0}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),Object.defineProperty(this,lt,{writable:!0,value:void 0}),Object.defineProperty(this,ht,{writable:!0,value:void 0}),this.vertexAttribDivisor=void 0,this.drawArraysInstanced=void 0,this.drawElementsInstanced=void 0,this.createVertexArray=void 0,this.bindVertexArray=void 0,this.deleteVertexArray=void 0,this.width=void 0,this.height=void 0;var a=Object.assign({},{autoClear:!0,depth:!0,alpha:!1,stencil:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,requestWebGl2:!0,extensions:[]},t);(0,o.Z)(this,et)[et]=Boolean(a.autoClear),(0,o.Z)(this,tt)[tt]=a.depth,(0,o.Z)(this,nt)[nt]=a.alpha,(0,o.Z)(this,it)[it]=a.stencil,(0,o.Z)(this,rt)[rt]=a.antialias,(0,o.Z)(this,st)[st]=a.premultipliedAlpha,(0,o.Z)(this,at)[at]=a.preserveDrawingBuffer,(0,o.Z)(this,Je)[Je]=C(e)||F(e)?e:P(e,{alpha:(0,o.Z)(this,nt)[nt],depth:(0,o.Z)(this,tt)[tt],stencil:(0,o.Z)(this,it)[it],antialias:(0,o.Z)(this,rt)[rt],powerPreference:a.powerPreference,premultipliedAlpha:(0,o.Z)(this,st)[st],preserveDrawingBuffer:(0,o.Z)(this,at)[at]},a.requestWebGl2);var l=null==(n=(0,o.Z)(this,Je)[Je])?void 0:n.getContextAttributes(),h=null==(i=(0,o.Z)(this,Je)[Je])?void 0:i.getParameter((0,o.Z)(this,Je)[Je].VIEWPORT),u=null==(r=(0,o.Z)(this,Je)[Je])?void 0:r.getParameter((0,o.Z)(this,Je)[Je].UNPACK_FLIP_Y_WEBGL);(0,o.Z)(this,$e)[$e]=new qe(this),l&&((0,o.Z)(this,tt)[tt]=Boolean(l.depth),(0,o.Z)(this,rt)[rt]=Boolean(l.antialias),(0,o.Z)(this,nt)[nt]=Boolean(l.alpha),(0,o.Z)(this,it)[it]=Boolean(l.stencil),(0,o.Z)(this,st)[st]=Boolean(l.premultipliedAlpha),(0,o.Z)(this,at)[at]=Boolean(l.preserveDrawingBuffer)),(0,o.Z)(this,$e)[$e].flipY=Boolean(u),(0,o.Z)(this,$e)[$e].setViewport(h[2],h[3],h[0],h[1]),(0,o.Z)(this,$e)[$e].premultiplyAlpha=(0,o.Z)(this,st)[st],(0,o.Z)(this,ot)[ot]=!0,(0,o.Z)(this,lt)[lt]=a.dpr||1,this.width=this.gl.canvas.width/(0,o.Z)(this,lt)[lt],this.height=this.gl.canvas.height/(0,o.Z)(this,lt)[lt],(0,o.Z)(this,ht)[ht]=!!a.frustumCull,(0,o.Z)(this,Qe)[Qe]={},this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),a.extensions&&(a.extensions.filter((function(e){return Xe.findIndex((function(t){return t===e}))>-1})).forEach((function(e){(0,o.Z)(s,Qe)[Qe][e]||s.isWebGL2||((0,o.Z)(s,Qe)[Qe][e]=s.gl.getExtension(e))})),a.extensions.filter((function(e){return Ye.findIndex((function(t){return t===e}))>-1})).forEach((function(e){!(0,o.Z)(s,Qe)[Qe][e]&&s.isWebGL2&&((0,o.Z)(s,Qe)[Qe][e]=s.gl.getExtension(e))})),a.extensions.filter((function(e){return Ke.findIndex((function(t){return t===e}))>-1})).forEach((function(e){(0,o.Z)(s,Qe)[Qe][e]||((0,o.Z)(s,Qe)[Qe][e]=s.gl.getExtension(e))})))}var t=e.prototype;return t.extension=function(e){return(0,o.Z)(this,Qe)[Qe][e]},t.setSize=function(e,t){this.width=e,this.height=t,this.gl.canvas.width=e*(0,o.Z)(this,lt)[lt],this.gl.canvas.height=t*(0,o.Z)(this,lt)[lt]},t.setViewport=function(e,t,n,i){void 0===n&&(n=0),void 0===i&&(i=0),(0,o.Z)(this,$e)[$e].setViewport(e,t,n,i)},t.getExtension=function(e,t,n){var i=this.gl[t];if(t&&i)return i.bind(this.gl);(0,o.Z)(this,Qe)[Qe][e]||((0,o.Z)(this,Qe)[Qe][e]=this.gl.getExtension(e));var r=(0,o.Z)(this,Qe)[Qe][e];return t?r?r[n].bind(r):null:r},t.getRenderList=function(e){var t=this,n=e.scene,i=e.camera,r=[];return n.traverse((function(e){if(!e.visible)return!0;e.draw&&((0,o.Z)(t,ht)[ht]&&e.frustumCulled&&i&&!i.frustumIntersectsMesh(e)||r.push(e))})),r},t.render=function(e){var t=e.scene,n=e.camera,i=e.target,r=void 0===i?null:i,s=e.update,a=void 0===s||s,l=e.clear;null===r?((0,o.Z)(this,$e)[$e].bindFramebuffer({buffer:null}),this.setViewport(this.width*(0,o.Z)(this,lt)[lt],this.height*(0,o.Z)(this,lt)[lt])):(r.bind(),this.setViewport(r.width,r.height)),(l||(0,o.Z)(this,et)[et]&&!1!==l)&&(!(0,o.Z)(this,tt)[tt]||r&&!r.depth||((0,o.Z)(this,$e)[$e].enable(this.gl.DEPTH_TEST),(0,o.Z)(this,$e)[$e].setDepthMask(!0)),this.clear((0,o.Z)(this,ot)[ot],(0,o.Z)(this,tt)[tt],(0,o.Z)(this,it)[it])),a&&t.updateMatrixWorld(),n&&n.updateMatrixWorld();for(var h=this.getRenderList({scene:t,camera:n}),u=0,c=h.length;u<c;u++){h[u].draw({camera:n})}r&&r.unbind()},t.clear=function(e,t,n){void 0===e&&(e=(0,o.Z)(this,ot)[ot]),void 0===t&&(t=(0,o.Z)(this,tt)[tt]),void 0===n&&(n=(0,o.Z)(this,it)[it]);var i=0;e&&(i|=this.gl.COLOR_BUFFER_BIT),t&&(i|=this.gl.DEPTH_BUFFER_BIT),n&&(i|=this.gl.STENCIL_BUFFER_BIT),this.gl.clear(i)},t.resetState=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=null),(0,o.Z)(this,$e)[$e].reset(e),this.bindVertexArray(t)},(0,a.Z)(e,[{key:"gl",get:function(){return(0,o.Z)(this,Je)[Je]}},{key:"attributes",get:function(){return{dpr:(0,o.Z)(this,lt)[lt],flipY:(0,o.Z)(this,$e)[$e].flipY,depth:(0,o.Z)(this,tt)[tt],color:(0,o.Z)(this,ot)[ot],antialias:(0,o.Z)(this,rt)[rt],alpha:(0,o.Z)(this,nt)[nt],stencil:(0,o.Z)(this,it)[it],autoClear:(0,o.Z)(this,et)[et],frustumCull:(0,o.Z)(this,ht)[ht],premultipliedAlpha:(0,o.Z)(this,st)[st],preserveDrawingBuffer:(0,o.Z)(this,at)[at]}}},{key:"canvas",get:function(){return(0,o.Z)(this,Je)[Je].canvas}},{key:"isWebGL",get:function(){return C(this.gl)}},{key:"isWebGL2",get:function(){return F(this.gl)}},{key:"extensions",get:function(){return(0,o.Z)(this,Qe)[Qe]}},{key:"size",get:function(){return{width:"clientWidth"in this.canvas?this.canvas.clientWidth:this.canvas.width,height:"clientHeight"in this.canvas?this.canvas.clientHeight:this.canvas.height}}},{key:"state",get:function(){return(0,o.Z)(this,$e)[$e]}},{key:"premultipliedAlpha",get:function(){return(0,o.Z)(this,st)[st]}}]),e}(),ct="Resource subclass must define virtual methods",dt=(0,l.Z)("handle"),ft=(0,l.Z)("lastHandle"),mt=function(e){function t(t,n){var i,s,a,l,h;return void 0===n&&(n={}),h=e.call(this,t)||this,Object.defineProperty((0,r.Z)(h),dt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(h),ft,{writable:!0,value:void 0}),h.id=void 0,h.name=void 0,h.userData=void 0,h.byteLength=void 0,h.options=void 0,h.id=(null==(i=n)?void 0:i.id)||z(h.constructor.name),h.name=null==(s=n)?void 0:s.name,h.userData=null==(a=n)?void 0:a.userData,(0,o.Z)((0,r.Z)(h),dt)[dt]=null==(l=n)?void 0:l.handle,h.options=n,void 0===(0,o.Z)((0,r.Z)(h),dt)[dt]&&((0,o.Z)((0,r.Z)(h),dt)[dt]=h.createHandle()),h.byteLength=0,h}(0,s.Z)(t,e);var n=t.prototype;return n.swapHandle=function(e){(0,o.Z)(this,ft)[ft]=(0,o.Z)(this,dt)[dt],(0,o.Z)(this,dt)[dt]=e},n.restoreHandle=function(){(0,o.Z)(this,dt)[dt]=(0,o.Z)(this,ft)[ft]},n.destroy=function(){this.delete()},n.delete=function(e){var t=(void 0===e?{}:e).deleteChildren,n=void 0!==t&&t,i=this.handle&&this.deleteHandle(this.handle);return this.handle&&this.removeStats(),(0,o.Z)(this,dt)[dt]=null,i&&n&&i.filter(Boolean).forEach((function(e){return e.delete()})),this},n.bind=function(e){throw void 0===e&&(e=this.handle),new Error(ct)},n.unbind=function(){this.bind(null)},n.removeStats=function(){throw new Error(ct)},n.createHandle=function(){throw new Error(ct)},n.deleteHandle=function(){throw new Error(ct)},n.toString=function(){return this.constructor.name+"("+this.id+")"},(0,a.Z)(t,[{key:"handle",get:function(){return(0,o.Z)(this,dt)[dt]}}]),t}(_e),pt=(0,l.Z)("internalFormat"),vt=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,Object.assign({},n,{format:n.format||t.gl.DEPTH_COMPONENT16}))||this).width=void 0,i.height=void 0,Object.defineProperty((0,r.Z)(i),pt,{writable:!0,value:void 0}),(0,o.Z)((0,r.Z)(i),pt)[pt]=i.options.format,i.width=i.options.width,i.height=i.options.height,console.assert(i.width>0&&i.height>0,"Renderbuffer object requires valid width and height greater than zero"),i.bind(),t.gl.renderbufferStorage(t.gl.RENDERBUFFER,(0,o.Z)((0,r.Z)(i),pt)[pt],i.width,i.height),i}(0,s.Z)(t,e);var n=t.prototype;return n.resize=function(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.bind(),this.gl.renderbufferStorage(this.gl.RENDERBUFFER,(0,o.Z)(this,pt)[pt],e,t),this.unbind())},n.bind=function(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,this.handle)},n.unbind=function(){this.gl.bindRenderbuffer(this.gl.RENDERBUFFER,null)},n.removeStats=function(){},n.destroy=function(){this.unbind(),this.deleteHandle()},n.createHandle=function(){return this.gl.createRenderbuffer()},n.deleteHandle=function(){this.handle&&this.gl.deleteRenderbuffer(this.handle)},t}(mt),gt=new Uint8Array(4),bt=(0,l.Z)("state"),yt=function(e){function t(t,n,i){var s;void 0===n&&(n={}),void 0===i&&(i=!0);var a=t.gl,l={target:a.TEXTURE_2D,type:a.UNSIGNED_BYTE,format:a.RGBA,internalFormat:n.format||a.RGBA,wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,generateMipmaps:!0,minFilter:a.LINEAR,magFilter:a.LINEAR,premultiplyAlpha:!1,unpackAlignment:4,anisotropy:0,flipY:!1,level:0},h=Object.assign({},l,n);return(s=e.call(this,t,h)||this).needsUpdate=!1,s.textureUnit=0,s.image=void 0,s.width=void 0,s.height=void 0,s.target=void 0,Object.defineProperty((0,r.Z)(s),bt,{writable:!0,value:{}}),s.textureUnit=0,s.image=s.options.image,s.width=s.options.width,s.height=s.options.height,s.target=s.options.target,(0,o.Z)((0,r.Z)(s),bt)[bt].version=-1,s.needsUpdate=Boolean(i),s.needsUpdate&&s.update(),s}(0,s.Z)(t,e);var n=t.prototype;return n.setData=function(e,t,n){void 0===t&&(t=this.width),void 0===n&&(n=this.height),this.image=e,this.width=t,this.height=n,this.needsUpdate=!0},n.setOptions=function(e){this.options=Object.assign(this.options,e),this.width=this.options.width,this.height=this.options.height,this.needsUpdate=!0},n.fromSrc=function(e){var t=this;return new Promise((function(n,i){var r=new Image;r.onload=function(){t.setData(r,r.width,r.height),n(t)},r.onerror=function(e){i(e)},r.crossOrigin="*",r.src=e}))},n.update=function(e){void 0===e&&(e=0);var t=!(this.image===(0,o.Z)(this,bt)[bt].image&&!this.needsUpdate);if((t||this.rendererState.textureUnits[e]!==this.id||this.rendererState.activeTextureUnit!==e)&&(this.rendererState.setActiveTexture(e),this.bind(e)),t){if(this.needsUpdate=!1,this.options.wrapS!==(0,o.Z)(this,bt)[bt].wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.options.wrapS),(0,o.Z)(this,bt)[bt].wrapS=this.options.wrapS),this.options.wrapT!==(0,o.Z)(this,bt)[bt].wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.options.wrapT),(0,o.Z)(this,bt)[bt].wrapT=this.options.wrapT),this.options.minFilter!==(0,o.Z)(this,bt)[bt].minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.options.minFilter),(0,o.Z)(this,bt)[bt].minFilter=this.options.minFilter),this.options.magFilter!==(0,o.Z)(this,bt)[bt].magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.options.magFilter),(0,o.Z)(this,bt)[bt].magFilter=this.options.magFilter),this.options.flipY!==this.rendererState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.options.flipY),this.rendererState.flipY=this.options.flipY),this.options.premultiplyAlpha!==this.rendererState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),this.rendererState.premultiplyAlpha=this.options.premultiplyAlpha),this.options.unpackAlignment!==this.rendererState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.options.unpackAlignment),this.rendererState.unpackAlignment=this.options.unpackAlignment),this.options.anisotropy&&this.options.anisotropy!==this.rendererState.anisotropy){var n=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(n){var i=this.gl.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT),r=this.options.anisotropy;this.options.anisotropy>i&&(r=i,console.warn("[Texture]: Texture.anisotropy option exceeded the maximum allowed value "+i+" of the device")),this.gl.texParameterf(this.target,n.TEXTURE_MAX_ANISOTROPY_EXT,r)}this.rendererState.anisotropy=this.options.anisotropy}this.image?(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.renderer.isWebGL2&&B(this.options.offset)?this.gl.texImage2D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,this.image,this.options.offset):ArrayBuffer.isView(this.image)?this.gl.texImage2D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,this.image):this.gl.texImage2D(this.target,this.options.level,this.options.internalFormat,this.options.format,this.options.type,this.image),this.options.generateMipmaps&&(this.renderer.isWebGL2||T(this.image.width)&&T(this.image.height)?this.gl.generateMipmap(this.target):(this.options.generateMipmaps=!1,this.options.wrapS=this.gl.CLAMP_TO_EDGE,this.options.wrapT=this.options.wrapS,this.options.minFilter=this.gl.LINEAR))):this.renderer.isWebGL2&&B(this.options.offset)?this.width>0?this.gl.texImage2D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,this.options.offset):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,gt,this.options.offset):this.width>0?this.gl.texImage2D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null):this.gl.texImage2D(this.target,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,gt),(0,o.Z)(this,bt)[bt].image=this.image,(0,o.Z)(this,bt)[bt].version+=1}},n.bind=function(e){void 0===e&&(e=this.textureUnit),this.rendererState.textureUnits[this.rendererState.activeTextureUnit]!==this.id&&(this.textureUnit=e,this.rendererState.textureUnits[this.textureUnit]=this.id,this.gl.bindTexture(this.target,this.handle))},n.unbind=function(){this.gl.activeTexture(this.gl.TEXTURE0+this.textureUnit),this.gl.bindTexture(this.target,null),delete this.rendererState.textureUnits[this.textureUnit]},n.destroy=function(){this.unbind(),e.prototype.destroy.call(this)},n.removeStats=function(){(0,o.Z)(this,bt)[bt]={version:-1}},n.createHandle=function(){return this.gl.createTexture()},n.deleteHandle=function(){this.handle&&this.gl.deleteTexture(this.handle)},n.toString=function(){return"Texture("+this.id+","+this.width+"x"+this.height+")"},t}(mt),xt=function(e){function t(t,n){var i;return void 0===n&&(n={}),(i=e.call(this,t,Object.assign({},n,{image:n.data,premultiplyAlpha:!0,flipY:!1,unpackAlignment:1}))||this).needsUpdate=!0,i}return(0,s.Z)(t,e),t}(yt),wt=(0,l.Z)("textures"),Zt=(0,l.Z)("renderBuffers"),Et=(0,l.Z)("clearColors"),At=(0,l.Z)("clearDepth"),Mt=(0,l.Z)("clearStencil"),Tt=function(e){function t(t,n){var i;void 0===n&&(n={}),i=e.call(this,t,Object.assign({color:1,depth:!0,depthTexture:!1,stencil:!1},n))||this,Object.defineProperty((0,r.Z)(i),wt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Zt,{writable:!0,value:void 0}),i.depth=void 0,i.width=void 0,i.height=void 0,i.viewport=void 0,i.drawBuffersChanged=void 0,i.drawBuffers=void 0,Object.defineProperty((0,r.Z)(i),Et,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),At,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Mt,{writable:!0,value:void 0}),(0,o.Z)((0,r.Z)(i),Zt)[Zt]=new Map,(0,o.Z)((0,r.Z)(i),wt)[wt]=new Map,i.depth=Boolean(n.depth),i.drawBuffers=[],i.drawBuffersChanged=!1,i.width=i.options.width,i.height=i.options.height,i.viewport=new ge(0,0,i.width,i.height),i.name=i.options.name;var s=i.options.attachments||[];if(0===s.length){for(var a=0;a<i.options.color;a++){var l=Object.assign({wrapS:i.gl.CLAMP_TO_EDGE,wrapT:i.gl.CLAMP_TO_EDGE,minFilter:i.gl.LINEAR,magFilter:i.gl.LINEAR,type:i.gl.UNSIGNED_BYTE,format:i.gl.RGBA,flipY:!1,generateMipmaps:!1},n),h=void 0;h=l.data?new xt(t,l):new yt(t,V(l,["data","name","attachments","depthTexture"])),s.push([i.gl.COLOR_ATTACHMENT0+a,h])}if(n.depthTexture&&(t.isWebGL2||!t.isWebGL2&&t.gl.getExtension("WEBGL_depth_texture"))){var u=new yt(t,{width:i.width,height:i.height,minFilter:i.gl.NEAREST,magFilter:i.gl.NEAREST,format:i.gl.DEPTH_COMPONENT,internalFormat:t.isWebGL2?i.gl.DEPTH_COMPONENT16:i.gl.DEPTH_COMPONENT,type:i.gl.UNSIGNED_INT});s.push([i.gl.DEPTH_ATTACHMENT,u])}else{var c=n,d=c.depth,f=c.stencil;if(d&&!f){var m=new vt(t,{format:i.gl.DEPTH_COMPONENT16,width:i.width,height:i.height});s.push([i.gl.DEPTH_ATTACHMENT,m])}else if(f&&!d){var p=new vt(t,{format:i.gl.STENCIL_INDEX8,width:i.width,height:i.height});s.push([i.gl.STENCIL_ATTACHMENT,p])}else if(d&&f){var v=new vt(t,{format:i.gl.DEPTH_STENCIL,width:i.width,height:i.height});s.push([i.gl.DEPTH_STENCIL_ATTACHMENT,v])}}}return i.create(s),i}(0,s.Z)(t,e);var n=t.prototype;return n.create=function(e){var t=this;(0,o.Z)(this,Et)[Et]=[],(0,o.Z)(this,At)[At]=1,(0,o.Z)(this,Mt)[Mt]=0;for(var n,r=(0,i.Z)(e);!(n=r()).done;){var s=n.value,a=s[0],l=s[1];l instanceof vt?(0,o.Z)(this,Zt)[Zt].set(a,l):l instanceof yt&&((0,o.Z)(this,wt)[wt].set(a,l),this.drawBuffers.push(a));var h=a-this.gl.COLOR_ATTACHMENT0;(0,o.Z)(this,Et)[Et][h]=[0,0,0,0]}if(this.options.color>1)if(this.renderer.isWebGL2)this.gl.drawBuffers(this.drawBuffers);else{var u=this.renderer.extension("WEBGL_draw_buffers");if(!u||!u.drawBuffersWEBGL)throw new Error("Please open the corresponding extension [WEBGL_draw_buffers](https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_draw_buffers#browser_compatibility) and check whether the browser supports it");u.drawBuffersWEBGL(this.drawBuffers)}this.drawBuffersChanged=!0,this.bind(),(0,o.Z)(this,Zt)[Zt].forEach((function(e,n){t.gl.framebufferRenderbuffer(t.gl.FRAMEBUFFER,n,t.gl.RENDERBUFFER,e.handle)})),(0,o.Z)(this,wt)[wt].forEach((function(e,n){t.gl.framebufferTexture2D(t.gl.FRAMEBUFFER,n,t.gl.TEXTURE_2D,e.handle,0)})),this.unbind();var c=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER);if(c!==this.gl.FRAMEBUFFER_COMPLETE)switch(c){case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("The attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete");case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("There is no attachment");case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error(" Height and width of the attachment are not the same.");case this.gl.FRAMEBUFFER_UNSUPPORTED:throw new Error("The format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer")}return this.handle},n.clear=function(){this.bind();var e=0;if(this.clearColors[0]){var t=this.clearColors[0];this.gl.clearColor(t[0],t[1],t[2],t[3]),e|=this.gl.COLOR_BUFFER_BIT}B((0,o.Z)(this,At)[At])&&(this.gl.clearDepth((0,o.Z)(this,At)[At]),e|=this.gl.DEPTH_BUFFER_BIT),B((0,o.Z)(this,Mt)[Mt])&&(this.gl.clearStencil((0,o.Z)(this,Mt)[Mt]),e|=this.gl.STENCIL_BUFFER_BIT),this.gl.clear(e),this.unbind()},n.getTexture=function(e){return(0,o.Z)(this,wt)[wt].get(e)},n.resize=function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,(0,o.Z)(this,wt)[wt].forEach((function(n){n.width===e&&n.height===t||(n.width=e,n.height=t,n.needsUpdate=!0,n.update())})),(0,o.Z)(this,Zt)[Zt].forEach((function(n){n.resize(e,t)})),this.viewport.set(0,0,e,t))},n.bind=function(e){void 0===e&&(e=this.gl.FRAMEBUFFER),this.gl.bindFramebuffer(e,this.handle)},n.unbind=function(e){void 0===e&&(e=this.gl.FRAMEBUFFER),this.gl.bindFramebuffer(e,null)},n.removeStats=function(){},n.destroy=function(){(0,o.Z)(this,wt)[wt].forEach((function(e){e.destroy()})),(0,o.Z)(this,Zt)[Zt].forEach((function(e){e.destroy()})),this.deleteHandle()},n.createHandle=function(){return this.gl.createFramebuffer()},n.deleteHandle=function(){this.handle&&this.gl.deleteFramebuffer(this.handle)},n.toString=function(){return"RenderTarget("+this.id+","+this.width+"x"+this.height+")"},(0,a.Z)(t,[{key:"texture",get:function(){return(0,o.Z)(this,wt)[wt].values().next().value}},{key:"clearColors",get:function(){return(0,o.Z)(this,Et)[Et]},set:function(e){(0,o.Z)(this,Et)[Et]=e}},{key:"clearDepth",get:function(){return(0,o.Z)(this,At)[At]},set:function(e){(0,o.Z)(this,At)[At]=e}},{key:"clearStencil",get:function(){return(0,o.Z)(this,Mt)[Mt]},set:function(e){(0,o.Z)(this,Mt)[Mt]=e}}]),t}(mt);function St(e,t,n,i,r,s,a,o,l,h,u,c,d,f,m,p){void 0===r&&(r=1),void 0===s&&(s=1),void 0===a&&(a=0),void 0===o&&(o=1),void 0===l&&(l=1),void 0===h&&(h=0),void 0===u&&(u=1),void 0===c&&(c=2),void 0===d&&(d=1),void 0===f&&(f=-1),void 0===m&&(m=0),void 0===p&&(p=0);for(var v=m,g=r/2,b=s/2,y=a/2,x=Math.floor(o),w=Math.floor(l),Z=x+1,E=w+1,A=r/x,M=s/w,T=0;T<E;T++)for(var S=T*M-b,R=0;R<Z;R++)if(e[3*m+h]=(R*A-g)*d,e[3*m+u]=S*f,e[3*m+c]=y,t[3*m+h]=0,t[3*m+u]=0,t[3*m+c]=a>=0?1:-1,n[2*m]=R/x,n[2*m+1]=1-T/w,m++,T!==w&&R!==x){var _=v+R+Z*T,C=v+R+Z*(T+1),F=v+R+1+Z*(T+1),P=v+R+1+Z*T;i[6*p]=_,i[6*p+1]=C,i[6*p+2]=P,i[6*p+3]=C,i[6*p+4]=F,i[6*p+5]=P,p++}}var Rt=function(e){function t(t,n){var i=void 0===n?{}:n,r=i.width,s=void 0===r?1:r,a=i.height,o=void 0===a?1:a,l=i.widthSegments,h=void 0===l?1:l,u=i.heightSegments,c=void 0===u?1:u,d=i.attributes,f=void 0===d?{}:d,m=Math.floor(h),p=Math.floor(c),v=(m+1)*(p+1),g=m*p*6,b=new Float32Array(3*v),y=new Float32Array(3*v),x=new Float32Array(2*v),w=v>65536?new Uint32Array(g):new Uint16Array(g);return St(b,y,x,w,s,o,0,h,c),e.call(this,t,Object.assign({},f,{position:{size:3,data:b},normal:{size:3,data:y},uv:{size:2,data:x},index:{data:w}}))||this}return(0,s.Z)(t,e),t}(Ie),_t=function(e){function t(t,n){var i=void 0===n?{}:n,r=i.width,s=void 0===r?1:r,a=i.height,o=void 0===a?1:a,l=i.depth,h=void 0===l?1:l,u=i.widthSegments,c=void 0===u?1:u,d=i.heightSegments,f=void 0===d?1:d,m=i.depthSegments,p=void 0===m?1:m,v=i.attributes,g=void 0===v?{}:v,b=Math.floor(c),y=Math.floor(f),x=Math.floor(p),w=b+1,Z=y+1,E=x+1,A=w*Z*2+w*E*2+Z*E*2,M=6*(b*y*2+b*x*2+y*x*2),T=new Float32Array(3*A),S=new Float32Array(3*A),R=new Float32Array(2*A),_=A>65536?new Uint32Array(M):new Uint16Array(M),C=0,F=0,P=E*Z,O=w*E,L=w*Z,N=x*y,I=b*x,k=b*y;return St(T,S,R,_,h,o,s,p,f,2,1,0,-1,-1,C,F),St(T,S,R,_,h,o,-s,p,f,2,1,0,1,-1,C+=P,F+=N),St(T,S,R,_,s,h,o,p,c,0,2,1,1,1,C+=P,F+=N),St(T,S,R,_,s,h,-o,p,c,0,2,1,1,-1,C+=O,F+=I),St(T,S,R,_,s,o,-h,c,f,0,1,2,-1,-1,C+=O,F+=I),St(T,S,R,_,s,o,h,c,f,0,1,2,1,-1,C+=L,F+=k),e.call(this,t,Object.assign({},g,{position:{size:3,data:T},normal:{size:3,data:S},uv:{size:2,data:R},index:{data:_}}))||this}return(0,s.Z)(t,e),t}(Ie),Ct={};function Ft(e){void 0===e&&(e="id"),Ct[e]=Ct[e]||1;var t=Ct[e];return Ct[e]+=1,"".concat(e,"-").concat(t)}var Pt=function(e,t){switch(t){case e.VERTEX_SHADER:return"vertex-shader";case e.FRAGMENT_SHADER:return"fragment-shader";default:return"unknown"}};var Ot=(0,l.Z)("shaderType"),Lt=(0,l.Z)("includes"),Nt=function(e){function t(t,n,i,s){var a;void 0===s&&(s={});var l=function(e,t){switch(t){case"fragment":return e.FRAGMENT_SHADER;case"vertex":return e.VERTEX_SHADER;default:return}}(t.gl,i);return a=e.call(this,t,{name:b(n)||Ft(Pt(t,l))})||this,Object.defineProperty((0,r.Z)(a),Ot,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(a),Lt,{writable:!0,value:void 0}),a.sourceCode=void 0,console.assert("string"==typeof n,"Shader: GLSL source code must be a JavaScript string"),(0,o.Z)((0,r.Z)(a),Lt)[Lt]=s,(0,o.Z)((0,r.Z)(a),Ot)[Ot]=l,a.sourceCode=a.injectShaderModule(n,s||{}).replace(/\n\n+/gm,"\n\n"),a.createShader(a.sourceCode),a}(0,s.Z)(t,e);var n=t.prototype;return n.injectShaderModule=function(e,t){var n=this;void 0===t&&(t={});return e.replace(/^[\t ]*#glsl_include +<([\w.]+)>/gm,(function(e,i){var r=t[i];if(void 0===r)throw new Error("Cannot resolve #include <".concat(i,">"));return r=r.replace(/#include </g,"#glsl_include <"),n.injectShaderModule(r,t)}))},n.createShader=function(e){void 0===e&&(e=this.source);var t=e.replace(/#include </g,"#glsl_include <");if(t=this.injectShaderModule(t,(0,o.Z)(this,Lt)[Lt]||{}).replace(/\n\n+/gm,"\n\n"),this.gl.shaderSource(this.handle,t),this.gl.compileShader(this.handle),!this.gl.getShaderParameter(this.handle,this.gl.COMPILE_STATUS)){var n=this.gl.getShaderInfoLog(this.handle)||"";throw this.gl.deleteShader(this.handle),new Error(this.toString()+"\n"+n+"\n"+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(t))}},n.getSource=function(){return this.gl.getShaderSource(this.handle)},n.setSource=function(e){var t=b(e);t&&(this.name=Ft(t)),this.createShader(e)},n.removeStats=function(){},n.deleteHandle=function(){this.gl.deleteShader(this.handle)},n.toString=function(){return Pt(this.gl,this.shaderType)+":"+this.id},(0,a.Z)(t,[{key:"source",get:function(){return this.sourceCode}},{key:"shaderType",get:function(){return(0,o.Z)(this,Ot)[Ot]}}]),t}(mt),It=function(e){function t(t,n,i){return e.call(this,t,n,"vertex",i)||this}return(0,s.Z)(t,e),t.prototype.createHandle=function(){return this.gl.createShader(this.gl.VERTEX_SHADER)},t}(Nt),kt=function(e){function t(t,n,i){return e.call(this,t,n,"fragment",i)||this}return(0,s.Z)(t,e),t.prototype.createHandle=function(){return this.gl.createShader(this.gl.FRAGMENT_SHADER)},t}(Nt),Bt={};function Ut(e,t,n,i){var r=(i=i.length?function(e){var t=e.length,n=e[0].length;if(void 0===n)return e;var i=t*n,r=Bt[i];r||(Bt[i]=r=new Float32Array(i));for(var s=0;s<t;s++)r.set(e[s],s*n);return r}(i):i).length;switch(t){case WebGLRenderingContext.FLOAT:return r?e.uniform1fv(n,i):e.uniform1f(n,i);case WebGLRenderingContext.FLOAT_VEC2:return e.uniform2fv(n,i);case WebGLRenderingContext.FLOAT_VEC3:return e.uniform3fv(n,i);case WebGLRenderingContext.FLOAT_VEC4:return e.uniform4fv(n,i);case WebGLRenderingContext.BOOL:case WebGLRenderingContext.INT:case WebGLRenderingContext.SAMPLER_2D:case WebGLRenderingContext.SAMPLER_CUBE:return r?e.uniform1iv(n,i):e.uniform1i(n,i);case WebGLRenderingContext.BOOL_VEC2:case WebGLRenderingContext.INT_VEC2:return e.uniform2iv(n,i);case WebGLRenderingContext.BOOL_VEC3:case WebGLRenderingContext.INT_VEC3:return e.uniform3iv(n,i);case WebGLRenderingContext.BOOL_VEC4:case WebGLRenderingContext.INT_VEC4:return e.uniform4iv(n,i);case WebGLRenderingContext.FLOAT_MAT2:return e.uniformMatrix2fv(n,!1,i);case WebGLRenderingContext.FLOAT_MAT3:return e.uniformMatrix3fv(n,!1,i);case WebGLRenderingContext.FLOAT_MAT4:return e.uniformMatrix4fv(n,!1,i)}}var jt=(0,l.Z)("uniformLocations"),Dt=(0,l.Z)("attributeLocations"),Gt=(0,l.Z)("vs"),zt=(0,l.Z)("fs"),Vt=(0,l.Z)("renderState"),Wt=(0,l.Z)("assignUniforms"),Ht=(0,l.Z)("assignAttributes"),qt=function(e){function t(t,n){var i;void 0===n&&(n={}),i=e.call(this,t,n)||this,Object.defineProperty((0,r.Z)(i),Ht,{value:Yt}),Object.defineProperty((0,r.Z)(i),Wt,{value:Xt}),i.attributeOrder=void 0,i.uniforms=void 0,Object.defineProperty((0,r.Z)(i),jt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Dt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Gt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),zt,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(i),Vt,{writable:!0,value:void 0});var s=n,a=s.id,l=s.vertexShader,h=s.fragmentShader,u=s.uniforms,c=void 0===u?{}:u,d=s.transparent,f=void 0!==d&&d,m=s.defines,p=void 0===m?[]:m,v=s.includes,b=void 0===v?{}:v,y=s.cullFace,x=s.frontFace,w=void 0===x?t.gl.CCW:x,Z=s.depthTest,E=void 0===Z||Z,A=s.depthWrite,M=void 0===A||A,T=s.depthFunc,S=void 0===T?t.gl.LESS:T,R=s.blending,_=void 0===R?1:R,C=s.blendFunc,F=s.blendEquation;i.id=a||z("program");var P=[].concat((Object.assign({},n,c),[].map((function(e){return"#define ".concat(e)}))),p).map((function(e){return e.startsWith("#define ")?e:"#define ".concat(e)}));if(!l||!h)throw new Error("Program: "+i.id+"\uff1amust provide vertexShader and fragmentShader");if((0,o.Z)((0,r.Z)(i),Gt)[Gt]="string"==typeof l?new It(t,g(l,P),b):l,(0,o.Z)((0,r.Z)(i),zt)[zt]="string"==typeof h?new kt(t,g(h,P),b):h,i.gl.attachShader(i.handle,(0,o.Z)((0,r.Z)(i),Gt)[Gt].handle),i.gl.attachShader(i.handle,(0,o.Z)((0,r.Z)(i),zt)[zt].handle),i.gl.linkProgram(i.handle),i.gl.validateProgram(i.handle),!i.gl.getProgramParameter(i.handle,i.gl.LINK_STATUS))throw new Error("Program:".concat(i.id,": Error linking ").concat(i.gl.getProgramInfoLog(i.handle)));return i.uniforms=c,(0,o.Z)((0,r.Z)(i),Vt)[Vt]={blending:_,cullFace:y,frontFace:w,depthTest:E,depthWrite:M,depthFunc:S,blendFunc:C,blendEquation:F},(0,o.Z)((0,r.Z)(i),jt)[jt]=new Map,(0,o.Z)((0,r.Z)(i),Dt)[Dt]=new Map,(0,o.Z)((0,r.Z)(i),Wt)[Wt](c),(0,o.Z)((0,r.Z)(i),Ht)[Ht](),!f||null!=C&&C.src||(i.renderer.premultipliedAlpha?(0,o.Z)((0,r.Z)(i),Vt)[Vt].blendFunc=Object.assign({},C,{src:i.gl.ONE,dst:i.gl.ONE_MINUS_SRC_ALPHA}):(0,o.Z)((0,r.Z)(i),Vt)[Vt].blendFunc=Object.assign({},C,{src:i.gl.SRC_ALPHA,dst:i.gl.ONE_MINUS_SRC_ALPHA})),i}(0,s.Z)(t,e);var n=t.prototype;return n.use=function(){var e=this,t=this.rendererState.currentProgramId===this.id,n=-1;t||(this.gl.useProgram(this.handle),this.rendererState.currentProgramId=this.id),(0,o.Z)(this,jt)[jt].forEach((function(t,i){var r=i.name,s=e.uniforms[r];if(s)if(s&&(I(s.value)||j(s.value)))console.warn("Program:".concat(e.id,": Uniform ").concat(r," is missing a value parameter"));else{var a=null==s?void 0:s.value;if(a instanceof yt)return n+=1,s.value.update(n),Ut(e.gl,i.type,t.location,n);if((a instanceof be||a instanceof ce||a instanceof Te)&&(a=s.value.toArray()),a&&a.length>0&&a[0]instanceof yt){for(var o=[],l=0;l<s.value.length;l++){var h=a[l];n+=1,h.update(n),o.push(n)}return Ut(e.gl,i.type,t.location,o)}Ut(e.gl,i.type,t.location,a)}else console.warn("Program:".concat(e.id,": Active uniform ").concat(r," has not been supplied"))})),this.applyState()},n.setStates=function(e,t){void 0===t&&(t=!0),t?((0,o.Z)(this,Vt)[Vt]=Object.assign({},(0,o.Z)(this,Vt)[Vt],V(e,["blendFunc","blendEquation"])),e.blendFunc&&((0,o.Z)(this,Vt)[Vt].blendFunc=Object.assign({},(0,o.Z)(this,Vt)[Vt].blendFunc,e.blendFunc)),e.blendEquation&&((0,o.Z)(this,Vt)[Vt].blendEquation=Object.assign({},(0,o.Z)(this,Vt)[Vt].blendEquation,e.blendEquation))):(0,o.Z)(this,Vt)[Vt]=e},n.applyState=function(){this.rendererState.apply((0,o.Z)(this,Vt)[Vt])},n.setUniform=function(e,t){this.uniforms[e]&&(this.uniforms[e].value=t)},n.bind=function(){this.gl.useProgram(this.handle)},n.unbind=function(){this.gl.useProgram(null)},n.createHandle=function(){return this.gl.createProgram()},n.deleteHandle=function(){this.gl.deleteProgram(this.handle)},n.destroy=function(){this.unbind(),this.deleteHandle()},(0,a.Z)(t,[{key:"uniformLocations",get:function(){return(0,o.Z)(this,jt)[jt]}},{key:"attributeLocations",get:function(){return(0,o.Z)(this,Dt)[Dt]}},{key:"vertexShader",get:function(){return(0,o.Z)(this,Gt)[Gt]}},{key:"fragmentShader",get:function(){return(0,o.Z)(this,zt)[zt]}}]),t}(mt);function Xt(e){void 0===e&&(e={});for(var t=this.gl.getProgramParameter(this.handle,this.gl.ACTIVE_UNIFORMS),n=0;n<t;n++){var i,r=this.gl.getActiveUniform(this.handle,n);if(!r)break;var s=r.name,a=s.match(/(\w+)/g),l={location:this.gl.getUniformLocation(this.handle,s),type:r.type,name:a[0],isStruct:!1};3===a.length?(l.isStructArray=!0,l.structIndex=Number(a[1]),l.structProperty=a[2]):2===a.length&&isNaN(Number(a[1]))&&(l.isStruct=!0,l.structProperty=a[1]);var h=null==(i=e[s])?void 0:i.value;I(h)||j(h)||(l.value=e[s].value),this.uniforms[s]=l,(0,o.Z)(this,jt)[jt].set(r,l)}}function Yt(){for(var e=this.gl.getProgramParameter(this.handle,this.gl.ACTIVE_ATTRIBUTES),t=[],n=0;n<e;n++){var i=this.gl.getActiveAttrib(this.handle,n);if(!i)break;var r=this.gl.getAttribLocation(this.handle,i.name);t[r]=i.name,(0,o.Z)(this,Dt)[Dt].set(i,r)}this.attributeOrder=t.join("")}var Kt=(0,l.Z)("state"),Jt=function(e){function t(t,n){var i;void 0===n&&(n={});var s=t.gl,a={target:s.TEXTURE_3D,type:s.UNSIGNED_BYTE,format:s.RGBA,internalFormat:n.format||s.RGBA,wrapS:s.CLAMP_TO_EDGE,wrapT:s.CLAMP_TO_EDGE,wrapR:s.CLAMP_TO_EDGE,generateMipmaps:!0,minFilter:s.LINEAR,magFilter:s.LINEAR,premultiplyAlpha:!1,unpackAlignment:4,flipY:!1,level:0,depth:0},l=Object.assign({},a,n);return(i=e.call(this,t,l,!1)||this).needsUpdate=!1,i.textureUnit=0,i.depth=void 0,Object.defineProperty((0,r.Z)(i),Kt,{writable:!0,value:{}}),i.needsUpdate=!0,i.depth=i.options.depth,(0,o.Z)((0,r.Z)(i),Kt)[Kt].version=-1,i.update(),i}(0,s.Z)(t,e);var n=t.prototype;return n.setData=function(e,t,n,i){void 0===t&&(t=this.width),void 0===n&&(n=this.height),void 0===i&&(i=this.depth),this.image=e,this.width=t,this.height=n,this.depth=i,this.needsUpdate=!0},n.setOptions=function(e){this.options=Object.assign(this.options,e),this.width=this.options.width,this.height=this.options.height,this.depth=this.options.depth,this.needsUpdate=!0},n.update=function(e){void 0===e&&(e=0);var t=!(this.image===(0,o.Z)(this,Kt)[Kt].image&&!this.needsUpdate);if((t||this.rendererState.textureUnits[e]!==this.id||this.rendererState.activeTextureUnit!==e)&&(this.rendererState.setActiveTexture(e),this.bind(e)),t){if(this.needsUpdate=!1,this.options.wrapS!==(0,o.Z)(this,Kt)[Kt].wrapS&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.options.wrapS),(0,o.Z)(this,Kt)[Kt].wrapS=this.options.wrapS),this.options.wrapT!==(0,o.Z)(this,Kt)[Kt].wrapT&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.options.wrapT),(0,o.Z)(this,Kt)[Kt].wrapT=this.options.wrapT),this.options.wrapR!==(0,o.Z)(this,Kt)[Kt].wrapR&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_R,this.options.wrapR),(0,o.Z)(this,Kt)[Kt].wrapR=this.options.wrapR),this.options.minFilter!==(0,o.Z)(this,Kt)[Kt].minFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.options.minFilter),(0,o.Z)(this,Kt)[Kt].minFilter=this.options.minFilter),this.options.magFilter!==(0,o.Z)(this,Kt)[Kt].magFilter&&(this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.options.magFilter),(0,o.Z)(this,Kt)[Kt].magFilter=this.options.magFilter),this.options.flipY!==this.rendererState.flipY&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,this.options.flipY),this.rendererState.flipY=this.options.flipY),this.options.premultiplyAlpha!==this.rendererState.premultiplyAlpha&&(this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.options.premultiplyAlpha),this.rendererState.premultiplyAlpha=this.options.premultiplyAlpha),this.options.unpackAlignment!==this.rendererState.unpackAlignment&&(this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,this.options.unpackAlignment),this.rendererState.unpackAlignment=this.options.unpackAlignment),this.options.anisotropy&&this.options.anisotropy!==this.rendererState.anisotropy){var n=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(n){var i=this.gl.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT),r=this.options.anisotropy;this.options.anisotropy>i&&(r=i,console.warn("[Texture]: Texture.anisotropy option exceeded the maximum allowed value "+i+" of the device")),this.gl.texParameterf(this.target,n.TEXTURE_MAX_ANISOTROPY_EXT,r)}this.rendererState.anisotropy=this.options.anisotropy}this.image?(this.image.width&&(this.width=this.image.width,this.height=this.image.height),this.renderer.isWebGL2&&B(this.options.offset)?this.gl.texImage3D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,this.depth,0,this.options.format,this.options.type,this.image,this.options.offset):(ArrayBuffer.isView(this.image),this.gl.texImage3D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,this.depth,0,this.options.format,this.options.type,this.image)),this.options.generateMipmaps&&(this.renderer.isWebGL2||T(this.image.width)&&T(this.image.height)?this.gl.generateMipmap(this.target):(this.options.generateMipmaps=!1,this.options.wrapS=this.gl.CLAMP_TO_EDGE,this.options.wrapT=this.options.wrapS,this.options.minFilter=this.gl.LINEAR))):this.width>0?this.gl.texImage3D(this.target,this.options.level,this.options.internalFormat,this.width,this.height,this.depth,0,this.options.format,this.options.type,null):this.gl.texImage3D(this.target,0,this.gl.RGBA,1,1,this.depth,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,gt),(0,o.Z)(this,Kt)[Kt].image=this.image,(0,o.Z)(this,Kt)[Kt].version+=1}},n.removeStats=function(){(0,o.Z)(this,Kt)[Kt]={version:-1}},n.toString=function(){return"Texture3D("+this.id+","+this.width+"x"+this.height+")"},(0,a.Z)(t,[{key:"gl",get:function(){return this.renderer.gl}}]),t}(yt),$t=new we,Qt=new ve,en=new ve,tn=(0,l.Z)("near"),nn=(0,l.Z)("far"),rn=(0,l.Z)("fov"),sn=(0,l.Z)("aspect"),an=(0,l.Z)("zoom"),on=(0,l.Z)("bounds"),ln=function(e){function t(t){var n,i=void 0===t?{}:t,s=i.near,a=void 0===s?.1:s,l=i.far,h=void 0===l?100:l,u=i.fov,c=void 0===u?45:u,d=i.aspect,f=void 0===d?1:d,m=i.bounds,p=i.zoom,v=void 0===p?1:p;(n=e.call(this)||this).cameraType=void 0,n.projectionMatrix=void 0,n.viewMatrix=void 0,n.projectionViewMatrix=void 0,n.worldPosition=void 0,Object.defineProperty((0,r.Z)(n),tn,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(n),nn,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(n),rn,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(n),sn,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(n),an,{writable:!0,value:void 0}),Object.defineProperty((0,r.Z)(n),on,{writable:!0,value:void 0}),n.frustum=void 0,n.cameraType="perspective",n.projectionMatrix=new Se,n.viewMatrix=new we,n.projectionViewMatrix=new Se,n.worldPosition=new ve,n.frustum=new we,(0,o.Z)((0,r.Z)(n),tn)[tn]=a,(0,o.Z)((0,r.Z)(n),nn)[nn]=h,(0,o.Z)((0,r.Z)(n),rn)[rn]=c,(0,o.Z)((0,r.Z)(n),sn)[sn]=f,(0,o.Z)((0,r.Z)(n),on)[on]=m,(0,o.Z)((0,r.Z)(n),an)[an]=v;var g=m||{},b=g.left,y=g.right,x=g.top,w=g.bottom;return n.cameraType=b||y?"orthographic":"perspective","orthographic"===n.cameraType?n.orthographic(b,y,x,w,a,h,v):n.perspective(c,f,a,h),n}(0,s.Z)(t,e);var n=t.prototype;return n.perspective=function(e,t,n,i){void 0===e&&(e=this.fov),void 0===t&&(t=this.aspect),void 0===n&&(n=this.near),void 0===i&&(i=this.far),(0,o.Z)(this,rn)[rn]=e,(0,o.Z)(this,sn)[sn]=t,(0,o.Z)(this,tn)[tn]=n,(0,o.Z)(this,nn)[nn]=i,this.projectionMatrix.fromPerspective(e,t,n,i),this.cameraType="perspective"},n.orthographic=function(e,t,n,i,r,s,a){void 0===r&&(r=this.near),void 0===s&&(s=this.far),void 0===a&&(a=1),(0,o.Z)(this,on)[on]={left:e,right:t,top:n,bottom:i},this.near=r,this.far=s,this.projectionMatrix.orthographic(e/a,t/a,n/a,i/a,r,s),this.cameraType="orthographic",this.projectionMatrix.frustum(this.frustum,(0,o.Z)(this,on)[on].left,(0,o.Z)(this,on)[on].right,(0,o.Z)(this,on)[on].top,(0,o.Z)(this,on)[on].bottom,(0,o.Z)(this,tn)[tn],(0,o.Z)(this,nn)[nn])},n.lookAt=function(t){return e.prototype.lookAt.call(this,t,!0),this},n.updateMatrixWorld=function(){return e.prototype.updateMatrixWorld.call(this),this.viewMatrix.invert(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this},n.frustumIntersectsMesh=function(e,t){if(void 0===t&&(t=e.worldMatrix),!e.geometry.attributes.position)return!0;if(e.geometry.bounds&&e.geometry.bounds.radius!==1/0||e.geometry.computeBoundingSphere(),!e.geometry.bounds)return!0;var n=Qt;n.copy(e.geometry.bounds.center),n.applyMatrix4(t);var i=e.geometry.bounds.radius*t.getMaxScaleOnAxis();return this.frustumIntersectsSphere(n,i)},n.frustumIntersectsSphere=function(e,t){for(var n=en,i=0;i<6;i++){var r=this.frustum[i];if(n.copy(r).dot(e)+r.constant<-t)return!1}return!0},n.project=function(e){return e.applyMatrix4(this.viewMatrix),e.applyMatrix4(this.projectionMatrix),this},n.unproject=function(e){return e.applyMatrix4($t.invert(this.projectionMatrix)),e.applyMatrix4(this.worldMatrix),this},n.updateProjectionMatrix=function(){throw new Error("Camera subclass must define virtual methods")},(0,a.Z)(t,[{key:"near",get:function(){return(0,o.Z)(this,tn)[tn]},set:function(e){(0,o.Z)(this,tn)[tn]=e,this.updateProjectionMatrix()}},{key:"far",get:function(){return(0,o.Z)(this,nn)[nn]},set:function(e){(0,o.Z)(this,nn)[nn]=e,this.updateProjectionMatrix()}},{key:"fov",get:function(){return(0,o.Z)(this,rn)[rn]},set:function(e){(0,o.Z)(this,rn)[rn]=e,this.updateProjectionMatrix()}},{key:"aspect",get:function(){return(0,o.Z)(this,sn)[sn]},set:function(e){(0,o.Z)(this,sn)[sn]=e,this.updateProjectionMatrix()}},{key:"zoom",get:function(){return(0,o.Z)(this,an)[an]},set:function(e){(0,o.Z)(this,an)[an]=e,this.updateProjectionMatrix()}},{key:"bounds",get:function(){return(0,o.Z)(this,on)[on]},set:function(e){(0,o.Z)(this,on)[on]=e,this.updateProjectionMatrix()}}]),t}(Re),hn=function(e){function t(t,n,i,r){return e.call(this,{fov:t,aspect:n,near:i,far:r})||this}return(0,s.Z)(t,e),t.prototype.updateProjectionMatrix=function(){this.projectionMatrix.fromPerspective(this.fov,this.aspect,this.near,this.far)},t}(ln),un=function(e){function t(t,n,i,r,s,a,o){return void 0===o&&(o=1),e.call(this,{bounds:{left:t,right:n,top:i,bottom:r},near:s,far:a,zoom:o})||this}return(0,s.Z)(t,e),t.prototype.updateProjectionMatrix=function(){var e=this.bounds,t=e.left,n=e.right,i=e.top,r=e.bottom,s=this.zoom;this.projectionMatrix.orthographic(t/s,n/s,i/s,r/s,this.near,this.far)},t}(ln)},7672:(e,t,n)=>{n.d(t,{E:()=>m});var i=n(6446),r=n(2569),s=n(5935);const a=n.p+"assets/images/lut-237c8bbe432f273b62b7cb78e97cf490.png",o=n.p+"assets/images/sunset-diffuse-RGBM-07e34e095bbcd1e6bd98a0848bf366a9.png",l=n.p+"assets/images/sunset-specular-RGBM-8cc1b3dce731aaccef0b0625020e73dc.png";var h=n(889),u={5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array,"image/jpeg":Uint8Array,"image/png":Uint8Array},c={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},d={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},f={translation:"position",rotation:"quaternion",scale:"scale"};var m=function(){function e(){}return e.load=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.split("/").slice(0,-1).join("/")+"/",e.next=3,this.parseDesc(n);case 3:return s=e.sent,e.next=6,this.parse(t,s,i);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e.parse=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n,i){var s,a,o,l,h,u,c,d,f,m,p,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(void 0===n.asset||n.asset.version[0]<2)&&console.warn("Only GLTF >=2.0 supported. Attempting to parse."),e.next=3,this.loadBuffers(n,i);case 3:for(s=e.sent,t.bindVertexArray(null),a=this.parseBufferViews(t,n,s),o=this.parseImages(t,n,i,a),l=this.parseTextures(t,n,o),h=this.parseMaterials(t,n,l),u=this.parseSkins(t,n,a),c=this.parseMeshes(t,n,a,h,u),d=this.parseNodes(t,n,c,u),this.populateSkins(u,d),f=this.parseAnimations(t,n,d,a),m=this.parseScenes(n,d),p=m[n.scene],v=d.length;v>=0;v--)d[v]||d.splice(v,1);return e.abrupt("return",{json:n,buffers:s,bufferViews:a,images:o,textures:l,materials:h,meshes:c,nodes:d,animations:f,scenes:m,scene:p});case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),e.parseDesc=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var n=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.match(/\.glb/)){e.next=6;break}return e.next=3,fetch(t).then((function(e){return e.json()}));case 3:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,fetch(t).then((function(e){return e.arrayBuffer()})).then((function(e){return n.unpackGLB(e)}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.unpackGLB=function(e){var t=new Uint32Array(e,0,3);if(1179937895!==t[0])throw new Error("Invalid glTF asset.");if(2!==t[1])throw new Error('Unsupported glTF binary version, "'+t[1]+'".');var n=new Uint32Array(e,12,2),i=n[0];if(1313821514!==n[1])throw new Error("Unexpected GLB layout.");var r=(new TextDecoder).decode(e.slice(20,20+i)),s=JSON.parse(r);if(20+i===e.byteLength)return s;var a=new Uint32Array(e,20+i,2);if(5130562!==a[1])throw new Error("Unexpected GLB layout.");var o=20+i+8,l=a[0],h=e.slice(o,o+l);return s.buffers[0].binary=h,s},e.resolveURI=function(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)},e.loadBuffers=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var i=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.buffers){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Promise.all(t.buffers.map((function(e){if(e.binary)return e.binary;var t=i.resolveURI(e.uri,n);return fetch(t).then((function(e){return e.arrayBuffer()}))})));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.parseBufferViews=function(e,t,n){if(!t.bufferViews)return null;var i=t.bufferViews.map((function(e){return Object.assign({},e)}));return t.meshes&&t.meshes.forEach((function(n){n.primitives.forEach((function(n){var r=n.attributes,s=n.indices;for(var a in r)i[t.accessors[r[a]].bufferView].isAttribute=!0;void 0!==s&&(i[t.accessors[s].bufferView].isAttribute=!0,i[t.accessors[s].bufferView].target=e.gl.ELEMENT_ARRAY_BUFFER)}))})),t.accessors.forEach((function(e){var t=e.bufferView,n=e.componentType;i[t].componentType=n})),t.images&&t.images.forEach((function(e){e.uri;var t=e.bufferView,n=e.mimeType;void 0!==t&&(i[t].mimeType=n)})),i.forEach((function(t,r){var s=t.buffer,a=t.byteOffset,o=void 0===a?0:a,l=t.byteLength,h=(t.byteStride,t.target),c=(void 0===h&&e.gl.ARRAY_BUFFER,t.name,t.extensions,t.extras,t.componentType),d=t.mimeType,f=(t.isAttribute,u[c||d]),m=f.BYTES_PER_ELEMENT,p=new f(n[s],o,l/m);i[r].data=p,i[r].originalBuffer=n[s]})),i},e.parseImages=function(e,t,n,i){var r=this;return t.images?t.images.map((function(e){var t=e.uri,s=e.bufferView,a=e.mimeType,o=e.name,l=new Image;if(l.name=o,t)l.src=r.resolveURI(t,n);else if(void 0!==s){var h=i[s].data,u=new Blob([h],{type:a});l.src=URL.createObjectURL(u)}return l.ready=new Promise((function(e){l.onload=function(){return e()}})),l})):null},e.parseTextures=function(e,t,n){return t.textures?t.textures.map((function(i){var r=i.sampler,s=i.source,a=i.name,o=(i.extensions,i.extras,{flipY:!1,generateMipmaps:!0,wrapS:e.gl.REPEAT,wrapT:e.gl.REPEAT,minFilter:e.gl.NEAREST_MIPMAP_LINEAR}),l=void 0!==r?t.samplers[r]:null;l&&["magFilter","minFilter","wrapS","wrapT"].forEach((function(e){l[e]&&(o[e]=l[e])}));var u=new h.Texture(e,o);u.name=a;var c=n[s];return c.ready.then((function(){u.setData(c,c.width,c.height)})),u})):null},e.parseMaterials=function(e,t,n){return t.materials?t.materials.map((function(e){var t=e.name,i=(e.extensions,e.extras,e.pbrMetallicRoughness),r=void 0===i?{}:i,s=e.normalTexture,a=e.occlusionTexture,o=e.emissiveTexture,l=e.emissiveFactor,h=void 0===l?[0,0,0]:l,u=e.alphaMode,c=void 0===u?"OPAQUE":u,d=e.alphaCutoff,f=void 0===d?.5:d,m=e.doubleSided,p=void 0!==m&&m,v=r,g=v.baseColorFactor,b=void 0===g?[1,1,1,1]:g,y=v.baseColorTexture,x=v.metallicFactor,w=void 0===x?1:x,Z=v.roughnessFactor,E=void 0===Z?1:Z,A=v.metallicRoughnessTexture;return y&&(y.texture=n[y.index]),s&&(s.texture=n[s.index]),A&&(A.texture=n[A.index]),a&&(a.texture=n[a.index]),o&&(o.texture=n[o.index]),{name:t,baseColorFactor:b,baseColorTexture:y,metallicFactor:w,roughnessFactor:E,metallicRoughnessTexture:A,normalTexture:s,occlusionTexture:a,emissiveTexture:o,emissiveFactor:h,alphaMode:c,alphaCutoff:f,doubleSided:p}})):null},e.parseSkins=function(e,t,n){var i=this;return t.skins?t.skins.map((function(e){var r=e.inverseBindMatrices,s=e.skeleton,a=e.joints;return{inverseBindMatrices:i.parseAccessor(r,t,n),skeleton:s,joints:a}})):null},e.parseMeshes=function(e,t,n,i,r){var s=this;return t.meshes?t.meshes.map((function(r,a){var o=r.primitives,l=r.weights,u=r.name,c=(r.extensions,r.extras,0);return t.nodes&&t.nodes.forEach((function(e){var t=e.mesh,n=e.skin;t===a&&(c++,void 0!==n&&n)})),{primitives:o=s.parsePrimitives(e,o,t,n,i,c).map((function(t){var n=t.geometry,i=t.program,r=t.mode,s=new h.Mesh(e,{geometry:n,program:i,mode:r});return s.name=u,s.geometry.isInstanced&&(s.numInstances=c,s.frustumCulled=!1),s})),weights:l,name:u}})):null},e.parsePrimitives=function(e,t,n,i,r,s){var u=this;return t.map((function(t){var c=t.attributes,f=t.indices,m=t.material,p=t.mode,v=void 0===p?4:p,g=(t.targets,t.extensions,t.extras,new h.Geometry(e));for(var b in c)g.addAttribute(d[b],new h.BufferAttribute(e,u.parseAccessor(c[b],n,i)));void 0!==f&&g.setIndex(new h.BufferAttribute(e,u.parseAccessor(f,n,i))),s>1&&g.addAttribute("instanceMatrix",new h.BufferAttribute(e,{divisor:1,size:16,data:new Float32Array(16*s)}));var y={};void 0!==m&&(y=r[m]);var x=function(e,t,n,i){var r=[];t.attributes.get("uv")&&r.push("UV"),t.attributes.get("normal")&&r.push("NORMAL"),t.isInstanced&&r.push("INSTANCED"),n.boneTexture&&r.push("SKINNING"),"MASK"===n.alphaMode&&r.push("ALPHA_MASK"),n.baseColorTexture&&r.push("COLOR_MAP"),n.normalTexture&&r.push("NORMAL_MAP"),n.metallicRoughnessTexture&&r.push("RM_MAP"),n.occlusionTexture&&r.push("OCC_MAP"),n.emissiveTexture&&r.push("EMISSIVE_MAP");var s={wrapS:e.gl.CLAMP_TO_EDGE,wrapT:e.gl.CLAMP_TO_EDGE,format:e.gl.RGBA,internalFormat:e.gl.RGBA,generateMipmaps:!0,minFilter:e.gl.NEAREST_MIPMAP_LINEAR,magFilter:e.gl.LINEAR,premultiplyAlpha:!1,unpackAlignment:4,flipY:!0},u=new h.Texture(e,s),c=new h.Texture(e,s),d=new h.Texture(e,s);return u.fromSrc(a),c.fromSrc(o),d.fromSrc(l),new h.Program(e,{vertexShader:"#version 300 es\n#define GLSLIFY 1\n#define attribute in\n#define varying out\n#define texture2D texture\n\n#defines\n\nattribute vec3 position;\n\n#ifdef UV\nattribute vec2 uv;\n#else\nconst vec2 uv = vec2(0);\n#endif\n\n#ifdef NORMAL\nattribute vec3 normal;\n#else\nconst vec3 normal = vec3(0);\n#endif\n\n#ifdef INSTANCED\nattribute mat4 instanceMatrix;\n#endif\n\n#ifdef SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\n#ifdef SKINNING\nuniform sampler2D boneTexture;\nuniform int boneTextureSize;\n#endif\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vMPos;\nvarying vec4 vMVPos;\n\n#ifdef SKINNING\n    mat4 getBoneMatrix(const in float i) {\n        float j = i * 4.0;\n        float x = mod(j, float(boneTextureSize));\n        float y = floor(j / float(boneTextureSize));\n\n        float dx = 1.0 / float(boneTextureSize);\n        float dy = 1.0 / float(boneTextureSize);\n\n        y = dy * (y + 0.5);\n\n        vec4 v1 = texture2D(boneTexture, vec2(dx * (x + 0.5), y));\n        vec4 v2 = texture2D(boneTexture, vec2(dx * (x + 1.5), y));\n        vec4 v3 = texture2D(boneTexture, vec2(dx * (x + 2.5), y));\n        vec4 v4 = texture2D(boneTexture, vec2(dx * (x + 3.5), y));\n\n        return mat4(v1, v2, v3, v4);\n    }\n\n    void skin(inout vec4 pos, inout vec3 nml) {\n        mat4 boneMatX = getBoneMatrix(skinIndex.x);\n        mat4 boneMatY = getBoneMatrix(skinIndex.y);\n        mat4 boneMatZ = getBoneMatrix(skinIndex.z);\n        mat4 boneMatW = getBoneMatrix(skinIndex.w);\n\n        // update normal\n        mat4 skinMatrix = mat4(0.0);\n        skinMatrix += skinWeight.x * boneMatX;\n        skinMatrix += skinWeight.y * boneMatY;\n        skinMatrix += skinWeight.z * boneMatZ;\n        skinMatrix += skinWeight.w * boneMatW;\n        nml = vec4(skinMatrix * vec4(nml, 0.0)).xyz;\n\n        // Update position\n        vec4 transformed = vec4(0.0);\n        transformed += boneMatX * pos * skinWeight.x;\n        transformed += boneMatY * pos * skinWeight.y;\n        transformed += boneMatZ * pos * skinWeight.z;\n        transformed += boneMatW * pos * skinWeight.w;\n        pos = transformed;\n    }\n#endif\n\nvoid main() {\n    vec4 pos = vec4(position, 1);\n    vec3 nml = normal;\n\n    #ifdef SKINNING\n    skin(pos, nml);\n    #endif\n\n    #ifdef INSTANCED\n    pos = instanceMatrix * pos;\n\n    mat3 m = mat3(instanceMatrix);\n    nml /= vec3(dot(m[0], m[0]), dot(m[1], m[1]), dot(m[2], m[2]));\n    nml = m * nml;\n    #endif\n\n    vUv = uv;\n    vNormal = normalize(nml);\n\n    vec4 mPos = modelMatrix * pos;\n    vMPos = mPos.xyz / mPos.w;\n    vMVPos = modelViewMatrix * pos;\n\n    gl_Position = projectionMatrix * vMVPos;\n}\n",fragmentShader:"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n#define varying in\n#define texture2D texture\n#define gl_FragColor FragColor\nout vec4 FragColor;\n\n#defines\n\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n\nuniform vec4 uBaseColorFactor;\nuniform sampler2D tBaseColor;\n\nuniform sampler2D tRM;\nuniform float uRoughness;\nuniform float uMetallic;\n\nuniform sampler2D tNormal;\nuniform float uNormalScale;\n\nuniform sampler2D tEmissive;\nuniform vec3 uEmissive;\n\nuniform sampler2D tOcclusion;\n\nuniform sampler2D tLUT;\nuniform sampler2D tEnvDiffuse;\nuniform sampler2D tEnvSpecular;\nuniform float uEnvDiffuse;\nuniform float uEnvSpecular;\n\nuniform vec3 uLightDirection;\nuniform vec3 uLightColor;\n\nuniform float uAlpha;\nuniform float uAlphaCutoff;\n\nvarying vec2 vUv;\nvarying vec3 vNormal;\nvarying vec3 vMPos;\nvarying vec4 vMVPos;\n\nconst float PI = 3.14159265359;\nconst float RECIPROCAL_PI = 0.31830988618;\nconst float RECIPROCAL_PI2 = 0.15915494;\nconst float LN2 = 0.6931472;\n\nconst float ENV_LODS = 6.0;\n\nvec4 SRGBtoLinear(vec4 srgb) {\n    vec3 linOut = pow(srgb.xyz, vec3(2.2));\n    return vec4(linOut, srgb.w);\n}\n\nvec4 RGBMToLinear(in vec4 value) {\n    float maxRange = 6.0;\n    return vec4(value.xyz * value.w * maxRange, 1.0);\n}\n\nvec3 linearToSRGB(vec3 color) {\n    return pow(color, vec3(1.0 / 2.2));\n}\n\nvec3 getNormal() {\n    #ifdef NORMAL_MAP\n    vec3 pos_dx = dFdx(vMPos.xyz);\n    vec3 pos_dy = dFdy(vMPos.xyz);\n    vec2 tex_dx = dFdx(vUv);\n    vec2 tex_dy = dFdy(vUv);\n\n    // Tangent, Bitangent\n    vec3 t = normalize(pos_dx * tex_dy.t - pos_dy * tex_dx.t);\n    vec3 b = normalize(-pos_dx * tex_dy.s + pos_dy * tex_dx.s);\n    mat3 tbn = mat3(t, b, normalize(vNormal));\n\n    vec3 n = texture2D(tNormal, vUv).rgb * 2.0 - 1.0;\n    n.xy *= uNormalScale;\n    vec3 normal = normalize(tbn * n);\n\n    // Get world normal from view normal (normalMatrix * normal)\n    // return normalize((vec4(normal, 0.0) * viewMatrix).xyz);\n    return normalize(normal);\n    #else\n    return normalize(vNormal);\n    #endif\n}\n\nvec3 specularReflection(vec3 specularEnvR0, vec3 specularEnvR90, float VdH) {\n    return specularEnvR0 + (specularEnvR90 - specularEnvR0) * pow(clamp(1.0 - VdH, 0.0, 1.0), 5.0);\n}\n\nfloat geometricOcclusion(float NdL, float NdV, float roughness) {\n    float r = roughness;\n\n    float attenuationL = 2.0 * NdL / (NdL + sqrt(r * r + (1.0 - r * r) * (NdL * NdL)));\n    float attenuationV = 2.0 * NdV / (NdV + sqrt(r * r + (1.0 - r * r) * (NdV * NdV)));\n    return attenuationL * attenuationV;\n}\n\nfloat microfacetDistribution(float roughness, float NdH) {\n    float roughnessSq = roughness * roughness;\n    float f = (NdH * roughnessSq - NdH) * NdH + 1.0;\n    return roughnessSq / (PI * f * f);\n}\n\nvec2 cartesianToPolar(vec3 n) {\n    vec2 uv;\n    uv.x = atan(n.z, n.x) * RECIPROCAL_PI2 + 0.5;\n    uv.y = asin(n.y) * RECIPROCAL_PI + 0.5;\n    return uv;\n}\n\nvoid getIBLContribution(inout vec3 diffuse, inout vec3 specular, float NdV, float roughness, vec3 n, vec3 reflection, vec3 diffuseColor, vec3 specularColor) {\n    vec3 brdf = SRGBtoLinear(texture2D(tLUT, vec2(NdV, roughness))).rgb;\n\n    vec3 diffuseLight = RGBMToLinear(texture2D(tEnvDiffuse, cartesianToPolar(n))).rgb;\n    diffuseLight = mix(vec3(1), diffuseLight, uEnvDiffuse);\n\n    // Sample 2 levels and mix between to get smoother degradation\n    float blend = roughness * ENV_LODS;\n    float level0 = floor(blend);\n    float level1 = min(ENV_LODS, level0 + 1.0);\n    blend -= level0;\n\n    // Sample the specular env map atlas depending on the roughness value\n    vec2 uvSpec = cartesianToPolar(reflection);\n    uvSpec.y /= 2.0;\n\n    vec2 uv0 = uvSpec;\n    vec2 uv1 = uvSpec;\n\n    uv0 /= pow(2.0, level0);\n    uv0.y += 1.0 - exp(-LN2 * level0);\n\n    uv1 /= pow(2.0, level1);\n    uv1.y += 1.0 - exp(-LN2 * level1);\n\n    vec3 specular0 = RGBMToLinear(texture2D(tEnvSpecular, uv0)).rgb;\n    vec3 specular1 = RGBMToLinear(texture2D(tEnvSpecular, uv1)).rgb;\n    vec3 specularLight = mix(specular0, specular1, blend);\n\n    diffuse = diffuseLight * diffuseColor;\n\n    // Bit of extra reflection for smooth materials\n    float reflectivity = pow((1.0 - roughness), 2.0) * 0.05;\n    specular = specularLight * (specularColor * brdf.x + brdf.y + reflectivity);\n    specular *= uEnvSpecular;\n}\n\nvoid main() {\n    vec4 baseColor = uBaseColorFactor;\n    #ifdef COLOR_MAP\n    baseColor *= SRGBtoLinear(texture2D(tBaseColor, vUv));\n    #endif\n\n    // Get base alpha\n    float alpha = baseColor.a;\n\n    #ifdef ALPHA_MASK\n    if (alpha < uAlphaCutoff) discard;\n    #endif\n\n    // RM map packed as gb = [nothing, roughness, metallic, nothing]\n    vec4 rmSample = vec4(1);\n    #ifdef RM_MAP\n    rmSample *= texture2D(tRM, vUv);\n    #endif\n    float roughness = clamp(rmSample.g * uRoughness, 0.04, 1.0);\n    float metallic = clamp(rmSample.b * uMetallic, 0.04, 1.0);\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0) * (1.0 - metallic);\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n    vec3 specularEnvR0 = specularColor;\n    vec3 specularEnvR90 = vec3(clamp(max(max(specularColor.r, specularColor.g), specularColor.b) * 25.0, 0.0, 1.0));\n\n    vec3 N = getNormal();\n    vec3 V = normalize(cameraPosition - vMPos);\n    vec3 L = normalize(uLightDirection);\n    vec3 H = normalize(L + V);\n    vec3 reflection = normalize(reflect(-V, N));\n\n    float NdL = clamp(dot(N, L), 0.001, 1.0);\n    float NdV = clamp(abs(dot(N, V)), 0.001, 1.0);\n    float NdH = clamp(dot(N, H), 0.0, 1.0);\n    float LdH = clamp(dot(L, H), 0.0, 1.0);\n    float VdH = clamp(dot(V, H), 0.0, 1.0);\n\n    vec3 F = specularReflection(specularEnvR0, specularEnvR90, VdH);\n    float G = geometricOcclusion(NdL, NdV, roughness);\n    float D = microfacetDistribution(roughness, NdH);\n\n    vec3 diffuseContrib = (1.0 - F) * (diffuseColor / PI);\n    vec3 specContrib = F * G * D / (4.0 * NdL * NdV);\n\n    // Shading based off lights\n    vec3 color = NdL * uLightColor * (diffuseContrib + specContrib);\n\n    // Add lights spec to alpha for reflections on transparent surfaces (glass)\n    alpha = max(alpha, max(max(specContrib.r, specContrib.g), specContrib.b));\n\n    // Calculate IBL lighting\n    vec3 diffuseIBL;\n    vec3 specularIBL;\n    getIBLContribution(diffuseIBL, specularIBL, NdV, roughness, N, reflection, diffuseColor, specularColor);\n\n    // Add IBL on top of color\n    color += diffuseIBL + specularIBL;\n\n    // Add IBL spec to alpha for reflections on transparent surfaces (glass)\n    alpha = max(alpha, max(max(specularIBL.r, specularIBL.g), specularIBL.b));\n\n    #ifdef OCC_MAP\n    // TODO: figure out how to apply occlusion\n    // color *= SRGBtoLinear(texture2D(tOcclusion, vUv)).rgb;\n    #endif\n\n    #ifdef EMISSIVE_MAP\n    vec3 emissive = SRGBtoLinear(texture2D(tEmissive, vUv)).rgb * uEmissive;\n    color += emissive;\n    #endif\n\n    // Convert to sRGB to display\n    gl_FragColor.rgb = linearToSRGB(color);\n\n    // Apply uAlpha uniform at the end to overwrite any specular additions on transparent surfaces\n    gl_FragColor.a = alpha * uAlpha;\n}\n",uniforms:{uBaseColorFactor:{value:(new h.Vector4).fromArray(n.baseColorFactor||[1,1,1,1])},tBaseColor:{value:n.baseColorTexture?n.baseColorTexture.texture:null},tRM:{value:n.metallicRoughnessTexture?n.metallicRoughnessTexture.texture:null},uRoughness:{value:void 0!==n.roughnessFactor?n.roughnessFactor:1},uMetallic:{value:void 0!==n.metallicFactor?n.metallicFactor:1},tNormal:{value:n.normalTexture?n.normalTexture.texture:null},uNormalScale:{value:n.normalTexture&&n.normalTexture.scale||1},tOcclusion:{value:n.occlusionTexture?n.occlusionTexture.texture:null},tEmissive:{value:n.emissiveTexture?n.emissiveTexture.texture:null},uEmissive:{value:(new h.Vector3).fromArray(n.emissiveFactor||[0,0,0])},tLUT:{value:u},tEnvDiffuse:{value:c},tEnvSpecular:{value:d},uEnvDiffuse:{value:.5},uEnvSpecular:{value:.5},uLightDirection:{value:new h.Vector3(0,1,1)},uLightColor:{value:new h.Vector3(2.5)},uAlpha:{value:1},uAlphaCutoff:{value:n.alphaCutoff}},defines:r,transparent:"BLEND"===n.alphaMode,cullFace:n.doubleSided?void 0:e.gl.BACK})}(e,g,y);return{geometry:g,program:x,mode:v}}))},e.parseAccessor=function(e,t,n){var i=t.accessors[e],r=i.bufferView,s=i.byteOffset,a=void 0===s?0:s,o=i.componentType,l=i.normalized,h=void 0!==l&&l,d=i.count,f=i.type,m=i.min,p=i.max,v=(i.sparse,n[r]),g=v.data,b=v.originalBuffer,y=v.byteOffset,x=void 0===y?0:y,w=v.byteStride,Z=void 0===w?0:w,E=(v.target,c[f]),A=u[o],M=g.BYTES_PER_ELEMENT;return{data:!!Z&&Z/M!==E?g:new A(b,a+x,d*E),size:E,type:o,normalized:h,stride:Z,offset:a,count:d,min:m,max:p}},e.parseNodes=function(e,t,n,i){if(!t.nodes)return null;var r=t.nodes.map((function(e){e.camera,e.children,e.skin;var t=e.matrix,i=e.mesh,r=e.rotation,s=e.scale,a=e.translation,o=(e.weights,e.name),l=(e.extensions,e.extras,new h.Object3D);o&&(l.name=o),t?(l.localMatrix.copy((new h.ProjectionMatrix).fromArray(t)),l.decompose()):(r&&l.quaternion.copy((new h.Quaternion).fromArray(r)),s&&l.scale.copy((new h.Vector3).fromArray(s)),a&&l.position.copy((new h.Vector3).fromArray(a)),l.updateMatrix());var u=!1,c=!0;if(void 0!==i&&n[i].primitives.forEach((function(e){e.geometry.isInstanced&&(u=!0,e.instanceCount?c=!1:e.instanceCount=0,l.matrix.toArray(e.geometry.attributes.instanceMatrix.data,16*e.instanceCount),e.instanceCount++,e.instanceCount===e.numInstances&&(delete e.numInstances,delete e.instanceCount,e.geometry.attributes.instanceMatrix.needsUpdate=!0)),u?c&&e.setParent(l):e.setParent(l)})),u){if(!c)return null;l.localMatrix=(new h.ProjectionMatrix).fromArray(h.Matrix4.identity.toArray()),l.decompose()}return l}));return t.nodes.forEach((function(e,t){var n=e.children;(void 0===n?[]:n).forEach((function(e){r[e]&&r[e].setParent(r[t])}))})),r},e.populateSkins=function(e,t){e&&e.forEach((function(e){e.joints=e.joints.map((function(n,r){var s=t[n];return s.bindInverse=(0,i.Z)(h.Matrix4,e.inverseBindMatrices.data.slice(16*r,16*(r+1))),s})),e.skeleton&&(e.skeleton=t[e.skeleton])}))},e.parseAnimations=function(e,t,n,i){var r=this;return t.animations?t.animations.map((function(e){var s=e.channels,a=e.samplers,o=e.name;s.map((function(e){var s=e.sampler,o=e.target,l=a[s],h=l.input,u=l.interpolation,c=void 0===u?"LINEAR":u,d=l.output,m=o.node,p=o.path;return{node:n[m],transform:f[p],interpolation:c,times:r.parseAccessor(h,t,i).data,values:r.parseAccessor(d,t,i).data}}));return{name:o,animation:{}}})):null},e.parseScenes=function(e,t){return e.scenes?e.scenes.map((function(e){var n=e.nodes,i=void 0===n?[]:n;e.name,e.extensions,e.extras;return i.reduce((function(e,n){return t[n]&&e.push(t[n]),e}),[])})):null},e}()},5473:(e,t,n)=>{n.d(t,{Z:()=>N});var i={};n.r(i),n.d(i,{CameraSync:()=>F,MAX_MERCATOR_LATITUDE:()=>A,MeshLayer:()=>P,altitudeFromMercatorZ:()=>w,circumferenceAtLatitude:()=>p,earthCircumference:()=>f,earthRadius:()=>d,fromLngLat:()=>M,getTileCenter:()=>S,halfEarthCircumference:()=>m,latFromMercatorY:()=>x,lngFromMercatorX:()=>y,mercatorScale:()=>Z,mercatorXfromLng:()=>v,mercatorYfromLat:()=>g,mercatorZfromAltitude:()=>b,meterInMercatorCoordinateUnits:()=>E,toLngLat:()=>T});var r=n(79),s=n(2799),a=n(9649),o=n(889),l=n(6426),h=n.n(l),u=n(6958),c=o.utils.clamp,d=6371008.8,f=2*Math.PI*d,m=f/2;function p(e){return f*Math.cos(e*Math.PI/180)}function v(e){return(180+e)/360}function g(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function b(e,t){return e/p(t)}function y(e){return 360*e-180}function x(e){var t=180-360*e;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function w(e,t){return e*p(x(t))}function Z(e){return 1/Math.cos(e*Math.PI/180)}function E(e){return 1/f*Z(x(e))}var A=85.051129;function M(e,t){void 0===t&&(t=0);var n=c(e.lat,-A,A);return{x:v(e.lng),y:g(n),z:b(t,n)}}function T(e){return{lng:y(e.x),lat:x(e.y)}}function S(e,t,n){var i=Math.pow(2,n);return{x:e*f/i-m,y:-(t*f/i-m)}}var R=o.utils.degToRad,_=o.utils.radToDeg,C=o.utils.clamp;(0,o.highPrecision)(!0);var F=function(){function e(e,t,n){this.worldMatrix=void 0,this.mercatorMatrix=void 0,this.labelPlaneMatrix=void 0,this.glCoordMatrix=void 0,this.map=void 0,this.scene=void 0,this.camera=void 0,this.halfFov=void 0,this.cameraToCenterDistance=void 0,this.acuteAngle=void 0,this.cameraTranslateZ=void 0,this.worldMatrix=new o.Matrix4,this.mercatorMatrix=new o.Matrix4,this.labelPlaneMatrix=new o.Matrix4,this.glCoordMatrix=new o.Matrix4;var i=e.transform,r=i.width,s=i.height,a=_(Math.atan(3/4)),l=1e21;this.map=e,this.scene=n,this.scene.matrixAutoUpdate=!1,this.scene.worldMatrixNeedsUpdate=!0,this.camera="orthographic"===t?new o.OrthographicCamera(-r/2,r/2,s/2,-s/2,.1,l):new o.PerspectiveCamera(a,r/s,.1,l),this.camera.matrixAutoUpdate=!1,this.camera.position.z=600,this.setup()}var t=e.prototype;return t.setup=function(){var e=this.map.transform,t=e.width,n=e.height,i=R(this.map.transform.maxPitch);this.camera.aspect=t/n,this.halfFov=this.map.transform.fov/2,this.cameraToCenterDistance=.5/Math.tan(this.halfFov)*n,this.acuteAngle=Math.PI/2-i,this.update()},t.update=function(){var e=this.map.transform,t=e.width,n=e.height,i=e.worldSize,r=e.elevation,s=e._camera,a=e._horizonShift,l=this.map.getCenter(),h=this.map.getPitch(),u=R(h),c=this.map.getBearing(),d=this.map.transform._fov,f=d/2,m=Math.cos(Math.PI/2-u),p=Math.PI/2+u;this.cameraToCenterDistance=.5/Math.tan(f)*n;var v,g=this.map.transform.project(l),y=(new o.Matrix4).fromRotationZ(Math.PI),x=(new o.Matrix4).fromScale(new o.Vector3(-i,i,i)),w=(new o.Matrix4).fromTranslation(new o.Vector3(-g.x,g.y,0)),Z=n/50,E=Math.max(Z*m,Z),A=d*(.5+this.map.transform.centerOffset.y/n),M=Math.sin(A)*this.cameraToCenterDistance/Math.sin(C(Math.PI-p-A,.01,Math.PI-.01)),T=b(1,l.lat)*i||1;if(function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var i=0;i<n;i++){var r=parseInt(e[i]),s=parseInt(t[i]);if(r>s)return 1;if(r<s)return-1}return 0}(this.map.version,"2.0.0")>=0){var S=r?r.getMinElevationBelowMSL()*T:0,_=(s.position[2]*i-S)/Math.cos(u),F=m*(M=Math.sin(A)*_/Math.sin(o.utils.clamp(Math.PI-p-A,.01,Math.PI-.01)))+_,P=_*(1/a);v=Math.min(1.01*F,P)}else{v=1.01*(m*M+this.cameraToCenterDistance)}this.mercatorMatrix=(new o.Matrix4).scale(new o.Vector3(i,i,i/T));var O=(new o.Matrix4).fromTranslation(new o.Vector3(0,0,this.cameraToCenterDistance));this.labelPlaneMatrix=new o.Matrix4;var L=new o.Matrix4;L.scale(new o.Vector3(1,-1,1)),L.translate(new o.Vector3(-1,-1,0)),L.scale(new o.Vector3(2/t,2/n,1)),this.glCoordMatrix=L,this.camera.aspect=t/n,this.cameraTranslateZ=this.cameraToCenterDistance,this.camera instanceof o.OrthographicCamera?this.camera.projectionMatrix.orthographic(-t/2,t/2,n/2,-n/2,E,v):this.camera.projectionMatrix.perspective(d,t/n,E,v);var N=(new o.Matrix4).premultiply(O).premultiply((new o.Matrix4).fromRotationX(u)).premultiply((new o.Matrix4).fromRotationZ(-R(c)));r&&(N.elements[14]=s.position[2]*i),this.camera.worldMatrix.copy(N),this.camera.updateMatrixWorld(),this.scene&&(this.scene.localMatrix=(new o.ProjectionMatrix).premultiply(y).premultiply(x).premultiply(w))},e}(),P=function(){function e(e,t){this.id=void 0,this.type=void 0,this.renderingMode=void 0,this.meshes=void 0,this.sync=void 0,this.map=void 0,this.renderer=void 0,this.scene=void 0,this.id=e,this.type="custom",this.renderingMode=(null==t?void 0:t.renderingMode)||"2d",this.updateCamera=this.updateCamera.bind(this)}var t=e.prototype;return t.updateCamera=function(){this.sync.update()},t.projectToWorld=function(e){var t=M({lng:e[0],lat:e[1]},e[2]);return[t.x,t.y,t.z]},t.onAdd=function(e,t){this.map=e,this.renderer=new o.Renderer(t,{autoClear:!1}),this.scene=new o.Scene,this.sync=new F(e,"perspective",this.scene),e.on("move",this.updateCamera),e.on("resize",this.updateCamera),this.updateCamera()},t.addMesh=function(e){e&&!this.meshes.has(null==e?void 0:e.id)&&(this.meshes.set(null==e?void 0:e.id,e),this.scene.add(e))},t.removeMesh=function(e){e&&this.meshes.has(null==e?void 0:e.id)&&(this.scene.remove(e),this.meshes.delete(null==e?void 0:e.id))},t.onRemove=function(){for(var e=this.meshes.entries(),t=0;t<this.meshes.size;t++){var n=e.next().value,i=n[0],r=n[1];this.scene.remove(r),this.meshes.delete(i)}this.map.on("move",this.updateCamera),this.map.on("resize",this.updateCamera)},t.render=function(){this.scene.worldMatrixNeedsUpdate=!0,this.renderer.render({scene:this.scene,camera:this.camera}),this.renderer.resetState()},(0,u.Z)(e,[{key:"camera",get:function(){return this.sync.camera}}]),e}(),O=n(6792),L=n(7672);const N=Object.assign({React:r},r,{useBaseUrl:a.Z,ve:o},o,{observe:O.N7,unobserve:O.p_,GLTFLoader:L.E,leva:s,Leva:s.Leva,LevaPanel:s.LevaPanel,mapboxgl:h(),mbve:i})},6792:(e,t,n)=>{n.d(t,{N7:()=>a,p_:()=>o});var i=n(9146),r=new Map;var s=new i.Z((function(e){e.forEach((function(e){var t,n=e.target;null==(t=r.get(n))||t.forEach((function(e){return e(n)}))}))}));function a(e,t){r.has(e)||(r.set(e,new Set),s.observe(e)),r.get(e).add(t)}function o(e,t){r.has(e)&&(r.get(e).delete(t),r.get(e).size||(s.unobserve(e),r.delete(e)))}},3580:(e,t,n)=>{n.d(t,{Z:()=>a});n(79);var i=n(9577);const r={tabItem:"tabItem_zrs5"};var s=n(5250);function a(e){var t=e.children,n=e.hidden,a=e.className;return(0,s.jsx)("div",{role:"tabpanel",className:(0,i.Z)(r.tabItem,a),hidden:n,children:t})}},3494:(e,t,n)=>{n.d(t,{Z:()=>Z});var i=n(79),r=n(9577),s=n(8120),a=n(7911),o=n(4781),l=n(1346),h=n(365),u=n(216);function c(e){var t,n;return null!=(t=null==(n=i.Children.toArray(e).filter((function(e){return"\n"!==e})).map((function(e){if(!e||(0,i.isValidElement)(e)&&((t=e.props)&&"object"==typeof t&&"value"in t))return e;var t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}function d(e){var t=e.values,n=e.children;return(0,i.useMemo)((function(){var e=null!=t?t:function(e){return c(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}(n);return function(e){var t=(0,h.l)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function f(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function m(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId,s=(0,a.k6)(),o=function(e){var t=e.queryString,n=void 0!==t&&t,i=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=i?i:null}({queryString:n,groupId:r});return[(0,l._X)(o),(0,i.useCallback)((function(e){if(o){var t=new URLSearchParams(s.location.search);t.set(o,e),s.replace(Object.assign({},s.location,{search:t.toString()}))}}),[o,s])]}function p(e){var t,n,r,s,a=e.defaultValue,l=e.queryString,h=void 0!==l&&l,c=e.groupId,p=d(e),v=(0,i.useState)((function(){return function(e){var t,n=e.defaultValue,i=e.tabValues;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!f({value:n,tabValues:i}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+i.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var r=null!=(t=i.find((function(e){return e.default})))?t:i[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:a,tabValues:p})})),g=v[0],b=v[1],y=m({queryString:h,groupId:c}),x=y[0],w=y[1],Z=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:c}.groupId),n=(0,u.Nk)(t),r=n[0],s=n[1],[r,(0,i.useCallback)((function(e){t&&s.set(e)}),[t,s])]),E=Z[0],A=Z[1],M=function(){var e=null!=x?x:E;return f({value:e,tabValues:p})?e:null}();return(0,o.Z)((function(){M&&b(M)}),[M]),{selectedValue:g,selectValue:(0,i.useCallback)((function(e){if(!f({value:e,tabValues:p}))throw new Error("Can't select invalid tab value="+e);b(e),w(e),A(e)}),[w,A,p]),tabValues:p}}var v=n(6391);const g={tabList:"tabList_VixT",tabItem:"tabItem_WMNJ"};var b=n(5250);function y(e){var t=e.className,n=e.block,i=e.selectedValue,a=e.selectValue,o=e.tabValues,l=[],h=(0,s.o5)().blockElementScrollPositionUntilNextRender,u=function(e){var t=e.currentTarget,n=l.indexOf(t),r=o[n].value;r!==i&&(h(t),a(r))},c=function(e){var t,n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":var i,r=l.indexOf(e.currentTarget)+1;n=null!=(i=l[r])?i:l[0];break;case"ArrowLeft":var s,a=l.indexOf(e.currentTarget)-1;n=null!=(s=l[a])?s:l[l.length-1]}null==(t=n)||t.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t),children:o.map((function(e){var t=e.value,n=e.label,s=e.attributes;return(0,b.jsx)("li",Object.assign({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,ref:function(e){return l.push(e)},onKeyDown:c,onClick:u},s,{className:(0,r.Z)("tabs__item",g.tabItem,null==s?void 0:s.className,{"tabs__item--active":i===t}),children:null!=n?n:t}),t)}))})}function x(e){var t=e.lazy,n=e.children,r=e.selectedValue,s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){var a=s.find((function(e){return e.props.value===r}));return a?(0,i.cloneElement)(a,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:s.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==r})}))})}function w(e){var t=p(e);return(0,b.jsxs)("div",{className:(0,r.Z)("tabs-container",g.tabList),children:[(0,b.jsx)(y,Object.assign({},e,t)),(0,b.jsx)(x,Object.assign({},e,t))]})}function Z(e){var t=(0,v.Z)();return(0,b.jsx)(w,Object.assign({},e,{children:c(e.children)}),String(t))}},9206:(e,t,n)=>{n.d(t,{Z:()=>i});const i="precision highp float;\n#define GLSLIFY 1\n\nuniform float uTime;\nvarying vec2 vUv;\n\nvoid main() {\n    gl_FragColor.rgb = 0.5 + 0.3 * sin(vUv.yxx + uTime) + vec3(0.2, 0.0, 0.1);\n    gl_FragColor.a = 1.0;\n}\n"},6703:(e,t,n)=>{n.d(t,{Z:()=>i});const i="#define GLSLIFY 1\nattribute vec2 uv;\nattribute vec3 position;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n    // gl_PointSize only applicable for gl.POINTS draw mode\n    gl_PointSize = 5.0;\n}\n"}}]);